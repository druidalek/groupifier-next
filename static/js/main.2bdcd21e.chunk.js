(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{202:function(e,t,n){e.exports=n(422)},240:function(e,t,n){},419:function(e,t,n){},422:function(e,t,n){"use strict";n.r(t);n(203),n(232);var a=n(0),r=n.n(a),i=n(30),o=n.n(i),c=(n(240),n(10)),u=n(11),l=n(13),s=n(12),f=n(14),d=n(425),m=n(426),h=n(427),p=n(424),g=n(201),v=n.n(g),b=n(5),y=n.n(b),E=n(77),C=n(122),j=n.n(C),O=n(123),w=n.n(O),k=n(99),x=n.n(k),S=n(31),I=n.n(S),N=n(29),R=n.n(N),T=n(33),W=n.n(T),A=n(21),D=n.n(A),M=n(423),U=n(36),P=n.n(U),F=n(44),G=n.n(F),z=n(27),B=n.n(z),L=n(15),_=n(22),J=n(45),H=n(24),V=n(52),Y=function e(t,n,a){var r=Object(V.a)(n),i=r[0],o=r.slice(1);return 0===o.length?Object(H.a)({},t,Object(J.a)({},i,a(t[i]))):Object(H.a)({},t,Object(J.a)({},i,e(t[i],o,a)))},K=function(e,t,n){return Y(e,t,function(){return n})},Q=function(e,t,n){return Y(e,t,function(e){return e&&e.map(n)})},Z=function e(t){return(n=t)===Object(n)?Object.values(t).every(e):null!=t;var n},q=function(e,t,n){return"".concat(e," ").concat(1===e?t:n||t+"s")},$=function(e){if(0===e.length)return[];var t=le(e);return e.map(function(n){return 0!==t?n/t:1/e.length})},X=function(e,t){return e.reduce(function(e,n){return e.concat(t(n))},[])},ee=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?[]:t[0].map(function(e,n){return t.map(function(e){return e[n]})})},te=function(e,t){return e.reduceRight(function(e,n){return void 0!==e?e:t(n)?n:void 0},void 0)},ne=function(e,t){return e.filter(function(e){return t.includes(e)})},ae=function(e,t){return e.filter(function(e){return!t.includes(e)})},re=function(e,t){return[e.filter(t),e.filter(function(e){return!t(e)})]},ie=function(e,t){return e<t?-1:e>t?1:0},oe=function(e,t){return e.slice().sort(function(e,n){return ie(t(e),t(n))})},ce=function(e,t){var n=new Map(e.map(function(e){return[e,t(e)]}));return e.slice().sort(function(e,t){return a=ee(n.get(e),n.get(t)),r=function(e){var t=Object(_.a)(e,2),n=t[0],a=t[1];return ie(n,a)},a.reduce(function(e,t){return e||r(t)},null);var a,r})},ue=function e(t,n){return t.length<=n?[t]:[t.slice(0,n)].concat(Object(L.a)(e(t.slice(n),n)))},le=function(e){return e.reduce(function(e,t){return e+t},0)},se=function(e,t,n){return t<=e&&e<=n},fe=function(e,t){return new Date(new Date(e).getTime()+t).toISOString()},de=function(e,t){return Math.abs(new Date(e)-new Date(t))},me=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"UTC";return new Date(e).toLocaleTimeString("en-US",{timeZone:t,hour:"numeric",minute:"numeric"})},he=function(e){return"groupifier.".concat(e)},pe=function(e,t){return{id:he(e),specUrl:"https://jonatanklosko.github.io/groupifier-next/wcif-extensions/".concat(e,".json"),data:t}},ge=function(e,t,n){var a=t.extensions.filter(function(t){return t.id!==he(e)});return Object(H.a)({},t,{extensions:[].concat(Object(L.a)(a),[pe(e,n)])})},ve={ActivityConfig:null,RoomConfig:{stations:null},CompetitionConfig:{localNamesFirst:!1,scorecardsBackgroundUrl:"",competitorsSortingRule:"ranks",noTasksForNewcomers:!1,tasksForOwnEventsOnly:!1}},be=function(e,t){var n=t.extensions.find(function(t){return t.id===he(e)}),a=ve[e];return null===a?n&&n.data:n?Object(H.a)({},a,n.data):a},ye=function(e,t){return Object(H.a)({},t,{extensions:t.extensions.filter(function(t){return t.id!==he(e)})})},Ee=[{id:"333",name:"3x3x3 Cube",shortName:"3x3"},{id:"222",name:"2x2x2 Cube",shortName:"2x2"},{id:"444",name:"4x4x4 Cube",shortName:"4x4"},{id:"555",name:"5x5x5 Cube",shortName:"5x5"},{id:"666",name:"6x6x6 Cube",shortName:"6x6"},{id:"777",name:"7x7x7 Cube",shortName:"7x7"},{id:"333bf",name:"3x3x3 Blindfolded",shortName:"3BLD"},{id:"333fm",name:"3x3x3 Fewest Moves",shortName:"FMC"},{id:"333oh",name:"3x3x3 One-Handed",shortName:"3OH"},{id:"333ft",name:"3x3x3 With Feet",shortName:"3WF"},{id:"minx",name:"Megaminx",shortName:"Minx"},{id:"pyram",name:"Pyraminx",shortName:"Pyra"},{id:"clock",name:"Clock",shortName:"Clock"},{id:"skewb",name:"Skewb",shortName:"Skewb"},{id:"sq1",name:"Square-1",shortName:"Sq1"},{id:"444bf",name:"4x4x4 Blindfolded",shortName:"4BLD"},{id:"555bf",name:"5x5x5 Blindfolded",shortName:"5BLD"},{id:"333mbf",name:"3x3x3 Multi-Blind",shortName:"MBLD"}],Ce=function(e){return je("name",e)},je=function(e,t){return Ee.find(function(e){return e.id===t})[e]},Oe=function(e){return oe(e,function(e){return Ee.findIndex(function(t){return t.id===e.id})})},we=function(e){var t=e.match(/(\w+)(?:-r(\d+))?(?:-g(\d+))?(?:-a(\d+))?/),n=Object(_.a)(t,5),a=n[1],r=n[2],i=n[3],o=n[4];return{eventId:a,roundNumber:r&&parseInt(r,10),groupNumber:i&&parseInt(i,10),attemptNumber:o&&parseInt(o,10)}},ke=function(e){var t=we(e),n=t.eventId,a=t.roundNumber,r=t.groupNumber,i=t.attemptNumber;return[n&&Ce(n),a&&"Round ".concat(a),r&&"Group ".concat(r),i&&"Attempt ".concat(i)].filter(function(e){return e}).join(", ")},xe=function(e){return["333fm","333mbf"].includes(we(e).eventId)},Se=function(e){return new Date(e.endTime)-new Date(e.startTime)},Ie=function(e,t){return e.startTime<t.endTime&&t.startTime<e.endTime},Ne=function(e){return X(e.schedule.venues,function(e){return e.rooms})},Re=function(e,t){return be("RoomConfig",function(e,t){return Ne(e).find(function(e){return e.activities.some(function(e){return e.id===t})})}(e,t)).stations},Te=function(e){var t=X(Ne(e),function(e){return e.activities});return[].concat(Object(L.a)(t),Object(L.a)(X(t,function e(t){var n=t.childActivities;return n.length>0?[].concat(Object(L.a)(n),Object(L.a)(X(n,e))):n})))},We=new Map,Ae=function(e,t){if(We.has(e.schedule))return We.get(e.schedule).get(t);var n=Te(e),a=new Map(n.map(function(e){return[e.id,e]}));return We.set(e.schedule,a),a.get(t)},De=function(e,t){return Q(e,["schedule","venues"],function(e){return Q(e,["rooms"],function(e){return Q(e,["activities"],function(e){return e.id===t.id?t:e})})})},Me=function(e,t,n){return X(e.events,function(a){return X(a.rounds,function(a){var r=we(a.id).roundNumber,i=t[a.id].length,o=ze(e,a.id).filter(Ue),c=$(o.map(function(t){return Re(e,t.id)*Se(t)}));return ee(o,c).map(function(t){var a=Object(_.a)(t,2),o=a[0],c=a[1],u=Re(e,o.id),l=Math.round(c*i),s=function(e,t,n){if(0===t)return 1;var a=1.7*t,r=Math.round(e/a+.4);return Math.max(r,1===n?2:1)}(l,u,r),f=n.assignScramblers?function(e,t){return Math.floor(1+(Math.min(e,t)-1)/5)}(l/s,u):0,d=n.assignRunners?function(e,t){return Math.floor(1+(Math.min(e,t)-1)/8)}(l/s,u):0,m=u>0&&n.assignJudges;return ge("ActivityConfig",o,{capacity:c,groups:s,scramblers:f,runners:d,assignJudges:m})})})}).reduce(De,e)},Ue=function(e){var t=we(e.activityCode),n=t.eventId,a=t.roundNumber,r=t.groupNumber,i=t.attemptNumber;return!(!n||!a||r||i)},Pe=function(e){return Ne(e).some(function(e){return e.activities.some(function(e){return be("ActivityConfig",e)})})},Fe=function(e){return Ne(e).every(function(e){return e.activities.filter(Ue).map(function(e){return be("ActivityConfig",e)}).every(Z)})},Ge=function(e){return Ne(e).map(function(e){return be("RoomConfig",e)}).every(Z)},ze=function(e,t){return X(Ne(e),function(e){return e.activities.filter(function(e){return e.activityCode.startsWith(t)})})},Be=function(e,t){return X(ze(e,t),function(e){return xe(t)?[e]:e.childActivities})},Le=function(e,t){return e.persons.some(function(e){return e.assignments.some(function(e){return e.activityId===t})})},_e=function(e,t){return Be(e,t).some(function(t){return Le(e,t.id)})},Je=function(e){return e.events.map(function(e){return e.rounds.find(function(e){return 0===e.results.length})}).filter(function(e){return e})},He=function(e){return Je(e).filter(function(t){return!_e(e,t.id)})},Ve=function(e){return Je(e).filter(function(t){return _e(e,t.id)}).filter(function(e){return"333fm"!==we(e.id).eventId})},Ye=function(e){return e.events.some(function(t){return t.rounds.some(function(n){return xe(t.id)?_e(e,n.id):Be(e,n.id).length>0})})},Ke=function(e){return e.events.some(function(e){return e.rounds.some(function(e){return e.results.length>0})})},Qe=[{path:"/roles",text:"Edit roles",icon:"perm_contact_calendar",enabled:function(e){return!0}},{path:"/config",text:"Configure",icon:"settings",enabled:function(e){return!0}},{path:"/groups",text:"Manage groups",icon:"people",enabled:function(e){return Ge(e)&&Fe(e)}},{path:"/printing",text:"Print documents",icon:"print",enabled:function(e){return function(e){return e.persons.some(function(e){return e.assignments.some(function(e){return"competitor"===e.assignmentCode})})}(e)}}],Ze=function(e){var t=e.wcif,n=e.baseUrl;return r.a.createElement(B.a,null,r.a.createElement(I.a,null,Qe.map(function(e){return r.a.createElement(R.a,{key:e.path,button:!0,component:M.a,to:"".concat(n).concat(e.path),disabled:!e.enabled(t)},r.a.createElement(G.a,null,r.a.createElement(P.a,null,e.icon)),r.a.createElement(W.a,{primary:e.text}))})))},qe=n(64),$e=n.n(qe),Xe=n(23),et=n.n(Xe),tt=n(53),nt=n.n(tt),at=n(98),rt=n.n(at),it=function(e){var t=e.room;return r.a.createElement(D.a,{variant:"subtitle2"},r.a.createElement("span",{style:{display:"inline-block",width:10,height:10,marginRight:5,borderRadius:"100%",backgroundColor:t.color}}),r.a.createElement("span",null,t.name))},ot=n(65),ct=n(34),ut=n.n(ct),lt=n(63),st=n.n(lt),ft=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).handleKeyPress=function(e){e.key.match(/\D/)&&e.preventDefault()},n.handleTextFieldChange=function(e){var t=e.target.value.length>0?parseInt(e.target.value,10):null;(null===t||!Number.isNaN(t)&&t>=1)&&n.props.onChange(e,t)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=(e.onChange,Object(ot.a)(e,["value","onChange"]));return r.a.createElement(st.a,Object.assign({},n,{type:"number",value:null===t?"":t,onKeyPress:this.handleKeyPress,onChange:this.handleTextFieldChange}))}}]),t}(a.PureComponent),dt=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).handleCheckboxChange=function(e){var t=e.target.checked;n.props.onChange(e,t?null:0)},n.inputRef=r.a.createRef(),n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e){0===e.value&&0!==this.props.value&&this.inputRef.current.focus()}},{key:"render",value:function(){var e=this.props,t=e.value,n=e.disabled,i=Object(ot.a)(e,["value","disabled"]);return r.a.createElement(a.Fragment,null,r.a.createElement(ft,Object.assign({},i,{value:t,disabled:0===t||n,inputRef:this.inputRef})),r.a.createElement(ut.a,{name:i.name,checked:0!==t,onChange:this.handleCheckboxChange,disabled:n}))}}]),t}(a.PureComponent),mt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).handleInputChange=function(e,t){var a=n.props,r=a.room;(0,a.onChange)(ge("RoomConfig",r,K(be("RoomConfig",r),[e.target.name],t)))},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.room,n=e.disabled,a=be("RoomConfig",t).stations;return r.a.createElement("div",null,r.a.createElement(it,{room:t}),r.a.createElement(dt,{label:"Timing stations",value:a,name:"stations",onChange:this.handleInputChange,disabled:n}))}}]),t}(a.Component),ht=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).handleRoomChange=function(e){var t=n.props,a=t.wcif;(0,t.onWcifChange)(Q(a,["schedule","venues"],function(t){return Q(t,["rooms"],function(t){return t.id===e.id?e:t})}))},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.wcif,n=Pe(t);return r.a.createElement(B.a,{style:{padding:16}},r.a.createElement(y.a,{container:!0,spacing:16},Ne(t).map(function(t){return r.a.createElement(y.a,{item:!0,lg:!0,key:t.id},r.a.createElement(mt,{room:t,onChange:e.handleRoomChange,disabled:n}))})))}}]),t}(a.Component),pt=n(46),gt=n.n(pt),vt=n(185),bt=n.n(vt),yt=n(76),Et=n.n(yt),Ct=function(e){var t=e.eventId,n=Object(ot.a)(e,["eventId"]);return r.a.createElement("span",Object.assign({style:{fontSize:24},className:"cubing-icon event-".concat(t)},n))},jt=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.selected,a=t.events;return r.a.createElement("div",null,a.map(function(t){return r.a.createElement(bt.a,{key:t.id,title:Ce(t.id),placement:"top"},r.a.createElement(Et.a,{onClick:function(){return e.props.onChange(t.id)}},r.a.createElement(Ct,{eventId:t.id,style:{opacity:t.id===n?1:.3}})))}))}}]),t}(a.Component),Ot=n(186),wt=n.n(Ot),kt=n(188),xt=n.n(kt),St=n(187),It=n.n(St),Nt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).handlePanelChange=function(e,t){var a=n.props,r=a.onChange,i=a.roundId;r(t?i:null)},n.scrollToElement=function(e){window.scrollTo({top:e.parentNode.getBoundingClientRect().top-8,behavior:"smooth"})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.expanded,n=e.roundId,a=e.render;return r.a.createElement(wt.a,{onChange:this.handlePanelChange,expanded:t,CollapseProps:{onEntered:this.scrollToElement}},r.a.createElement(It.a,{expandIcon:r.a.createElement(P.a,null,"expand_more")},r.a.createElement(D.a,{variant:"subtitle1"},ke(n))),r.a.createElement(xt.a,null,t&&a(n)))}}]),t}(a.Component),Rt=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).handleEventChange=function(e){n.setState({selectedEventId:e})},n.handleRoundChange=function(e){n.setState({expandedRoundId:e})},n.state={selectedEventId:e.events[0].id,expandedRoundId:null},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.selectedEventId,a=t.expandedRoundId,i=this.props,o=i.events,c=i.render,u=o.find(function(e){return e.id===n});return r.a.createElement(y.a,{container:!0,spacing:8,justify:"flex-end"},r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(jt,{selected:n,events:o,onChange:this.handleEventChange})),r.a.createElement(y.a,{item:!0,xs:12},u.rounds.map(function(t){return r.a.createElement(Nt,{key:t.id,expanded:t.id===a,roundId:t.id,render:c,onChange:e.handleRoundChange})})))}}]),t}(a.Component),Tt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).handlePropertyChange=function(e,t){var a=n.props,r=a.activity;(0,a.onChange)(ge("ActivityConfig",r,K(be("ActivityConfig",r),[e],t)))},n.handleInputChange=function(e,t){n.handlePropertyChange(e.target.name,t)},n.handleCheckboxChange=function(e){var t=e.target,a=t.name,r=t.checked;n.handlePropertyChange(a,r)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.activity!==e.activity}},{key:"render",value:function(){var e=this.props,t=e.activity,n=e.room,a=e.expectedCompetitors,i=e.wcif,o=be("ActivityConfig",t),c=o.groups,u=o.scramblers,l=o.runners,s=o.assignJudges,f=o.capacity,d=be("RoomConfig",n).stations,m=Math.round(a.length*f),h=Math.round(m/c),p=c?q(h,"person","people")+" in group":" ",g=u?q(Math.round(h/u),"cube")+" per scrambler":" ",v=l?q(Math.round(d/l),"station")+" per runner":" ",b=t.childActivities.length>0,E=t.childActivities.some(function(e){var t=e.id;return Le(i,t)});return r.a.createElement(y.a,{container:!0,direction:"column"},r.a.createElement(y.a,{item:!0},r.a.createElement(ft,{label:"Groups",value:c,name:"groups",helperText:p,onChange:this.handleInputChange,margin:"dense",disabled:b||E})),r.a.createElement(y.a,{item:!0},r.a.createElement(dt,{label:"Scramblers",value:u,name:"scramblers",helperText:g,onChange:this.handleInputChange,margin:"dense",disabled:E})),r.a.createElement(y.a,{item:!0},r.a.createElement(dt,{label:"Runners",value:l,name:"runners",helperText:v,onChange:this.handleInputChange,margin:"dense",disabled:E})),r.a.createElement(y.a,{item:!0},r.a.createElement(gt.a,{control:r.a.createElement(ut.a,{checked:s,name:"assignJudges",onChange:this.handleCheckboxChange,disabled:0===d||E}),label:"Assign judges"})))}}]),t}(a.Component),Wt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).handleActivityChange=function(e){var t=n.props,a=t.wcif;(0,t.onWcifChange)(De(a,e))},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.roundId,a=t.wcif,i=t.expectedCompetitorsByRound,o=X(Ne(a),function(e){return e.activities.filter(function(e){return e.activityCode===n}).map(function(t){return[t,e]})});return r.a.createElement(y.a,{container:!0,spacing:16},o.map(function(t){var o=Object(_.a)(t,2),c=o[0],u=o[1];return r.a.createElement(y.a,{item:!0,xs:!0,key:c.id},r.a.createElement(it,{room:u}),r.a.createElement(Tt,{wcif:a,activity:c,room:u,onChange:e.handleActivityChange,expectedCompetitors:i[n]}))}))}}]),t}(a.PureComponent),At=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).handleCheckboxChange=function(e){var t=e.target,a=t.name,r=t.checked;n.setState(Object(J.a)({},a,r))},n.handleNextClick=function(){var e=n.props,t=e.wcif,a=e.expectedCompetitorsByRound;(0,e.onWcifChange)(Me(t,a,n.state))},n.renderRound=function(e){var t=n.props,a=t.wcif,i=t.expectedCompetitorsByRound,o=t.onWcifChange;return r.a.createElement(Wt,{roundId:e,expectedCompetitorsByRound:i,wcif:a,onWcifChange:o})},n.state={assignScramblers:!0,assignRunners:!0,assignJudges:!0},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.wcif,n=t.events.filter(function(e){return!xe(e.id)});return Pe(t)?r.a.createElement(Rt,{events:n,render:this.renderRound}):r.a.createElement(B.a,{style:{padding:16}},r.a.createElement(D.a,{variant:"h5"},"Generate configuration"),r.a.createElement(y.a,{container:!0,direction:"column"},r.a.createElement(y.a,{item:!0,style:{margin:"0.5em 0"}},r.a.createElement(D.a,{variant:"body1"},"Which of the following roles would you like to assign?")),["Scramblers","Runners","Judges"].map(function(t){return r.a.createElement(y.a,{item:!0,key:t},r.a.createElement(gt.a,{control:r.a.createElement(ut.a,{checked:e.state["assign".concat(t)],name:"assign".concat(t),onChange:e.handleCheckboxChange}),label:t}))})),r.a.createElement(et.a,{onClick:this.handleNextClick},"Next"))}}]),t}(a.Component),Dt=n(126),Mt=n.n(Dt),Ut=n(127),Pt=n.n(Ut),Ft=n(125),Gt=n.n(Ft),zt=n(128),Bt=n.n(zt),Lt=n(92),_t=n.n(Lt),Jt=[{id:"ranks",name:"Official rankings",description:"Sort competitors by their official rankings."},{id:"balanced",name:"Balanced",description:"Sort competitors in 3x3x3 (any variation), 2x2x2, Pyraminx and Skewb by their official rankings. For other events put best people in different groups, so that there are good scramblers for each group."},{id:"name-optimised",name:"Name-optimised",description:"Sort competitors by their official rankings, but also minimize the number of people with the same name in each group. Use it when many competitors have the same name."}],Ht=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).handlePropertyChange=function(e,t){var a=n.props,r=a.wcif;(0,a.onWcifChange)(ge("CompetitionConfig",r,K(be("CompetitionConfig",r),[e],t)))},n.handleCheckboxChange=function(e){var t=e.target,a=t.name,r=t.checked;n.handlePropertyChange(a,r)},n.handleTextFieldChange=function(e){var t=e.target,a=t.name,r=t.value;n.handlePropertyChange(a,r)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.wcif,t=be("CompetitionConfig",e),n=t.competitorsSortingRule,a=t.noTasksForNewcomers,i=t.tasksForOwnEventsOnly,o=t.localNamesFirst,c=t.scorecardsBackgroundUrl;return r.a.createElement(B.a,{style:{padding:16}},r.a.createElement(y.a,{container:!0,direction:"column",spacing:16},r.a.createElement(y.a,{item:!0},r.a.createElement(D.a,{variant:"h5"},"Assignments"),r.a.createElement(Mt.a,{fullWidth:!0},r.a.createElement(Gt.a,{htmlFor:"competitors-sorting-rule"},"Competitors sorting rule"),r.a.createElement(_t.a,{value:n,onChange:this.handleTextFieldChange,inputProps:{name:"competitorsSortingRule",id:"competitors-sorting-rule"}},Jt.map(function(e){var t=e.id,n=e.name;return r.a.createElement(Bt.a,{value:t,key:t},n)})),r.a.createElement(Pt.a,null,Jt.find(function(e){return e.id===n}).description+" Note: this applies to first rounds only.")),r.a.createElement(y.a,{container:!0,direction:"column"},r.a.createElement(y.a,{item:!0},r.a.createElement(gt.a,{control:r.a.createElement(ut.a,{name:"noTasksForNewcomers",checked:a,onChange:this.handleCheckboxChange}),label:"Don't assign tasks to newcomers"})),r.a.createElement(y.a,{item:!0},r.a.createElement(gt.a,{control:r.a.createElement(ut.a,{name:"tasksForOwnEventsOnly",checked:i,onChange:this.handleCheckboxChange}),label:"Assign tasks to competitors only in events they registered for"})))),r.a.createElement(y.a,{item:!0},r.a.createElement(D.a,{variant:"h5"},"Printing"),r.a.createElement(gt.a,{control:r.a.createElement(ut.a,{name:"localNamesFirst",checked:o,onChange:this.handleCheckboxChange}),label:"Swap latin names with local ones"}),r.a.createElement(st.a,{label:"Scorecards background image URL",name:"scorecardsBackgroundUrl",value:c,onChange:this.handleTextFieldChange,fullWidth:!0}))))}}]),t}(a.Component),Vt=n(190),Yt=n.n(Vt),Kt=n(189),Qt=n.n(Kt),Zt=!new URLSearchParams(window.location.search).get("staging"),qt=Zt?"https://www.worldcubeassociation.org":"https://staging.worldcubeassociation.org",$t=Zt?"7af43bdb765a9b555e09cc575351d15acee640c0db098626e40e8d1ee352ec3a":"example-application-id",Xt=function(e){return"GroupifierNext.".concat($t,".").concat(e)},en=function(){return localStorage.getItem(Xt("accessToken"))},tn=function(){var e=new URLSearchParams({client_id:$t,response_type:"token",redirect_uri:nn(),scope:"manage_competitions"});window.location="".concat(qt,"/oauth/authorize?").concat(e.toString())},nn=function(){var e=window.location,t=e.origin,n=e.pathname,a=e.search,r=new URLSearchParams(a).get("staging"),i="".concat(t).concat(n).replace(/\/$/,"");return r?"".concat(i,"?staging=true"):i},an=function(){return localStorage.removeItem(Xt("accessToken"))},rn=function(){return!!en()},on=function(e,t){var n,a,r,i=Object.keys(t).filter(function(n){return e[n]!==t[n]});return 0===i.length?Promise.resolve():(n=t.id,r=t,a=i.reduce(function(e,t){return Object(H.a)({},e,Object(J.a)({},t,r[t]))},{}),cn("/competitions/".concat(n,"/wcif"),{method:"PATCH",body:JSON.stringify(a)}))},cn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(qt,"/api/v0");return fetch("".concat(n).concat(e),Object.assign({},t,{headers:new Headers({Authorization:"Bearer ".concat(en()),"Content-Type":"application/json"})})).then(function(e){if(!e.ok)throw new Error(e.statusText);return e}).then(function(e){return e.json()})},un=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={saving:!1,failed:!1},n.handleSaveClick=function(){var e=n.props,t=e.wcif,a=e.updatedWcif,r=e.onWcifUpdate,i=e.history;n.setState({saving:!0,failed:!1}),on(t,a).then(function(){r(a),i.push("/competitions/".concat(a.id))}).catch(function(){return n.setState({saving:!1,failed:!0})})},n.handleSnackbarClose=function(){n.setState({failed:!1})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.saving,n=e.failed,i=this.props.disabled;return r.a.createElement(a.Fragment,null,r.a.createElement(Qt.a,{open:n,message:"Failed to save data to the WCA website.",anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:5e3,onClose:this.handleSnackbarClose}),r.a.createElement(et.a,{variant:"contained",color:"primary",onClick:this.handleSaveClick,disabled:i||t},r.a.createElement("span",{style:t?{visibility:"hidden"}:{}},"Save"),t&&r.a.createElement(Yt.a,{size:20,style:{position:"absolute"}})))}}]),t}(a.Component),ln=function(e,t,n){if(!["single","average"].includes(n))throw new Error("Personal best type must be either 'single' or 'average'. Received '".concat(n,"'."));var a=e.personalBests.find(function(e){return e.eventId===t&&e.type===n});return a?a.best:1/0},sn=function(e,t){return[ln(e,t,"average"),ln(e,t,"single")]},fn=function(e){return e.events.reduce(function(t,n){var a=Object(V.a)(n.rounds),r=a[0],i=a.slice(1);return t[r.id]=ce(bn(e,n.id),function(e){return sn(e,n.id)}),i.reduce(function(e,a){var r=Object(_.a)(e,2),i=r[0],o=r[1],c=i.advancementCondition;if(!c)throw new Error("Mising advancement condition for ".concat(ke(i.id),"."));var u=function(e,t,n){switch(t.type){case"ranking":return e.slice(0,t.level);case"percent":return e.slice(0,Math.floor(e.length*t.level*.01));case"attemptResult":return e.filter(function(e){return ln(e,n,"single")<t.level});default:throw new Error("Unrecognised AdvancementCondition type: '".concat(t.type,"'"))}}(o,c,n.id);return t[a.id]=u,[a,u]},[r,t[r.id]]),t},{})},dn=function(e,t){var n=oe(e.filter(function(e){return e.attempts.length>0}),function(e){return e.ranking}),a=Math.floor(.75*n.length),r=n[a].ranking;return n.filter(function(e){return e.ranking<r}).filter(function(e){return function(e,t,n){var a=t.type,r=t.level;if("ranking"===a)return e.ranking<=r;if("percent"===a)return e.ranking<=Math.floor(n*r*.01);if("attemptResult"===a)return e.attempts.some(function(e){return e.result>0&&e.result<r});throw new Error("Unrecognised AdvancementCondition type: '".concat(a,"'"))}(e,t,n.length)})},mn=function(e,t){var n=we(t),a=n.eventId,r=n.roundNumber;if(1===r)return ce(bn(e,a),function(e){return sn(e,a).map(function(e){return-e})});var i=e.events.find(function(e){return e.id===a}).rounds.find(function(e){return we(e.id).roundNumber===r-1}),o=i.results,c=i.advancementCondition;return oe(dn(o,c),function(e){return-e.ranking}).map(function(t){return e.persons.find(function(e){return e.registrantId===t.personId})})},hn=function(e){var t=Date.now()-new Date(e.birthdate).getTime();return Math.floor(t/31556952e3)},pn=function(e){return e.assignments.filter(function(e){return e.assignmentCode.startsWith("staff-")})},gn=function(e,t,n){return pn(t).filter(function(t){var a=t.activityId;return we(Ae(e,a).activityCode).eventId===n})},vn=function(e){return e.persons.filter(function(e){return e.registration&&"accepted"===e.registration.status})},bn=function(e,t){return vn(e).filter(function(e){return e.registration.eventIds.includes(t)})},yn=function(e,t,n){return e.assignments.some(function(e){return e.activityId===t&&e.assignmentCode===n})},En=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).handleWcifChange=function(e){n.setState({localWcif:e})},n.handleTabChange=function(e,t){n.setState({tabValue:t})},n.clearConfig=function(){var e=n.state.localWcif,t=ye("CompetitionConfig",e);n.setState({tabValue:0,localWcif:Q(t,["schedule","venues"],function(e){return Q(e,["rooms"],function(e){return ye("RoomConfig",Q(e,["activities"],function(e){return ye("ActivityConfig",e)}))})})})},n.state={localWcif:e.wcif,tabValue:0},n.expectedCompetitorsByRound=fn(e.wcif),n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.tabValue,n=e.localWcif,a=this.props,i=a.wcif,o=a.onWcifUpdate,c=a.history,u=Ge(n)&&Fe(n);return r.a.createElement(y.a,{container:!0,spacing:8,justify:"flex-end"},r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement($e.a,{position:"static",color:"default"},r.a.createElement(rt.a,{value:t,onChange:this.handleTabChange,centered:!0},r.a.createElement(nt.a,{label:"Rooms"}),r.a.createElement(nt.a,{label:"Rounds",disabled:!Ge(n)}),r.a.createElement(nt.a,{label:"General"})))),r.a.createElement(y.a,{item:!0,xs:12},0===t&&r.a.createElement(ht,{wcif:n,onWcifChange:this.handleWcifChange}),1===t&&r.a.createElement(At,{wcif:n,onWcifChange:this.handleWcifChange,expectedCompetitorsByRound:this.expectedCompetitorsByRound}),2===t&&r.a.createElement(Ht,{wcif:n,onWcifChange:this.handleWcifChange})),r.a.createElement(y.a,{item:!0},r.a.createElement(et.a,{variant:"contained",component:M.a,to:"/competitions/".concat(n.id)},"Cancel")),r.a.createElement(y.a,{item:!0},r.a.createElement(et.a,{variant:"contained",onClick:this.clearConfig,disabled:Ye(n)},"Clear")),r.a.createElement(y.a,{item:!0},r.a.createElement(un,{wcif:i,updatedWcif:n,onWcifUpdate:o,history:c,disabled:!u})))}}]),t}(a.Component),Cn=n(97),jn=n.n(Cn),On=n(96),wn=n.n(On),kn=n(191),xn=n.n(kn),Sn=n(194),In=n.n(Sn),Nn=n(193),Rn=n.n(Nn),Tn=n(192),Wn=n.n(Tn),An=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.wcif,n=e.groupActivity,a=e.onClose,i=e.open,o=[{id:"competitor",label:"Competitors"},{id:"staff-scrambler",label:"Scramblers"},{id:"staff-runner",label:"Runners"},{id:"staff-judge",label:"Judges"}].map(function(e){return[e,t.persons.filter(function(t){return yn(t,n.id,e.id)})]}).filter(function(e){var t=Object(_.a)(e,2);t[0];return t[1].length>0});return r.a.createElement(xn.a,{open:i,onClose:a,maxWidth:!1},r.a.createElement(Wn.a,null,ke(n.activityCode)),r.a.createElement(Rn.a,null,r.a.createElement(y.a,{container:!0,spacing:16},o.map(function(e){var t=Object(_.a)(e,2),n=t[0],a=t[1];return r.a.createElement(y.a,{item:!0,xs:12,sm:6,md:!0,key:n.id},r.a.createElement(D.a,{variant:"subtitle2"},n.label),r.a.createElement(I.a,{dense:!0,style:{overflowY:"auto",maxHeight:300}},oe(a,function(e){return e.name}).map(function(e){return r.a.createElement(R.a,{key:e.wcaUserId},r.a.createElement(W.a,{primary:e.name}))})))}),0===o.length&&r.a.createElement(y.a,{item:!0},r.a.createElement(D.a,{variant:"body2"},"No assignments for this round.")))),r.a.createElement(In.a,null,r.a.createElement(et.a,{onClick:a,color:"secondary"},"Ok")))}}]),t}(a.Component),Dn=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).state={openedGroupActivity:null},n.handleGroupClick=function(e){n.setState({openedGroupActivity:e})},n.handleDialogClose=function(){n.setState({openedGroupActivity:null})},n.renderRound=function(e){var t=n.props.wcif,a=X(t.schedule.venues,function(t){return t.rooms.map(function(n){return[n,t.timezone,X(n.activities.filter(function(t){return t.activityCode===e}),function(e){return e.childActivities})]})});return r.a.createElement(y.a,{container:!0},a.map(function(e){var t=Object(_.a)(e,3),a=t[0],i=t[1],o=t[2];return o.length>0&&r.a.createElement(y.a,{item:!0,xs:12,sm:!0,key:a.id},r.a.createElement(it,{room:a}),r.a.createElement(I.a,null,o.map(function(e){return r.a.createElement(R.a,{key:e.id,button:!0,onClick:function(){return n.handleGroupClick(e)}},r.a.createElement(W.a,{primary:"Group ".concat(we(e.activityCode).groupNumber),secondary:"".concat(me(e.startTime,i)," - ").concat(me(e.endTime,i))}))})))}))},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.openedGroupActivity,t=this.props.wcif,n=t.events.filter(function(e){return!xe(e.id)});return r.a.createElement(r.a.Fragment,null,r.a.createElement(Rt,{events:n,render:this.renderRound}),e&&r.a.createElement(An,{open:!0,groupActivity:e,wcif:t,onClose:this.handleDialogClose}))}}]),t}(a.Component),Mn=function(e){return X(e.events,function(e){return e.rounds}).reduce(function(e,t){if(xe(t.id))return e;if(Be(e,t.id).length>0)return e;var n=function(e){return Math.max.apply(Math,Object(L.a)(Te(e).map(function(e){return e.id})))}(e),a=ze(e,t.id).map(function(e){var t=be("ActivityConfig",e).groups,n=Se(e)/t,a=Array.from({length:t},function(t,a){return{id:null,name:null,activityCode:null,startTime:fe(e.startTime,n*a),endTime:fe(e.startTime,n*a+n),childActivities:[],scrambleSetId:null}});return Object(H.a)({},e,{childActivities:a})});return ce(X(a,function(e){return e.childActivities}),function(e){return[e.startTime,e.endTime]}).forEach(function(e,a){var r="".concat(t.id,"-g").concat(a+1);return Object.assign(e,{id:n+a+1,name:ke(r),activityCode:r})}),a.reduce(De,e)},e)},Un=function(e){var t=He(e);return[Pn,Yn,Kn,Qn].reduce(function(e,n){return n(e,t)},e)},Pn=function(e,t){return oe(t,function(t){return xe(t.id)?-1/0:Be(e,t.id).length}).reduce(function(e,t){var n=Gn(e,t.id);if(xe(t.id)){var a=ze(e,t.id).reduce(function(e,t){return $n(t.id,"competitor",e)},n);return Xn(e,a)}var r=X(ze(e,t.id),function(e){var t=be("ActivityConfig",e).capacity;return e.childActivities.map(function(n){return[n,t/e.childActivities.length]})}),i=ee.apply(void 0,Object(L.a)(r)),o=Object(_.a)(i,2),c=o[0],u=o[1],l=Fn(u,n.length),s=ee(c,l).map(function(e){var t=Object(_.a)(e,2),n=t[0],a=t[1];return{id:n.id,activity:n,size:a,competitors:[]}}),f=oe(s,function(e){var t=e.activity;return we(t.activityCode).groupNumber}),d=n.reduce(function(t,n){var a=t.map(function(t){return ta(e,t.activity,n)}),r=Math.max.apply(Math,Object(L.a)(a)),i=t.filter(function(e,t){return a[t]===r}),o=i.filter(function(a){return!na(e,t,a.activity,n)}),c=o.length>0?o:i,u=c.find(function(e){var t=e.size;return e.competitors.length<t});if(u)return _n(t,u.id,n);var l=c[c.length-1],s=_n(t,l.id,n);return zn(e,s,l.id)||Bn(e,s,l.id)||s},f),m=X(d,function(e){var t=e.activity,n=e.competitors;return $n(t.id,"competitor",n)});return Xn(e,m)},e)},Fn=function e(t,n){var a=Object(V.a)(t),r=a[0],i=a.slice(1);if(!r)return[];var o=Math.round(r*n);return[o].concat(Object(L.a)(e($(i),n-o)))},Gn=function(e,t){var n,a=be("CompetitionConfig",e).competitorsSortingRule,r=mn(e,t),i=we(t),o=i.eventId;if(i.roundNumber>1)return r;if("ranks"===a)return r;if("balanced"===a){if(["333","222","333bf","333oh","333ft","pyram","skewb"].includes(o))return r;var c=Be(e,t).length;return oe(r,function(e){return c-(r.length-r.indexOf(e)-1)%c})}if("name-optimised"===a){var u=(n=function(e){return e.name.split(" ")[0]},r.reduce(function(e,t){return Y(e,[n(t)],function(e){return(e||[]).concat(t)})},{}));return oe(Object.values(u),function(e){return e.length}).reduce(function(e,t){var n=Math.ceil(e.length/t.length);return X(ee(ue(e,n),t),function(e){var t=Object(_.a)(e,2),n=t[0],a=t[1];return[].concat(Object(L.a)(n),[a])})})}throw new Error("Unrecognised competitors sorting rule: '".concat(a,"'"))},zn=function e(t,n,a){var r=n.find(function(e){return e.id===a});return n.slice(n.indexOf(r)+1).reduce(function(i,o){if(i)return i;var c=te(r.competitors,function(e){return ta(t,r.activity,e)===ta(t,o.activity,e)&&!na(t,n,o.activity,e)});if(!c)return null;if(o.competitors.length<o.size)return Hn(n,a,o.id,c);if(o.competitors.length===o.size){var u=e(t,n,o.id);return u&&Hn(u,a,o.id,c)}return null},null)},Bn=function(e,t,n){var a=t.find(function(e){return e.id===n});return t.slice(0,t.indexOf(a)).reduceRight(function(r,i){if(r)return r;var o=a.competitors.find(function(n){return ta(e,a.activity,n)===ta(e,i.activity,n)&&!na(e,t,i.activity,n)});if(!o)return null;var c=zn(e,t,i.id);return c&&Vn(c,n,i.id,o)},null)},Ln=function(e,t,n){return e.map(function(e){return e.id===t?Y(e,["competitors"],n):e})},_n=function(e,t,n){return Ln(e,t,function(e){return[].concat(Object(L.a)(e),[n])})},Jn=function(e,t,n){return Ln(e,t,function(e){return e.filter(function(e){return e!==n})})},Hn=function(e,t,n,a){return function(e,t,n){return Ln(e,t,function(e){return[n].concat(Object(L.a)(e))})}(Jn(e,t,a),n,a)},Vn=function(e,t,n,a){return _n(Jn(e,t,a),n,a)},Yn=function(e,t){var n=be("CompetitionConfig",e).noTasksForNewcomers;return oe(t,function(t){return mn(e,t.id).length}).reduce(function(e,t){if(xe(t.id))return e;var a=we(t.id).eventId;return ze(e,t.id).reduce(function(e,r){var i=be("ActivityConfig",r).scramblers;return 0===i?e:r.childActivities.reduce(function(e,r){var o=vn(e).filter(function(e){return e.roles.includes("staff-scrambler")}),c=ae(mn(e,t.id),o),u=function(t){return t.filter(function(t){return ea(e,r,t)})},l=ce(u(o),function(t){return[Math.floor(pn(t).length/3),Zn(e,t,r.endTime)?1:-1].concat(Object(L.a)(sn(t,a)))}),s=l.length>=i?[]:ce(u(c),function(t){return[n&&!t.wcaId?1:-1,hn(t)>=10?-1:1,ne(["dataentry","delegate","organizer"],t.roles).length,gn(e,t,a).length>=2?1:-1,-qn(e,t,r.startTime),Math.floor(pn(t).length/6),Zn(e,t,r.endTime)?1:-1].concat(Object(L.a)(sn(t,a)))}),f=[].concat(Object(L.a)(l),Object(L.a)(s)),d=$n(r.id,"staff-scrambler",f.slice(0,i));return Xn(e,d)},e)},e)},e)},Kn=function(e,t){var n=be("CompetitionConfig",e),a=n.noTasksForNewcomers,r=n.tasksForOwnEventsOnly;return t.reduce(function(e,t){if(xe(t.id))return e;var n=we(t.id).eventId;return ze(e,t.id).reduce(function(e,t){var i=be("ActivityConfig",t).runners;return 0===i?e:t.childActivities.reduce(function(e,t){var o=re(vn(e),function(e){return e.roles.includes("staff-runner")}),c=Object(_.a)(o,2),u=c[0],l=c[1],s=function(n){return n.filter(function(n){return ea(e,t,n)})},f=ce(s(u),function(n){return[Math.floor(pn(n).length/3),Zn(e,n,t.endTime)?1:-1]}),d=f.length>=i?[]:ce(s(l),function(i){return[a&&!i.wcaId?1:-1,r&&!i.registration.eventIds.includes(n)?1:-1,hn(i)>=10?-1:1,ne(["dataentry","delegate","organizer"],i.roles).length,gn(e,i,n).length>=2?1:-1,-qn(e,i,t.startTime),Math.floor(pn(i).length/6),Zn(e,i,t.endTime)?1:-1]}),m=[].concat(Object(L.a)(f),Object(L.a)(d)),h=$n(t.id,"staff-runner",m.slice(0,i));return Xn(e,h)},e)},e)},e)},Qn=function(e,t){var n=be("CompetitionConfig",e),a=n.noTasksForNewcomers,r=n.tasksForOwnEventsOnly;return t.reduce(function(e,t){if(xe(t.id))return e;var n=we(t.id).eventId;return ze(e,t.id).reduce(function(e,t){var i=be("ActivityConfig",t).assignJudges,o=Re(e,t.id);return i?t.childActivities.reduce(function(e,t){var i=e.persons.filter(function(e){return yn(e,t.id,"competitor")}).length,c=Math.min(o,i),u=re(vn(e),function(e){return e.roles.includes("staff-judge")}),l=Object(_.a)(u,2),s=l[0],f=l[1],d=function(n){return n.filter(function(n){return ea(e,t,n)})},m=ce(d(s),function(n){return[pn(n).length,Zn(e,n,t.endTime)?1:-1]}),h=m.length>=c?[]:ce(d(f),function(i){return[a&&!i.wcaId?1:-1,r&&!i.registration.eventIds.includes(n)?1:-1,hn(i)>=10?-1:1,ne(["dataentry","delegate","organizer"],i.roles).length,gn(e,i,n).length>=2?1:-1,-qn(e,i,t.startTime),pn(i).length,Zn(e,i,t.endTime)?1:-1,i.registration?i.registration.eventIds.length:0]}),p=[].concat(Object(L.a)(m),Object(L.a)(h)),g=$n(t.id,"staff-judge",p.slice(0,c));return Xn(e,g)},e):e},e)},e)},Zn=function(e,t,n){var a=t.assignments.filter(function(e){return"competitor"===e.assignmentCode}).map(function(t){var n=t.activityId;return Ae(e,n).startTime}).filter(function(e){return e>=n});if(0===a.length)return!1;var r=a.reduce(function(e,t){return e<t?e:t});return de(r,n)<=9e5},qn=function(e,t,n){var a=t.assignments.map(function(t){var n=t.activityId;return Ae(e,n)}).filter(function(e){var t=e.startTime;return new Date(t).getDay()===new Date(n).getDay()});if(0===a.length)return 0;var r=ee.apply(void 0,Object(L.a)(a.map(function(e){return[e.startTime,e.endTime]}))).map(function(e){return e.sort()}),i=Object(_.a)(r,2),o=i[0],c=i[1];if(o[0]>n)return 1;var u=te(c,function(e){return e<=n}),l=o.find(function(e){return e>=n});if(u)if(l){if(de(n,u)>36e5&&de(n,l)>36e5)return 3}else if(de(n,u)>18e5)return 2;return 4},$n=function(e,t,n){return n.map(function(n){return Object(H.a)({},n,{assignments:[].concat(Object(L.a)(n.assignments),[{activityId:e,assignmentCode:t}])})})},Xn=function(e,t){return Q(e,["persons"],function(e){return t.find(function(t){return t.wcaUserId===e.wcaUserId})||e})},ea=function(e,t,n){return!n.assignments.some(function(n){var a=n.activityId;return Ie(Ae(e,a),t)})},ta=function(e,t,n){var a=n.assignments.map(function(n){var a=n.activityId;return function(e,t){if(!Ie(e,t))return 0;var n=[e.startTime,e.endTime,t.startTime,t.endTime].sort(),a=Object(_.a)(n,3),r=a[1],i=a[2];return new Date(i)-new Date(r)}(Ae(e,a),t)});return-le(a)/Se(t)},na=function(e,t,n,a){return ne(["dataentry","delegate","organizer"],a.roles).some(function(a){var r=vn(e).filter(function(e){return e.roles.includes(a)});return r.length>0&&r.every(function(a){return!ea(e,n,a)||t.some(function(e){var t=e.activity;return e.competitors.includes(a)&&Ie(t,n)})})})},aa=function(e){return Q(e,["events"],function(t){return Q(t,["rounds"],function(t){return K(t,["scrambleSetCount"],ra(e,t.id))})})},ra=function(e,t){return xe(t)?1:(n=Be(e,t).map(function(e){return e.startTime+e.endTime}),Object(L.a)(new Set(n))).length;var n},ia=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).createGroupActivities=function(){var e=n.state.localWcif;n.setState({localWcif:aa(Mn(e))})},n.assignTasks=function(){var e=n.state.localWcif;n.setState({localWcif:Un(e)})},n.clearGroups=function(){var e=n.state.localWcif,t=e.persons.map(function(e){return Y(e,["assignments"],function(e){return e.filter(function(e){var t=e.assignmentCode;return!t.startsWith("staff-")&&"competitor"!==t})})}),a=Q(e.schedule,["venues"],function(e){return Q(e,["rooms"],function(e){return Q(e,["activities"],function(e){return K(e,["childActivities"],[])})})});n.setState({localWcif:Object(H.a)({},e,{persons:t,schedule:a})})},n.state={localWcif:e.wcif},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.localWcif,t=this.props,n=t.wcif,a=t.onWcifUpdate,i=t.history,o=function(e){return e.events.every(function(t){return t.rounds.every(function(t){return Be(e,t.id).length>0})})}(e);return r.a.createElement(y.a,{container:!0,spacing:8,justify:"flex-end"},r.a.createElement(y.a,{item:!0,xs:12},!o&&r.a.createElement(jn.a,{style:{maxWidth:"none"},message:"To assign tasks you need to create groups first. This will also determine scramble set count for each round.",action:r.a.createElement(et.a,{onClick:this.createGroupActivities,style:{color:wn.a[500]},size:"small"},"Create groups")}),o&&He(e).length>0&&r.a.createElement(jn.a,{style:{maxWidth:"none"},message:"There are rounds with no tasks assigned.",action:r.a.createElement(et.a,{onClick:this.assignTasks,style:{color:wn.a[500]},size:"small"},"Assign tasks")})),r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(Dn,{wcif:e})),r.a.createElement(y.a,{item:!0},r.a.createElement(et.a,{variant:"contained",component:M.a,to:"/competitions/".concat(e.id)},"Cancel")),r.a.createElement(y.a,{item:!0},r.a.createElement(et.a,{variant:"contained",onClick:this.clearGroups,disabled:Ke(e)},"Clear")),r.a.createElement(y.a,{item:!0},r.a.createElement(un,{wcif:n,updatedWcif:e,onWcifUpdate:a,history:i})))}}]),t}(a.Component),oa=function(e,t){return"333mbf"===t?"".concat(ua(e.attemptResult)," points"):"333fm"===t?"".concat(e.attemptResult," moves"):la(e.attemptResult)},ca=function(e){var t=e.centiseconds,n=e.cumulativeRoundIds,a=la(t);if(0===n.length)return a;if(1===n.length)return"".concat(a," in total");var r=n.map(function(e){var t=we(e),n=t.eventId,a=t.roundNumber;return"".concat(function(e){return je("shortName",e)}(n)," R").concat(a)});return"".concat(a," total for ").concat(r.join(", "))},ua=function(e){return 99-Math.floor(e/1e7)%100},la=function(e){var t=new Date(null);return t.setUTCMilliseconds(10*e),t.toISOString().substr(11,11).replace(/^[0:]*(?!\.)/g,"")},sa=n(102),fa=n.n(sa);fetch("vfs-fonts.bundle.json").then(function(e){return e.json()}).then(function(e){return fa.a.vfs=e});var da=function(e){return{normal:e,bold:e,italic:e,bolditalics:e}};fa.a.fonts={Roboto:{normal:"Roboto-Regular.ttf",bold:"Roboto-Medium.ttf",italics:"Roboto-Italic.ttf",bolditalics:"Roboto-MediumItalic.ttf"},WenQuanYiZenHei:da("WenQuanYiZenHei.ttf"),NotoSansThai:da("NotoSansThai-Regular.ttf"),NotoSansArabic:da("NotoSansArabic-Regular.ttf"),NotoSansGeorgian:da("NotoSansGeorgian-Regular.ttf"),NotoSansArmenian:da("NotoSansArmenian-Regular.ttf")};var ma=fa.a,ha=function(e){var t=e.charCodeAt(0);return se(t,0,1327)?"Roboto":se(t,1536,1791)||se(t,1872,1919)?"NotoSansArabic":se(t,3584,3711)?"NotoSansThai":se(t,1328,1423)?"NotoSansArmenian":se(t,4256,4351)?"NotoSansGeorgian":"WenQuanYiZenHei"},pa=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.swapLatinWithLocalNames,a=void 0!==n&&n,r=t.short,i=void 0!==r&&r,o=e.match(/(.+)\s*[(\uff08](.+)[)\uff09]/)||[null,e,null],c=Object(_.a)(o,3),u=c[1],l=c[2];if(!l)return u;var s=[u,{text:l,font:ha(l)}],f=a?s.reverse():s,d=Object(_.a)(f,2),m=d[0],h=d[1];return i?m:[m," (",h,")"]},ga={1:1,2:2,3:3,m:3,a:5},va=function(e,t){(function(e){if(!e)return Promise.resolve(null);var t=new URLSearchParams({url:e,filt:"greyscale",bri:30,bg:"white",w:200,h:200,t:"letterbox",output:"jpg",encoding:"base64"});return fetch("https://images.weserv.nl/?".concat(t.toString())).then(function(e){return e.text()}).catch(function(){return null})})(be("CompetitionConfig",e).scorecardsBackgroundUrl).then(function(n){var a=ba(e,t,n);ma.createPdf(a).download("".concat(e.id,"-scorecards.pdf"))})},ba=function(e,t,n){return{background:[].concat(Object(L.a)(null===n?[]:[{x:60,y:170},{x:360,y:170},{x:60,y:590},{x:360,y:590}].map(function(e){return{absolutePosition:e,image:n}})),[{canvas:[ya({x1:20,y1:420.945,x2:575.28,y2:420.945}),ya({x1:297.64,y1:20,x2:297.64,y2:821.89})]}]),pageMargins:[20,20],content:{layout:{paddingLeft:function(e){return e%2===0?0:20},paddingRight:function(e){return e%2===0?20:0},paddingTop:function(e){return e%2===0?0:20},paddingBottom:function(e){return e%2===0?20:0},hLineWidth:function(){return 0},vLineWidth:function(){return 0}},table:{widths:["*","*"],heights:380.945,dontBreakRows:!0,body:ue(Ea(e,t),2)}}}},ya=function(e){return Object(H.a)({},e,{type:"line",lineWidth:.1,dash:{length:10},lineColor:"#888888"})},Ea=function(e,t){var n=(be("CompetitionConfig",e)||{localNamesFirst:!1}).localNamesFirst;return X(t,function(t){var a=oe(Be(e,t.id),function(e){var t=e.activityCode;return we(t).groupNumber}),r=mn(e,t.id),i=r.length;return X(a,function(a){var o=r.filter(function(e){return yn(e,a.id,"competitor")}).map(function(r){return Ca({scorecardNumber:i--,competitionName:e.shortName,activityCode:a.activityCode,round:t,competitor:r,localNamesFirst:n})}),c=o.length%4;return 0===c?o:o.concat(Array.from({length:4-c},function(){return{}}))})})},Ca=function(e){var t=e.scorecardNumber,n=e.competitionName,a=e.activityCode,r=e.round,i=e.competitor,o=e.localNamesFirst,c=we(a),u=c.eventId,l=c.roundNumber,s=c.groupNumber,f=r.cutoff,d=r.timeLimit,m=ga[r.format];return[{text:t,fontSize:10},{text:n,bold:!0,fontSize:15,margin:[0,0,0,10],alignment:"center"},{margin:[25,0,0,0],table:{widths:["*","auto","auto"],body:[ja(["Event","Round","Group"]),[Ce(u),{text:l,alignment:"center"},{text:s,alignment:"center"}]]}},{margin:[25,0,0,0],table:{widths:["auto","*"],body:[ja(["ID","Name"]),[{text:i.registrantId,alignment:"center"},{text:pa(i.name,{swapLatinWithLocalNames:o}),maxHeight:20}]]}},{margin:[0,10,0,0],table:{widths:[16,25,"*",25,25],body:[ja(["","Scr","Result","Judge","Comp"],{alignment:"center"})].concat(Object(L.a)(Oa(f,m)),[[Object(H.a)({text:"Extra attempt"},xa,{colSpan:5,margin:[0,1],fontSize:10})],ka("_"),[Object(H.a)({text:""},xa,{colSpan:5,margin:[0,1]})]])}},{fontSize:10,columns:[f?{text:"Cutoff: ".concat(oa(f,u)),alignment:"center"}:{},d?{text:"Time limit: ".concat(ca(d)),alignment:"center"}:{}]}]},ja=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.map(function(e){return Object(H.a)({},t,xa,{fontSize:9,text:e})})},Oa=function(e,t){return Array.from({length:t},function(e,t){return ka(t+1)}).reduce(function(n,a,r){return[].concat(Object(L.a)(n),r+1===t?[a]:[a,wa(e&&r+1===e.numberOfAttempts)])},[])},wa=function(e){return[Object(H.a)({},xa,{colSpan:5,margin:[0,1],columns:e?[{canvas:[{type:"line",x1:0,y1:0,x2:257.64,y2:0,dash:{length:5}}]}]:[]})]},ka=function(e){return[Object(H.a)({text:e},xa,{fontSize:20,bold:!0,alignment:"center"}),{},{},{},{}]},xa={border:[!1,!1,!1,!1]},Sa=function(e,t){var n=Ia(e,t);ma.createPdf(n).download("".concat(e.id,"-group-overview.pdf"))},Ia=function(e,t){return{content:X(t,function(t){return Be(e,t.id)}).map(function(t){return Na(e,t)})}},Na=function(e,t){var n=[["Competitors","competitor"],["Scramblers","staff-scrambler"],["Runners","staff-runner"],["Judges","staff-judge"]].map(function(n){var a=Object(_.a)(n,2),r=a[0],i=a[1];return[r,e.persons.filter(function(e){return yn(e,t.id,i)})]}).filter(function(e){var t=Object(_.a)(e,2);t[0];return t[1].length>0});return{unbreakable:!0,margin:[0,0,0,10],stack:[{text:ke(t.activityCode),bold:!0,fontSize:14,margin:[0,0,0,5]},{fontSize:8,columns:n.map(function(e){var t=Object(_.a)(e,2),n=t[0],a=t[1];return[{text:"".concat(n," (").concat(a.length,")"),bold:!0,fontSize:10,margin:[0,0,0,2]},{ul:a.map(function(e){return pa(e.name,{short:!0})}).sort()}]})}]}},Ra=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).handleScorecardsDownloadClick=function(){va(n.props.wcif,n.state.selectedRounds)},n.handleGroupOverviewDownloadClick=function(){Sa(n.props.wcif,n.state.selectedRounds)},n.handleRoundClick=function(e){return function(t){var a=n.state.selectedRounds;n.setState({selectedRounds:a.includes(e)?ae(a,[e]):[].concat(Object(L.a)(a),[e])})}};var a=Ve(n.props.wcif),r=a.every(function(e){return 1===we(e.id).roundNumber})?a:[];return n.state={selectedRounds:r},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state.selectedRounds,n=this.props.wcif,a=Ve(n);return r.a.createElement(B.a,{style:{padding:16}},r.a.createElement(D.a,{variant:"body1"},"Select rounds"),r.a.createElement(I.a,{style:{width:400}},a.map(function(n){return r.a.createElement(R.a,{key:n.id,button:!0,onClick:e.handleRoundClick(n)},r.a.createElement(G.a,null,r.a.createElement(Ct,{eventId:we(n.id).eventId})),r.a.createElement(W.a,{primary:ke(n.id)}),r.a.createElement(ut.a,{checked:t.includes(n),tabIndex:-1,disableRipple:!0,style:{padding:0}}))})),r.a.createElement(et.a,{onClick:this.handleScorecardsDownloadClick,disabled:0===t.length},"Scorecards"),r.a.createElement(et.a,{onClick:this.handleGroupOverviewDownloadClick,disabled:0===t.length},"Group overview"))}}]),t}(a.Component),Ta=function(e){var t=Wa(e);ma.createPdf(t).download("".concat(e.id,"-competitor-cards.pdf"))},Wa=function(e){return{pageMargins:[5,5],content:ue(Aa(e),3).map(function(e){return{columns:e,fontSize:8,unbreakable:!0}})}},Aa=function(e){var t=oe(vn(e),function(e){return e.name}).map(function(t){return Da(e,t)}),n=t.length%3;return 0===n?t:t.concat(Array.from({length:3-n},function(){return{}}))},Da=function(e,t){var n=e.events.filter(function(e){return!xe(e.id)}),a=(be("CompetitionConfig",e)||{localNamesFirst:!1}).localNamesFirst,r=t.assignments.map(function(t){var n=t.activityId,a=t.assignmentCode,r=Ae(e,n),i=we(r.activityCode),o=i.eventId,c=i.roundNumber;return{assignmentCode:a,eventId:o,groupNumber:i.groupNumber,roundNumber:c}}).filter(function(e){return 1===e.roundNumber}),i=ee.apply(void 0,Object(L.a)([["competitor","Comp"],["staff-scrambler","Scr"],["staff-runner","Run"],["staff-judge","Judge"]].filter(function(e){var t=Object(_.a)(e,1)[0];return r.some(function(e){return e.assignmentCode===t})}))),o=Object(_.a)(i,2),c=o[0],u=o[1];return{margin:[5,5],stack:[{text:pa(t.name,{swapLatinWithLocalNames:a}),fontSize:10},{columns:["ID: ".concat(t.registrantId),{text:t.wcaId?"WCA ID: ".concat(t.wcaId):{},alignment:"right"}]},{table:{widths:["auto"].concat(Object(L.a)(u.map(function(){return"*"}))),body:[["Event"].concat(Object(L.a)(u.map(function(e){return{text:e,alignment:"center"}})))].concat(Object(L.a)(n.map(function(e){return[Ce(e.id)].concat(Object(L.a)(c.map(function(t){return function(e,t){return{text:r.filter(function(n){return n.eventId===e&&n.assignmentCode===t}).map(function(e){return e.groupNumber}).join(", "),alignment:"center"}}(e.id,t)})))})))},layout:{paddingLeft:function(){return 2},paddingRight:function(){return 2},paddingTop:function(){return 1},paddingBottom:function(){return 1}}}]}},Ma=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).handleDownloadClick=function(){Ta(n.props.wcif)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(B.a,{style:{padding:16}},r.a.createElement(D.a,{variant:"body1"},"First round task assignments for every competitor. Useful to be distributed along with name tags."),r.a.createElement(et.a,{onClick:this.handleDownloadClick},"Download"))}}]),t}(a.Component),Ua=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={tabValue:0},n.handleTabChange=function(e,t){n.setState({tabValue:t})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.tabValue,t=this.props.wcif;return r.a.createElement(y.a,{container:!0,spacing:8,justify:"flex-end"},r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement($e.a,{position:"static",color:"default"},r.a.createElement(rt.a,{value:e,onChange:this.handleTabChange,centered:!0},r.a.createElement(nt.a,{label:"Scorecards"}),r.a.createElement(nt.a,{label:"Competitor cards"})))),r.a.createElement(y.a,{item:!0,xs:12},0===e&&r.a.createElement(Ra,{wcif:t}),1===e&&r.a.createElement(Ma,{wcif:t})),r.a.createElement(y.a,{item:!0},r.a.createElement(et.a,{variant:"contained",color:"primary",component:M.a,to:"/competitions/".concat(t.id)},"Done")))}}]),t}(a.Component),Pa=n(195),Fa=n.n(Pa),Ga=n(197),za=n.n(Ga),Ba=n(66),La=n.n(Ba),_a=n(196),Ja=n.n(_a),Ha=n(198),Va=n.n(Ha),Ya=n(129),Ka=n.n(Ya),Qa=n(78),Za=n.n(Qa),qa=[{id:"staff-scrambler",name:"Scrambler"},{id:"staff-judge",name:"Judge"},{id:"staff-runner",name:"Runner"},{id:"staff-dataentry",name:"Data entry"}],$a=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).handleSearchChange=function(e){n.setState({searchString:e.target.value})},n.handleChangePage=function(e,t){n.setState({page:t})},n.clearRoles=function(){var e=n.state.localWcif,t=qa.map(function(e){return e.id});n.setState({localWcif:Object(H.a)({},e,{persons:e.persons.map(function(e){return Object(H.a)({},e,{roles:ae(e.roles,t)})})})})},n.state={localWcif:e.wcif,page:0,searchString:""},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"handleRoleChange",value:function(e,t,n){var a=this.state.localWcif,r=n.target.checked;this.setState({localWcif:Object(H.a)({},a,{persons:a.persons.map(function(n){return n.wcaUserId===t?Object(H.a)({},n,{roles:r?[].concat(Object(L.a)(n.roles),[e]):ae(n.roles,[e])}):n})})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.page,a=t.searchString,i=t.localWcif,o=this.props,c=o.wcif,u=o.onWcifUpdate,l=o.history,s=vn(i).filter(function(e){return e.name.match(new RegExp(a,"i"))});return r.a.createElement(y.a,{container:!0,spacing:8,justify:"flex-end"},r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(B.a,null,r.a.createElement(Za.a,null,r.a.createElement(st.a,{label:"Search",value:a,onChange:this.handleSearchChange})),r.a.createElement("div",{style:{overflowX:"auto"}},r.a.createElement(Fa.a,null,r.a.createElement(Ja.a,null,r.a.createElement(Ka.a,null,r.a.createElement(La.a,null,"Person"),qa.map(function(e){return r.a.createElement(La.a,{key:e.id,padding:"none",style:{textAlign:"center"}},e.name)}))),r.a.createElement(za.a,null,s.slice(5*n,5*n+5).map(function(t){return r.a.createElement(Ka.a,{key:t.wcaUserId,hover:!0},r.a.createElement(La.a,null,t.name),qa.map(function(n){return r.a.createElement(La.a,{key:n.id,padding:"checkbox",style:{textAlign:"center"}},r.a.createElement(ut.a,{checked:t.roles.includes(n.id),onChange:e.handleRoleChange.bind(e,n.id,t.wcaUserId)}))}))})))),r.a.createElement(Va.a,{component:"div",count:s.length,rowsPerPage:5,rowsPerPageOptions:[5],page:n,onChangePage:this.handleChangePage}))),r.a.createElement(y.a,{item:!0},r.a.createElement(et.a,{variant:"contained",component:M.a,to:"/competitions/".concat(i.id)},"Cancel")),r.a.createElement(y.a,{item:!0},r.a.createElement(et.a,{variant:"contained",onClick:this.clearRoles},"Clear")),r.a.createElement(y.a,{item:!0},r.a.createElement(un,{wcif:c,updatedWcif:i,onWcifUpdate:u,history:l})))}}]),t}(a.Component),Xa=function(e){var t=e.events;return X(t,function(t){if(0===t.rounds.length)return["No rounds specified for ".concat(ke(t.id),".")];var n=X(t.rounds.slice(0,-1),function(e){return e.advancementCondition?[]:["No advancement condition specified for ".concat(ke(e.id),".")]}),a=X(t.rounds,function(t){return ze(e,t.id).length>0?[]:["No schedule activities for ".concat(ke(t.id),".")]});return[].concat(Object(L.a)(n),Object(L.a)(a))})},er=function(e){var t=vn(e);return t.forEach(function(e,t){return e.registrantId=t+1}),tr().then(function(n){var a=n.find(function(t){return e.name.startsWith(t.name)});return a?nr(a.id).then(function(e){if(0===e.competitors.length)return null;t.forEach(function(t){var n=e.competitors.find(function(e){return t.name.includes(e.name)});if(!n)throw new Error("Couldn't find Cubecomps competitor id for ".concat(t.name,"."));t.registrantId=parseInt(n.id,10)})}):null}).then(function(){return e})},tr=function(){return ar("/competitions").then(function(e){return Object.values(e).reduce(function(e,t){return e.concat(t)},[])})},nr=function(e){return ar("/competitions/".concat(e))},ar=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch("".concat("https://m.cubecomps.com/api/v1").concat(e),Object.assign({},t,{headers:new Headers({"Content-Type":"application/json"})})).then(function(e){if(!e.ok)throw new Error(e.statusText);return e}).then(function(e){return e.json()})},rr=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={wcif:null,loading:!0,errors:[]},n.handleWcifUpdate=function(e){n.setState({wcif:e})},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;(e=this.props.match.params.competitionId,cn("/competitions/".concat(e,"/wcif"))).then(function(e){return Y(e,["events"],Oe)}).then(er).then(function(e){return t.setState({wcif:e,loading:!1,errors:Xa(e)})}).catch(function(e){return t.setState({errors:[e.message],loading:!1})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.wcif,i=t.loading,o=t.errors,c=this.props.match;return i?r.a.createElement(x.a,null):r.a.createElement("div",null,0===o.length?r.a.createElement(a.Fragment,null,r.a.createElement(D.a,{variant:"h5",style:{marginBottom:16}},n.name),r.a.createElement(m.a,null,r.a.createElement(h.a,{exact:!0,path:c.url,render:function(e){return r.a.createElement(Ze,Object.assign({},e,{wcif:n,baseUrl:c.url}))}}),r.a.createElement(h.a,{path:"".concat(c.url,"/roles"),render:function(t){return r.a.createElement($a,Object.assign({},t,{wcif:n,onWcifUpdate:e.handleWcifUpdate}))}}),r.a.createElement(h.a,{path:"".concat(c.url,"/config"),render:function(t){return r.a.createElement(En,Object.assign({},t,{wcif:n,onWcifUpdate:e.handleWcifUpdate}))}}),r.a.createElement(h.a,{path:"".concat(c.url,"/groups"),render:function(t){return r.a.createElement(ia,Object.assign({},t,{wcif:n,onWcifUpdate:e.handleWcifUpdate}))}}),r.a.createElement(h.a,{path:"".concat(c.url,"/printing"),render:function(e){return r.a.createElement(Ua,Object.assign({},e,{wcif:n}))}}))):r.a.createElement(a.Fragment,null,r.a.createElement(D.a,{variant:"h5"},"Failed to load competition data"),r.a.createElement(I.a,null,o.map(function(e){return r.a.createElement(R.a,{key:e},r.a.createElement(W.a,null,e))}))))}}]),t}(a.Component),ir=n(199),or=n.n(ir),cr=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).state={competitions:[],loading:!0},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;(function(){var e=new Date(Date.now()-6048e5),t=new URLSearchParams({managed_by_me:!0,start:e.toISOString()});return cn("/competitions?".concat(t.toString()))})().then(function(t){return e.setState({competitions:oe(t,function(e){return e.start_date}),loading:!1})})}},{key:"render",value:function(){var e=this.state,t=e.competitions,n=e.loading;return r.a.createElement("div",null,r.a.createElement(B.a,null,r.a.createElement(I.a,{subheader:r.a.createElement(or.a,null,"Your competitions")},!n&&0===t.length&&r.a.createElement(R.a,null,r.a.createElement(G.a,null,r.a.createElement(P.a,null,"sentiment_very_dissatisfied")),r.a.createElement(W.a,{primary:"You have no upcoming competitions to manage."})),t.map(function(e){return r.a.createElement(R.a,{key:e.id,button:!0,component:M.a,to:"/competitions/".concat(e.id)},r.a.createElement(W.a,{primary:e.name}))})),n&&r.a.createElement(x.a,null)))}}]),t}(a.Component),ur=n(124),lr=n.n(ur),sr=(n(419),[{text:"Donate",url:"https://ko-fi.com/jonatanklosko"},{text:"Guide",url:"https://github.com/jonatanklosko/groupifier-next/wiki/Guide"},{text:"GitHub",url:"https://github.com/jonatanklosko/groupifier-next"},{text:"Contact",url:"mailto:jonatanklosko@gmail.com"},{text:"v1.2.0",url:"https://github.com/jonatanklosko/groupifier-next"}]),fr=function(){return r.a.createElement(y.a,{container:!0,className:"footer"},r.a.createElement(y.a,{item:!0,style:{flexGrow:1}},r.a.createElement(D.a,null,"Made with ",r.a.createElement(P.a,{className:"footer-icon",style:{color:lr.a[700]}},"favorite")," ","by ",r.a.createElement("a",{href:"https://github.com/jonatanklosko",target:"_blank",rel:"noopener noreferrer"},"Jonatan K\u0142osko"))),r.a.createElement(y.a,{item:!0},r.a.createElement(y.a,{container:!0,spacing:8},sr.map(function(e){var t=e.text,n=e.url;return r.a.createElement(y.a,{item:!0,key:t},r.a.createElement(D.a,null,r.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},t)))}))))},dr=function(e){var t=e.isSignedIn,n=e.onSignIn,a=e.onSignOut;return r.a.createElement($e.a,{position:"static",color:"primary"},r.a.createElement(Za.a,null,r.a.createElement(D.a,{variant:"h6",color:"inherit",style:{flexGrow:1}},r.a.createElement(M.a,{to:t?"/competitions":"/"},r.a.createElement(P.a,{style:{fontSize:"1.5em",verticalAlign:"middle",marginRight:10}},"people"),"Groupifier")),t?r.a.createElement(et.a,{color:"inherit",onClick:a},"Sign out"):r.a.createElement(et.a,{color:"inherit",onClick:n},"Sign in")))},mr=["Allows for marking competitors as different kinds of staff and handles them in a special manner.","Supports multiple rooms/stages running simultaneously.","Suggests number of groups and necessary roles, while leaving the final decision to the user.","Once configured, creates groups and does its best to optimally assign people to these groups.","Generates documents like scorecards and competitor cards with task assignments."],hr=function(){return r.a.createElement(y.a,{container:!0,spacing:24,direction:"column"},r.a.createElement(y.a,{item:!0},r.a.createElement(D.a,{variant:"h4"},"What is Groupifier?")),r.a.createElement(y.a,{item:!0},r.a.createElement(D.a,{variant:"subtitle1"},"Task and group management tool for WCA competition organizers. It's designed to be highly customizable and work well with complex schedules.")),r.a.createElement(y.a,{item:!0},r.a.createElement(D.a,{variant:"h4"},"What does it do?")),r.a.createElement(y.a,{item:!0},r.a.createElement(I.a,null,mr.map(function(e){return r.a.createElement(R.a,{key:e},r.a.createElement(G.a,null,r.a.createElement(P.a,null,"check")),r.a.createElement(W.a,{primary:e}))}))))},pr=Object(E.createMuiTheme)({palette:{primary:j.a,secondary:w.a},typography:{useNextVariants:!0}}),gr=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).handleSignIn=function(){tn()},n.handleSignOut=function(){an(),n.setState({isSignedIn:!1})},n.state={isSignedIn:rn()},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.isSignedIn;return r.a.createElement(d.a,null,r.a.createElement(E.MuiThemeProvider,{theme:pr},r.a.createElement("div",{style:{display:"flex",minHeight:"100vh",flexDirection:"column"}},r.a.createElement(v.a,null),r.a.createElement(dr,{isSignedIn:e,onSignIn:this.handleSignIn,onSignOut:this.handleSignOut}),r.a.createElement(y.a,{container:!0,justify:"center",style:{flexGrow:1}},r.a.createElement(y.a,{item:!0,xs:12,md:8,style:{padding:16}},e?r.a.createElement(m.a,null,r.a.createElement(h.a,{path:"/competitions/:competitionId",component:rr}),r.a.createElement(h.a,{path:"/competitions",component:cr}),r.a.createElement(p.a,{to:"/competitions"})):r.a.createElement(m.a,null,r.a.createElement(h.a,{exact:!0,path:"/",component:hr}),r.a.createElement(p.a,{to:"/"})))),r.a.createElement(fr,null))))}}]),t}(a.Component),vr=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function br(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}!function(){var e=window.location.hash.replace(/^\W*/,""),t=new URLSearchParams(e);if(t.has("access_token")&&localStorage.setItem(Xt("accessToken"),t.get("access_token")),t.has("expires_in")){var n=t.get("expires_in")-900,a=new Date((new Date).getTime()+1e3*n);localStorage.setItem(Xt("expirationTime"),a.toISOString())}var r=localStorage.getItem(Xt("expirationTime"));r&&new Date>=new Date(r)&&an(),t.has("access_token")&&(window.location.hash="")}(),o.a.render(r.a.createElement(gr,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/groupifier-next",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/groupifier-next","/service-worker.js");vr?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):br(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):br(e)})}}()}},[[202,2,1]]]);
//# sourceMappingURL=main.2bdcd21e.chunk.js.map