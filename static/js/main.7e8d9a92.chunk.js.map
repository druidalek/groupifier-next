{"version":3,"sources":["logic/utils.js","logic/wcif-extensions.js","logic/events.js","logic/activities.js","logic/formulas.js","components/Competition/CompetitionMenu/CompetitionMenu.js","components/common/RoomName/RoomName.js","components/common/PositiveIntegerInput/PositiveIntegerInput.js","components/common/ZeroablePositiveIntegerInput/ZeroablePositiveIntegerInput.js","components/Competition/ConfigManager/RoomConfig/RoomConfig.js","components/Competition/ConfigManager/RoomsConfig/RoomsConfig.js","components/common/CubingIcon/CubingIcon.js","components/common/EventSelect/EventSelect.js","components/common/RoundsNavigation/RoundPanel/RoundPanel.js","components/common/RoundsNavigation/RoundsNavigation.js","components/Competition/ConfigManager/RoundActivityConfig/RoundActivityConfig.js","components/Competition/ConfigManager/RoundConfig/RoundConfig.js","components/Competition/ConfigManager/RoundsConfig/RoundsConfig.js","logic/auth.js","logic/wca-api.js","components/common/SaveWcifButton/SaveWcifButton.js","logic/competitors.js","components/Competition/ConfigManager/ConfigManager.js","components/Competition/GroupsManager/GroupDialog/GroupDialog.js","components/Competition/GroupsManager/GroupsNavigation/GroupsNavigation.js","logic/groups.js","components/Competition/GroupsManager/GroupsManager.js","logic/formatters.js","logic/pdfmake.js","logic/pdf-utils.js","logic/scorecards.js","components/Competition/PrintingManager/PrintingManager.js","components/Competition/RolesManager/RolesManager.js","components/Competition/Competition.js","components/CompetitionList/CompetitionList.js","components/Footer/Footer.js","components/Header/Header.js","components/Home/Home.js","components/App/App.js","registerServiceWorker.js","index.js"],"names":["updateIn","object","_ref","updater","_ref2","Object","toArray","property","properyChain","slice","length","objectSpread","defineProperty","setIn","value","mapIn","mapper","array","map","isPresentDeep","obj","values","every","pluralize","count","singular","plural","concat","scaleToOne","arr","arrSum","sum","x","flatMap","fn","reduce","xs","zip","_len","arguments","arrs","Array","_key","_","i","intersection","ys","filter","includes","difference","partition","sortCompare","y","sortBy","sort","sortByArray","Map","get","_ref5","_ref6","slicedToArray","a","b","result","inRange","addMilliseconds","isoString","milliseconds","Date","getTime","toISOString","shortTime","timeZone","undefined","toLocaleTimeString","hour","minute","groupifierExtensionId","extensionName","extensions","wcifEntity","setExtensionData","data","otherExtensions","extension","id","toConsumableArray","specUrl","process","buildGroupifierExtension","getExtensionData","find","removeExtensionData","events","name","shortName","eventNameById","eventId","propertyById","event","parseActivityCode","activityCode","_activityCode$match","match","_activityCode$match2","e","r","g","roundNumber","parseInt","groupNumber","attemptNumber","activityCodeToName","_parseActivityCode","join","shouldHaveGroups","activity","_parseActivityCode2","activityDuration","endTime","startTime","activityStations","wcif","room","rooms","activities","stations","populateActivitiesConfig","expectedCompetitorsByRound","assignScramblers","assignRunners","assignJudges","rounds","round","competitors","roundActivities","startsWith","capacities","_ref3","capacity","groups","competitorCount","preferredGroupSize","calculatedGroupCount","Math","max","suggestedGroupCount","scramblers","floor","log2","suggestedScramblerCount","runners","log","suggestedRunnerCount","updateActivity","updatedActivity","venue","anyActivityConfigured","some","activitiesConfigComplete","roomsConfigComplete","activitiesOverlap","first","second","allActivities","allChildActivities","_ref4","childActivities","activitiesByIdCachedBySchedule","activityById","activityId","has","schedule","activitiesById","set","hasDistributedAttempts","roundId","roundGroupActivities","activityAssigned","persons","person","assignments","assignment","groupActivitiesAssigned","roundsWithoutResults","results","roundsMissingAssignments","roundsMissingScorecards","anyCompetitorAssignment","assignmentCode","venues","menuItems","path","text","icon","enabled","CompetitionMenu","baseUrl","react_default","createElement","Paper_default","List_default","menuItem","ListItem_default","key","button","component","Link","to","disabled","ListItemIcon_default","Icon_default","ListItemText_default","primary","RoomName","Typography_default","variant","style","display","width","height","marginRight","borderRadius","backgroundColor","color","PositiveIntegerInput","handleKeyPress","preventDefault","handleTextFieldChange","newValue","target","Number","isNaN","_this","props","onChange","_this$props","this","objectWithoutProperties","TextField_default","assign","type","onKeyPress","PureComponent","ZeroablePositiveIntegerInput","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","handleCheckboxChange","checked","inputRef","React","createRef","prevProps","current","focus","react","PositiveIntegerInput_PositiveIntegerInput","Checkbox_default","RoomConfig","handleInputChange","roomData","_this$props2","common_RoomName_RoomName","ZeroablePositiveIntegerInput_ZeroablePositiveIntegerInput","label","Component","RoomsConfig","handleRoomChange","updatedRoom","onWcifChange","_this2","padding","Grid_default","container","spacing","item","lg","RoomConfig_RoomConfig","CubingIcon","fontSize","className","EventSelect","selected","Tooltip_default","title","placement","IconButton_default","onClick","common_CubingIcon_CubingIcon","opacity","RoundWithGroups","handlePanelChange","expanded","scrollToElement","node","window","scrollTo","top","parentNode","getBoundingClientRect","behavior","render","ExpansionPanel_default","CollapseProps","onEntered","ExpansionPanelSummary_default","expandIcon","ExpansionPanelDetails_default","RoundsNavigation","handleEventChange","setState","selectedEventId","handleRoundChange","expandedRoundId","state","_this$state","selectedEvent","justify","EventSelect_EventSelect","RoundPanel_RoundWithGroups","RoundActivityConfig","handlePropertyChange","_event$target","nextProps","expectedCompetitors","_getExtensionData","groupSize","groupsHelperText","scramblersHelperText","runnersHelperText","groupsCreated","groupsAssigned","direction","helperText","margin","FormControlLabel_default","control","RoundConfig","handleActivityChange","activitiesWithRooms","RoundActivityConfig_RoundActivityConfig","RoundsConfig","handleNextClick","renderRound","RoundConfig_RoundConfig","RoundsNavigation_RoundsNavigation","roleLabel","Button_default","wcaAccessToken","localStorage","getItem","signIn","redirectUri","location","href","split","params","URLSearchParams","client_id","response_type","redirect_uri","scope","signOut","removeItem","isSignedIn","saveWcifChanges","updatedWcif","Promise","all","patchWcifAttribute","attribute","wcaApiFetch","method","body","JSON","stringify","fetchOptions","baseApiUrl","fetch","headers","Headers","Authorization","Content-Type","then","response","json","SaveWcifButton","saving","failed","handleSaveClick","onWcifUpdate","history","push","catch","handleSnackbarClose","Snackbar_default","open","message","anchorOrigin","vertical","horizontal","autoHideDuration","onClose","visibility","CircularProgress_default","size","position","best","Error","personalBest","personalBests","pb","Infinity","bestAverageAndSingle","competitor","getExpectedCompetitorsByRound","_event$rounds","firstRound","nextRounds","registeredCompetitors","registration","eventIds","nextRound","advancementCondition","nextRoundCompetitors","sortedCompetitors","level","competitorsExpectedToAdvance","advancingResults","sortedResults","attempts","ranking","maxAdvanceable","firstNonAdvancingRank","rank","resultCount","attempt","satisfiesAdvancementCondition","competitorsForRound","status","previousRound","registrantId","personId","age","diffMs","now","birthdate","staffAssignments","staffAssignmentsForEvent","acceptedPeople","ConfigManager","handleWcifChange","localWcif","handleTabChange","tabValue","clearConfig","wcifConfigComplete","AppBar_default","Tabs_default","centered","Tab_default","RoomsConfig_RoomsConfig","RoundsConfig_RoundsConfig","anyGroupAssignedOrCreated","SaveWcifButton_SaveWcifButton","GroupDialog","groupActivity","rolesWithPeople","role","Dialog_default","maxWidth","DialogTitle_default","DialogContent_default","people","sm","md","dense","overflowY","maxHeight","wcaUserId","DialogActions_default","openedGroupActivity","handleGroupClick","handleDialogClose","roomsWithTimezoneAndGroups","timezone","groupActivities","secondary","Fragment","GroupDialog_GroupDialog","createGroupActivities","currentActivityId","apply","maxActivityId","activitiesWithGroups","groupDuration","from","index","scrambleSetId","forEach","assignTasks","roundsToAssign","assignGroups","assignScrambling","assignRunning","assignJudging","assignmentFn","updatedCompetitors","assignActivity","updatePeople","groupActivitiesWithCapacity","_zip","_zip2","groupSizes","calculateGroupSizes","initialGroups","sortedInitialGroups","availabilityRates","group","availabilityRate","maxAvailabilityRate","mostAvailableGroups","preferredGroups","overlapsEveryoneWithSameRole","potentialGroups","notFullGroup","addCompetitorToGroupEnd","updatedGroups","moveSomeoneRight","moveSomeoneLeft","_ref7","_ref8","groupId","_ref9","indexOf","furtherGroup","predicate","competitorToMove","reduceRight","found","moveCompetitorToGroupStart","groupsWithSpot","_ref10","previousGroup","moveCompetitorToGroupEnd","updateCompetitorsInGroup","removeCompetitorFromGroup","other","fromGroupId","toGroupId","addCompetitorToGroupStart","staffScramblers","roles","available","availableDuring","sortedAvailableStaff","sortedAvailableCompetitors","competesIn15Minutes","potentialScramblers","_partition","_partition2","staffRunners","sortedAvailablePeople","potentialRunners","updatedPeople","_partition3","_partition4","staffJudges","potentialJudges","competingStartTimes","_ref11","_ref12","competingStart","updatedPerson","_ref13","intersections","_ref14","_sort","_sort2","middleStart","middleEnd","activitiesIntersection","others","_ref15","updateScrambleSetCount","scrambleSetCountForRound","_ref16","Set","GroupsManager","start","performance","wcifWithAssignments","console","clearGroups","allGroupsCreated","SnackbarContent_default","action","GroupsNavigation_RoundWithGroups","anyResults","timeLimitToString","timeLimit","centiseconds","cumulativeRoundIds","clockFormat","centisecondsToClockFormat","roundStrings","shortEventNameById","multibldAttemptResultToPoints","attemptResult","date","setUTCMilliseconds","substr","replace","vfsFonts","pdfMake","vfs","singleFileFont","file","normal","bold","italic","bolditalics","fonts","Roboto","italics","WenQuanYiZenHei","NotoSansThai","NotoSansArabic","NotoSansGeorgian","NotoSansArmenian","pdfName","swapLatinWithLocalNames","latinName","localName","pdfNames","font","code","charCodeAt","determineFont","reverse","maxAttemptCountByFormat","1","2","3","m","downloadScorecards","pdfDefinition","scorecardsPdfDefinition","start2","createPdf","download","background","canvas","cutLine","x1","y1","pageHeight","x2","pageWidth","y2","pageMargins","content","layout","paddingLeft","paddingRight","paddingTop","paddingBottom","hLineWidth","vLineWidth","table","widths","heights","dontBreakRows","chunk","scorecards","properties","lineWidth","dash","lineColor","sortedGroupActivities","scorecardNumber","groupScorecards","scorecard","competitionName","scorecardsOnLastPage","cutoff","attemptCount","format","alignment","columnLabels","attemptRows","noBorder","colSpan","attemptRow","columns","cutoffToString","labels","attemptIndex","rows","attemptsSeparator","numberOfAttempts","cutoffLine","border","PrintingManager","handleDownloadClick","selectedRounds","handleRoundClick","tabIndex","disableRipple","RolesManager","handleSearchChange","searchString","handleChangePage","page","clearRoles","roleIds","roleId","personWcaUserId","RegExp","Toolbar_default","overflowX","Table_default","TableHead_default","TableRow_default","TableCell_default","textAlign","TableBody_default","hover","handleRoleChange","bind","TablePagination_default","rowsPerPage","rowsPerPageOptions","onChangePage","Competition","loading","handleWcifUpdate","competitionId","_this3","LinearProgress_default","marginBottom","Switch","Route","exact","url","Competition_CompetitionMenu_CompetitionMenu","RolesManager_RolesManager","ConfigManager_ConfigManager","GroupsManager_GroupsManager","PrintingManager_PrintingManager","CompetitionList","competitions","oneWeekAgo","managed_by_me","getUpcomingManageableCompetitions","competition","subheader","ListSubheader_default","Footer","flexGrow","rel","marginLeft","Header","onSignIn","onSignOut","verticalAlign","features","Home","feature","App","handleSignIn","handleSignOut","HashRouter","CssBaseline_default","components_Header_Header","Redirect","isLocalhost","Boolean","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","onupdatefound","installingWorker","installing","onstatechange","controller","error","hash","hashParams","setItem","expiresInSeconds","expirationTime","initializeAuth","ReactDOM","App_App","document","getElementById","URL","origin","addEventListener","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.7e8d9a92.chunk.js","sourcesContent":["/**\n * Returns a copy of the object with the value at the specified path transformed by the update function.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Function} updater\n * @returns {Object}\n */\nexport const updateIn = (object, [property, ...properyChain], updater) =>\n  properyChain.length === 0\n    ? { ...object, [property]: updater(object[property]) }\n    : { ...object, [property]: updateIn(object[property], properyChain, updater) };\n\n/**\n * Returns a copy of the object with the value at the specified path set to the given one.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {*} value\n * @returns {Object}\n */\nexport const setIn = (object, properyChain, value) =>\n  updateIn(object, properyChain, () => value);\n\n/**\n * Returns a copy of the object with the value at the specified path merged with the given one.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Object} newValue\n * @returns {Object}\n */\nexport const mergeIn = (object, properyChain, newValue) =>\n  updateIn(object, properyChain, currentValue => ({ ...currentValue, ...newValue }));\n\n/**\n * Returns a copy of the object with the array at the specified path mapped with the given function.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Object} mapper\n * @returns {Object}\n */\nexport const mapIn = (object, properyChain, mapper) =>\n  updateIn(object, properyChain, array => array && array.map(mapper));\n\n/**\n * Returns object's value at the specified path or the default value if it doesn't exist.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {*} defaultValue\n * @returns {*}\n */\nexport const getIn = (object, [property, ...propertyChain], defaultValue = null) =>\n  object ? (\n    propertyChain.length === 0\n      ? (object.hasOwnProperty(property) ? object[property] : defaultValue)\n      : getIn(object[property], propertyChain, defaultValue)\n  ) : defaultValue;\n\n/**\n * Checks if the given value is an object.\n *\n * @param {*} value\n * @returns {boolean}\n */\nconst isObject = obj => obj === Object(obj);\n\n/**\n * When given an object, deeply checks if it doesn't contain null values.\n * Otherwise, checks if the given value is not null.\n *\n * @param {*} value\n * @returns {boolean}\n */\nexport const isPresentDeep = value =>\n  isObject(value)\n    ? Object.values(value).every(isPresentDeep)\n    : value != null;\n\n/**\n * Pluralizes a word according to the given number.\n * When no plural form given, uses singular form with an 's' appended.\n *\n * @param {number} count\n * @param {string} singular\n * @param {string} plural\n * @returns {string}\n */\nexport const pluralize = (count, singular, plural) =>\n  `${count} ${count === 1 ? singular : (plural || singular + 's')}`\n\n/**\n * Returns a new array with items summing up to 1, preserving elements proportionality.\n * When the given array is empty, returns an empty array.\n *\n * @param {Array} arr\n * @returns {Array}\n */\nexport const scaleToOne = arr => {\n  if (arr.length === 0) return [];\n  const arrSum = sum(arr);\n  return arr.map(x => arrSum !== 0 ? x / arrSum : 1 / arr.length);\n};\n\n/**\n * Applies the given function to the elements and returns the first truthy value of these calls.\n *\n * @param {Array} arr\n * @returns {*}\n */\nexport const firstResult = (arr, fn) =>\n  arr.reduce((result, x) => result || fn(x), null);\n\nexport const flatMap = (arr, fn) =>\n  arr.reduce((xs, x) => xs.concat(fn(x)), []);\n\nexport const zip = (...arrs) =>\n  arrs[0].map((_, i) => arrs.map(arr => arr[i]));\n\nexport const findLast = (arr, predicate) =>\n  arr.reduceRight((found, x) =>\n    found !== undefined ? found : (predicate(x) ? x : undefined)\n  , undefined);\n\nexport const intersection = (xs, ys) =>\n  xs.filter(x => ys.includes(x));\n\nexport const difference = (xs, ys) =>\n  xs.filter(x => !ys.includes(x));\n\nexport const partition = (xs, fn) =>\n  [xs.filter(fn), xs.filter(x => !fn(x))];\n\nconst sortCompare = (x, y) =>\n  x < y ? -1 : (x > y ? 1 : 0);\n\nexport const sortBy = (arr, fn) =>\n  arr.slice().sort((x, y) => sortCompare(fn(x), fn(y)));\n\nexport const sortByArray = (arr, fn) => {\n  const values = new Map(arr.map(x => [x, fn(x)])); /* Compute every value once. */\n  return arr.slice().sort((x, y) =>\n    firstResult(zip(values.get(x), values.get(y)), ([a, b]) => sortCompare(a, b))\n  );\n}\n\nexport const chunk = (arr, size) =>\n  arr.length <= size\n    ? [arr]\n    : [arr.slice(0, size), ...chunk(arr.slice(size), size)];\n\nexport const uniq = arr =>\n  [...new Set(arr)];\n\nexport const sum = arr =>\n  arr.reduce((x, y) => x + y, 0);\n\nexport const inRange = (x, a, b) =>\n  a <= x && x <= b;\n\nexport const addMilliseconds = (isoString, milliseconds) =>\n  new Date(new Date(isoString).getTime() + milliseconds).toISOString();\n\nexport const shortTime = (isoString, timeZone = 'UTC') =>\n  new Date(isoString).toLocaleTimeString('en-US', { timeZone, hour: 'numeric', minute: 'numeric' });\n","const groupifierExtensionId = extensionName => `groupifier.${extensionName}`;\n\nconst buildGroupifierExtension = (extensionName, data) => ({\n  id: groupifierExtensionId(extensionName),\n  specUrl: `${process.env.PUBLIC_URL}/wcif-extensions/${extensionName}.json`,\n  data\n});\n\nconst extensions = wcifEntity => wcifEntity.extensions || [];\n\nexport const setExtensionData = (extensionName, wcifEntity, data) => {\n  const otherExtensions = extensions(wcifEntity)\n    .filter(extension => extension.id !== groupifierExtensionId(extensionName));\n  return {\n    ...wcifEntity,\n    extensions: [...otherExtensions, buildGroupifierExtension(extensionName, data)]\n  };\n};\n\nexport const getExtensionData = (extensionName, wcifEntity) => {\n  const extension = extensions(wcifEntity)\n    .find(extension => extension.id === groupifierExtensionId(extensionName));\n  return extension ? extension.data : null;\n};\n\nexport const removeExtensionData = (extensionName, wcifEntity) => ({\n  ...wcifEntity,\n  extensions: extensions(wcifEntity).filter(extension =>\n    extension.id !== groupifierExtensionId(extensionName)\n  )\n});\n","const events = [\n  { id: '333',    name: '3x3x3 Cube',         shortName: '3x3'   },\n  { id: '222',    name: '2x2x2 Cube',         shortName: '2x2'   },\n  { id: '444',    name: '4x4x4 Cube',         shortName: '4x4'   },\n  { id: '555',    name: '5x5x5 Cube',         shortName: '5x5'   },\n  { id: '666',    name: '6x6x6 Cube',         shortName: '6x6'   },\n  { id: '777',    name: '7x7x7 Cube',         shortName: '7x7'   },\n  { id: '333bf',  name: '3x3x3 Blindfolded',  shortName: '3BLD'  },\n  { id: '333fm',  name: '3x3x3 Fewest Moves', shortName: 'FMC'   },\n  { id: '333oh',  name: '3x3x3 One-Handed',   shortName: '3OH'   },\n  { id: '333ft',  name: '3x3x3 With Feet',    shortName: '3WF'   },\n  { id: 'minx',   name: 'Megaminx',           shortName: 'Minx'  },\n  { id: 'pyram',  name: 'Pyraminx',           shortName: 'Pyra'  },\n  { id: 'clock',  name: 'Clock',              shortName: 'Clock' },\n  { id: 'skewb',  name: 'Skewb',              shortName: 'Skewb' },\n  { id: 'sq1',    name: 'Square-1',           shortName: 'Sq1'   },\n  { id: '444bf',  name: '4x4x4 Blindfolded',  shortName: '4BLD'  },\n  { id: '555bf',  name: '5x5x5 Blindfolded',  shortName: '5BLD'  },\n  { id: '333mbf', name: '3x3x3 Multi-Blind',  shortName: 'MBLD'  }\n];\n\nexport const eventNameById = eventId =>\n  propertyById('name', eventId);\n\nexport const shortEventNameById = eventId =>\n  propertyById('shortName', eventId);\n\nconst propertyById = (property, eventId) =>\n  events.find(event => event.id === eventId)[property];\n","import { mapIn, flatMap, zip, scaleToOne, isPresentDeep } from './utils';\nimport { getExtensionData, setExtensionData } from './wcif-extensions';\nimport { suggestedGroupCount, suggestedScramblerCount, suggestedRunnerCount } from './formulas';\nimport { eventNameById } from './events';\n\nexport const parseActivityCode = activityCode => {\n  const [, e, r, g, a] = activityCode.match(/(\\w+)(?:-r(\\d+))?(?:-g(\\d+))?(?:-a(\\d+))?/);\n  return {\n    eventId: e,\n    roundNumber: r && parseInt(r, 10),\n    groupNumber: g && parseInt(g, 10),\n    attemptNumber: a && parseInt(a, 10)\n  };\n};\n\nexport const activityCodeToName = activityCode => {\n  const { eventId, roundNumber, groupNumber, attemptNumber } = parseActivityCode(activityCode);\n  return [\n    eventId && eventNameById(eventId),\n    roundNumber && `Round ${roundNumber}`,\n    groupNumber && `Group ${groupNumber}`,\n    attemptNumber && `Attempt ${attemptNumber}`\n  ].filter(x => x).join(', ');\n};\n\nexport const shouldHaveGroups = activity => {\n  const { eventId, roundNumber, groupNumber, attemptNumber } = parseActivityCode(activity.activityCode);\n  return !!(eventId && roundNumber && !groupNumber && !attemptNumber);\n};\n\nexport const activityDuration = activity =>\n  new Date(activity.endTime) - new Date(activity.startTime);\n\nexport const activityStations = (wcif, activity) => {\n  const room = rooms(wcif).find(room => room.activities.includes(activity));\n  return getExtensionData('Room', room).stations;\n};\n\nexport const populateActivitiesConfig = (wcif, expectedCompetitorsByRound, { assignScramblers, assignRunners, assignJudges }) => {\n  const activities = flatMap(rooms(wcif), room =>\n    room.activities.filter(shouldHaveGroups)\n  );\n  const activitiesWithConfig = flatMap(wcif.events, event => {\n    return flatMap(event.rounds, round => {\n      const competitors = expectedCompetitorsByRound[round.id];\n      const roundActivities = activities\n        .filter(activity => activity.activityCode.startsWith(round.id));\n      const capacities = scaleToOne(roundActivities.map(activity =>\n        activityStations(wcif, activity) * activityDuration(activity)\n      ));\n      return zip(roundActivities, capacities).map(([activity, capacity]) => {\n        const stations = activityStations(wcif, activity);\n        return setExtensionData('Activity', activity, {\n          capacity,\n          groups: suggestedGroupCount(Math.round(capacity * competitors.length), stations),\n          scramblers: assignScramblers ? suggestedScramblerCount(stations) : 0,\n          runners: assignRunners ? suggestedRunnerCount(stations) : 0,\n          assignJudges: stations > 0 && assignJudges\n        })\n      });\n    });\n  });\n  return activitiesWithConfig.reduce(updateActivity, wcif);\n};\n\nexport const updateActivity = (wcif, updatedActivity) =>\n  mapIn(wcif, ['schedule', 'venues'], venue =>\n    mapIn(venue, ['rooms'], room =>\n      mapIn(room, ['activities'], activity =>\n        activity.id === updatedActivity.id ? updatedActivity : activity\n      )\n    )\n  );\n\nexport const anyActivityConfigured = wcif =>\n  rooms(wcif).some(room =>\n    room.activities.some(activity => getExtensionData('Activity', activity))\n  );\n\nexport const activitiesConfigComplete = wcif =>\n  rooms(wcif).every(room =>\n    room.activities\n      .filter(shouldHaveGroups)\n      .map(activity => getExtensionData('Activity', activity))\n      .every(isPresentDeep)\n  );\n\nexport const roomsConfigComplete = wcif =>\n  rooms(wcif)\n    .map(room => getExtensionData('Room', room))\n    .every(isPresentDeep);\n\nexport const activitiesOverlap = (first, second) =>\n  first.startTime < second.endTime && second.startTime < first.endTime;\n\nexport const activitiesIntersection = (first, second) => {\n  if (!activitiesOverlap(first, second)) return 0;\n  const [, middleStart, middleEnd] = [first.startTime, first.endTime, second.startTime, second.endTime].sort();\n  /* Time distance between the two middle points in time. */\n  return new Date(middleEnd) - new Date(middleStart);\n};\n\nconst allActivities = wcif => {\n  const allChildActivities = ({ childActivities }) =>\n    childActivities.length > 0\n      ? [...childActivities, ...flatMap(childActivities, allChildActivities)]\n      : childActivities;\n  const activities = flatMap(rooms(wcif), room => room.activities);\n  return [...activities, ...flatMap(activities, allChildActivities)];\n};\n\nexport const maxActivityId = wcif =>\n  Math.max(...allActivities(wcif).map(activity => activity.id));\n\n/* Assigning tasks invokes activityById enormous number of times.\n   But during that process activities (schedule) don't change.\n   Caching is gives an invaluable speed boos in this case. */\nconst activitiesByIdCachedBySchedule = new Map();\n\nexport const activityById = (wcif, activityId) => {\n  if (activitiesByIdCachedBySchedule.has(wcif.schedule)) {\n    return activitiesByIdCachedBySchedule.get(wcif.schedule).get(activityId);\n  } else {\n    const activities = allActivities(wcif);\n    const activitiesById = new Map(activities.map(activity => [activity.id, activity]));\n    activitiesByIdCachedBySchedule.set(wcif.schedule, activitiesById);\n    return activitiesById.get(activityId);\n  }\n}\n\nexport const hasDistributedAttempts = activityCode =>\n  ['333fm', '333mbf'].includes(parseActivityCode(activityCode).eventId);\n\nexport const roundActivities = (wcif, roundId) =>\n  flatMap(rooms(wcif), room =>\n    room.activities.filter(({ activityCode }) => activityCode.startsWith(roundId))\n  );\n\nexport const roundGroupActivities = (wcif, roundId) =>\n  flatMap(roundActivities(wcif, roundId), activity =>\n    hasDistributedAttempts(roundId) ? [activity] : activity.childActivities\n  );\n\nexport const activityAssigned = (wcif, activityId) =>\n  wcif.persons.some(person =>\n    (person.assignments || []).some(assignment => assignment.activityId === activityId)\n  );\n\nexport const groupActivitiesAssigned = (wcif, roundId) =>\n  roundGroupActivities(wcif, roundId).some(activity =>\n    activityAssigned(wcif, activity.id)\n  );\n\nconst roundsWithoutResults = wcif =>\n  wcif.events\n    .map(event => event.rounds.find(round => round.results.length === 0))\n    .filter(round => round);\n\nexport const roundsMissingAssignments = wcif =>\n  roundsWithoutResults(wcif)\n    .filter(round => !groupActivitiesAssigned(wcif, round.id));\n\nexport const roundsMissingScorecards = wcif =>\n  roundsWithoutResults(wcif)\n    .filter(round => groupActivitiesAssigned(wcif, round.id))\n    .filter(round => parseActivityCode(round.id).eventId !== '333fm');\n\nexport const anyCompetitorAssignment = wcif =>\n  wcif.persons.some(person =>\n    (person.assignments || []).some(assignment => assignment.assignmentCode === 'competitor')\n  );\n\nexport const allGroupsCreated = wcif =>\n  wcif.events.every(event =>\n    event.rounds.every(round =>\n      roundGroupActivities(wcif, round.id).length > 0\n    )\n  );\n\nexport const anyGroupAssignedOrCreated = wcif =>\n  wcif.events.some(event =>\n    event.rounds.some(round =>\n      hasDistributedAttempts(event.id)\n        ? anyCompetitorAssignment(wcif, round.id)\n        : roundGroupActivities(wcif, round.id).length > 0\n    )\n  );\n\nexport const anyResults = wcif =>\n  wcif.events.some(event =>\n    event.rounds.some(round => round.results.length > 0)\n  );\n\nexport const rooms = wcif =>\n  flatMap(wcif.schedule.venues, venue => venue.rooms);\n","export const suggestedGroupCount = (competitorCount, stations) => {\n  if (stations === 0) return 1;\n  const preferredGroupSize = stations * 1.7;\n  /* We calculate the number of perfectly-sized groups, and round it up starting from x.1,\n     this way we don't end up with much more than the perfect amount of people in a single group.\n     Having more small groups is preferred over having fewer big groups. */\n  const calculatedGroupCount = Math.round(competitorCount / preferredGroupSize + 0.4);\n  /* Suggest at least 2 groups, so that there are people to scramble. */\n  return Math.max(calculatedGroupCount, 2);\n};\n\nexport const suggestedScramblerCount = stations =>\n  Math.floor(Math.log2(stations + 1));\n\nexport const suggestedRunnerCount = stations =>\n  Math.floor(Math.log(stations + 2) / Math.log(3));\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport Icon from '@material-ui/core/Icon';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Paper from '@material-ui/core/Paper';\n\nimport { roomsConfigComplete, activitiesConfigComplete, anyCompetitorAssignment } from '../../../logic/activities';\n\nconst menuItems = [\n  { path: '/roles', text: \"Edit roles\", icon: 'perm_contact_calendar', enabled: wcif => true },\n  { path: '/config', text: \"Configure\", icon: 'settings', enabled: wcif => true },\n  { path: '/groups', text: \"Manage groups\", icon: 'people', enabled: wcif => roomsConfigComplete(wcif) && activitiesConfigComplete(wcif) },\n  { path: '/printing', text: \"Print documents\", icon: 'print', enabled: wcif => anyCompetitorAssignment(wcif) }\n];\n\nconst CompetitionMenu = ({ wcif, baseUrl }) => (\n  <Paper>\n    <List>\n      {menuItems.map(menuItem =>\n        <ListItem key={menuItem.path} button component={Link} to={`${baseUrl}${menuItem.path}`} disabled={!menuItem.enabled(wcif)}>\n          <ListItemIcon><Icon>{menuItem.icon}</Icon></ListItemIcon>\n          <ListItemText primary={menuItem.text} />\n        </ListItem>\n      )}\n    </List>\n  </Paper>\n);\n\nexport default CompetitionMenu;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst RoomName = ({ room }) => (\n  <Typography variant=\"subtitle2\">\n    <span style={{\n        display: 'inline-block',\n        width: 10, height: 10, marginRight: 5,\n        borderRadius: '100%', backgroundColor: room.color\n      }}\n    />\n    <span>{room.name}</span>\n  </Typography>\n);\n\nexport default RoomName;\n","import React, { PureComponent } from 'react';\nimport TextField from '@material-ui/core/TextField';\n\nexport default class PositiveIntegerInput extends PureComponent {\n  /* Prevent from entering characters like minus, plus and dot.\n     These don't trigger the change event for numeric input. */\n  handleKeyPress = event => {\n    if (event.key.match(/\\D/)) event.preventDefault();\n  };\n\n  handleTextFieldChange = event => {\n    const newValue = event.target.value.length > 0 ? parseInt(event.target.value, 10) : null;\n    if (newValue === null || (!Number.isNaN(newValue) && newValue >= 1)) {\n      this.props.onChange(event, newValue);\n    }\n  };\n\n  render() {\n    const { value, onChange, ...props } = this.props;\n\n    return (\n      <TextField\n        {...props}\n        type=\"number\"\n        value={value === null ? '' : value}\n        onKeyPress={this.handleKeyPress}\n        onChange={this.handleTextFieldChange}\n      />\n    );\n  }\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport Checkbox from '@material-ui/core/Checkbox';\n\nimport PositiveIntegerInput from '../PositiveIntegerInput/PositiveIntegerInput';\n\nexport default class ZeroablePositiveIntegerInput extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.inputRef = React.createRef();\n  }\n\n  handleCheckboxChange = event => {\n    const { checked } = event.target;\n    this.props.onChange(event, checked ? null : 0);\n  };\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.value === 0 && this.props.value !== 0) {\n      this.inputRef.current.focus();\n    }\n  }\n\n  render() {\n    const { value, disabled, ...props } = this.props;\n\n    return (\n      <Fragment>\n        <PositiveIntegerInput {...props} value={value} disabled={value === 0 || disabled} inputRef={this.inputRef} />\n        <Checkbox name={props.name} checked={value !== 0} onChange={this.handleCheckboxChange} disabled={disabled} />\n      </Fragment>\n    );\n  }\n};\n","import React, { Component } from 'react';\n\nimport RoomName from '../../../common/RoomName/RoomName';\nimport ZeroablePositiveIntegerInput from '../../../common/ZeroablePositiveIntegerInput/ZeroablePositiveIntegerInput';\nimport { setIn } from '../../../../logic/utils';\nimport { getExtensionData, setExtensionData } from '../../../../logic/wcif-extensions';\n\nexport default class RoomConfig extends Component {\n  get roomData() {\n    return getExtensionData('Room', this.props.room) || { stations: null };\n  }\n\n  handleInputChange = (event, value) => {\n    const { room, onChange } = this.props;\n    onChange(\n      setExtensionData('Room', room, setIn(\n        this.roomData, [event.target.name], value)\n      )\n    );\n  };\n\n  render() {\n    const { room, disabled } = this.props;\n\n    return (\n      <div>\n        <RoomName room={room} />\n        <ZeroablePositiveIntegerInput\n          label=\"Timing stations\"\n          value={this.roomData.stations}\n          name=\"stations\"\n          onChange={this.handleInputChange}\n          disabled={disabled}\n        />\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\n\nimport RoomConfig from '../RoomConfig/RoomConfig';\nimport { mapIn } from '../../../../logic/utils';\nimport { anyActivityConfigured, rooms } from '../../../../logic/activities';\n\nexport default class RoomsConfig extends Component {\n  handleRoomChange = updatedRoom => {\n    const { wcif, onWcifChange } = this.props;\n    onWcifChange(\n      mapIn(wcif, ['schedule', 'venues'], venue =>\n        mapIn(venue, ['rooms'], room =>\n          room.id === updatedRoom.id ? updatedRoom : room\n        )\n      )\n    );\n  };\n\n  render() {\n    const { wcif } = this.props;\n    /* Disable rooms configuration once activities config has been populated. */\n    const disabled = anyActivityConfigured(wcif);\n\n    return (\n      <Paper style={{ padding: 16 }}>\n        <Grid container spacing={16}>\n          {rooms(wcif).map(room =>\n            <Grid item lg key={room.id}>\n              <RoomConfig room={room} onChange={this.handleRoomChange} disabled={disabled} />\n            </Grid>\n          )}\n        </Grid>\n      </Paper>\n    );\n  }\n}\n","import React from 'react';\n\nconst CubingIcon = ({ eventId, ...props }) => (\n  <span style={{ fontSize: 24 }} className={`cubing-icon event-${eventId}`} {...props} />\n);\n\nexport default CubingIcon;\n","import React, { Component } from 'react';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport CubingIcon from '../CubingIcon/CubingIcon';\nimport { eventNameById } from '../../../logic/events';\n\nexport default class EventSelect extends Component {\n  render() {\n    const { selected, events } = this.props;\n\n    return (\n      <div>\n        {events.map(event => (\n          <Tooltip key={event.id} title={eventNameById(event.id)} placement=\"top\">\n            <IconButton onClick={() => this.props.onChange(event.id)}>\n              <CubingIcon eventId={event.id} style={{ opacity: event.id === selected ? 1 : 0.3 }} />\n            </IconButton>\n          </Tooltip>\n        ))}\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport Icon from '@material-ui/core/Icon';\nimport Typography from '@material-ui/core/Typography';\n\nimport { activityCodeToName } from '../../../../logic/activities';\n\nexport default class RoundWithGroups extends Component {\n  handlePanelChange = (event, expanded) => {\n    const { onChange, roundId } = this.props;\n    onChange(expanded ? roundId : null);\n  };\n\n  scrollToElement = node => {\n    /* Node is the panel content, so the panel is its parent. */\n    window.scrollTo({\n      top: node.parentNode.getBoundingClientRect().top - 8,\n      behavior: 'smooth'\n    });\n  };\n\n  render() {\n    const { expanded, roundId, render } = this.props;\n\n    return (\n      <ExpansionPanel\n        onChange={this.handlePanelChange}\n        expanded={expanded}\n        CollapseProps={{ onEntered: this.scrollToElement }}\n      >\n        <ExpansionPanelSummary expandIcon={<Icon>expand_more</Icon>}>\n          <Typography variant=\"subtitle1\">\n            {activityCodeToName(roundId)}\n          </Typography>\n        </ExpansionPanelSummary>\n        <ExpansionPanelDetails>\n          {expanded && render(roundId)}\n        </ExpansionPanelDetails>\n      </ExpansionPanel>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Grid from '@material-ui/core/Grid';\n\nimport EventSelect from '../../common/EventSelect/EventSelect';\nimport RoundPanel from './RoundPanel/RoundPanel';\n\nexport default class RoundsNavigation extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedEventId: props.events[0].id,\n      expandedRoundId: null\n    };\n  }\n\n  handleEventChange = eventId => {\n    this.setState({ selectedEventId: eventId });\n  };\n\n  handleRoundChange = roundId => {\n    this.setState({ expandedRoundId: roundId });\n  };\n\n  render() {\n    const { selectedEventId, expandedRoundId } = this.state;\n    const { events, render } = this.props;\n    const selectedEvent = events.find(event => event.id === selectedEventId);\n\n    return (\n      <Grid container spacing={8} justify=\"flex-end\">\n        <Grid item xs={12}>\n          <EventSelect selected={selectedEventId} events={events} onChange={this.handleEventChange} />\n        </Grid>\n        <Grid item xs={12}>\n          {selectedEvent.rounds.map(round => (\n            <RoundPanel\n              key={round.id}\n              expanded={round.id === expandedRoundId}\n              roundId={round.id}\n              render={render}\n              onChange={this.handleRoundChange}\n            />\n          ))}\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Grid from '@material-ui/core/Grid';\n\nimport PositiveIntegerInput from '../../../common/PositiveIntegerInput/PositiveIntegerInput';\nimport ZeroablePositiveIntegerInput from '../../../common/ZeroablePositiveIntegerInput/ZeroablePositiveIntegerInput';\nimport { setIn, pluralize } from '../../../../logic/utils';\nimport { getExtensionData, setExtensionData } from '../../../../logic/wcif-extensions';\nimport { activityAssigned } from '../../../../logic/activities';\n\nexport default class RoundActivityConfig extends Component {\n  handlePropertyChange = (property, value) => {\n    const { activity, onChange } = this.props;\n    onChange(\n      setExtensionData('Activity', activity, setIn(getExtensionData('Activity', activity), [property], value))\n    );\n  };\n\n  handleInputChange = (event, value) => {\n    this.handlePropertyChange(event.target.name, value);\n  };\n\n  handleCheckboxChange = event => {\n    const { name, checked } = event.target;\n    this.handlePropertyChange(name, checked);\n  };\n\n  shouldComponentUpdate(nextProps) {\n    return this.props.activity !== nextProps.activity;\n  }\n\n  render() {\n    const { activity, room, expectedCompetitors, wcif } = this.props;\n    const { groups, scramblers, runners, assignJudges, capacity } = getExtensionData('Activity', activity);\n\n    const stations = getExtensionData('Room', room).stations;\n    const competitors = Math.round(expectedCompetitors.length * capacity);\n    const groupSize = Math.round(competitors / groups);\n\n    const groupsHelperText = groups\n      ? pluralize(groupSize, 'person', 'people') + ' in group'\n      : ' ';\n    const scramblersHelperText = scramblers\n      ? pluralize(Math.round(groupSize / scramblers), 'cube') + ' per scrambler'\n      : ' ';\n    const runnersHelperText = runners\n      ? pluralize(Math.round(stations / runners), 'station') + ' per runner'\n      : ' ';\n\n    const groupsCreated = activity.childActivities.length > 0;\n    const groupsAssigned = activity.childActivities.some(({ id }) => activityAssigned(wcif, id));\n\n    return (\n      <Grid container direction=\"column\">\n        <Grid item>\n          <PositiveIntegerInput\n            label=\"Groups\"\n            value={groups}\n            name=\"groups\"\n            helperText={groupsHelperText}\n            onChange={this.handleInputChange}\n            margin=\"dense\"\n            disabled={groupsCreated || groupsAssigned}\n          />\n        </Grid>\n        <Grid item>\n          <ZeroablePositiveIntegerInput\n            label=\"Scramblers\"\n            value={scramblers}\n            name=\"scramblers\"\n            helperText={scramblersHelperText}\n            onChange={this.handleInputChange}\n            margin=\"dense\"\n            disabled={groupsAssigned}\n          />\n        </Grid>\n        <Grid item>\n          <ZeroablePositiveIntegerInput\n            label=\"Runners\"\n            value={runners}\n            name=\"runners\"\n            helperText={runnersHelperText}\n            onChange={this.handleInputChange}\n            margin=\"dense\"\n            disabled={groupsAssigned}\n          />\n        </Grid>\n        <Grid item>\n          <FormControlLabel\n            control={\n              <Checkbox\n                checked={assignJudges}\n                name=\"assignJudges\"\n                onChange={this.handleCheckboxChange}\n                disabled={stations === 0 || groupsAssigned}\n              />\n            }\n            label=\"Assign judges\"\n          />\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport Grid from '@material-ui/core/Grid';\n\nimport RoundActivityConfig from '../RoundActivityConfig/RoundActivityConfig';\nimport RoomName from '../../../common/RoomName/RoomName';\nimport { flatMap } from '../../../../logic/utils';\nimport { updateActivity, rooms } from '../../../../logic/activities';\n\nexport default class RoundConfig extends PureComponent {\n  handleActivityChange = activity => {\n    const { wcif, onWcifChange } = this.props;\n    onWcifChange(updateActivity(wcif, activity));\n  };\n\n  render() {\n    const { roundId, wcif, expectedCompetitorsByRound } = this.props;\n\n    const activitiesWithRooms = flatMap(rooms(wcif), room =>\n      room.activities\n        .filter(activity => activity.activityCode === roundId)\n        .map(activity => [activity, room])\n    );\n\n    return (\n      <Grid container spacing={16}>\n        {activitiesWithRooms.map(([activity, room]) =>\n          <Grid item xs key={activity.id}>\n            <RoomName room={room} />\n            <RoundActivityConfig\n              wcif={wcif}\n              activity={activity}\n              room={room}\n              onChange={this.handleActivityChange}\n              expectedCompetitors={expectedCompetitorsByRound[roundId]}\n            />\n          </Grid>\n        )}\n      </Grid>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Grid from '@material-ui/core/Grid';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nimport RoundsNavigation from '../../../common/RoundsNavigation/RoundsNavigation';\nimport RoundConfig from '../RoundConfig/RoundConfig';\nimport { populateActivitiesConfig, anyActivityConfigured, hasDistributedAttempts } from '../../../../logic/activities';\n\nexport default class RoundsConfig extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      assignScramblers: true,\n      assignRunners: true,\n      assignJudges: true\n    };\n  }\n\n  handleCheckboxChange = event => {\n    const { name, checked } = event.target;\n    this.setState({ [name]: checked });\n  };\n\n  handleNextClick = () => {\n    const { wcif, expectedCompetitorsByRound, onWcifChange } = this.props;\n    onWcifChange(populateActivitiesConfig(wcif, expectedCompetitorsByRound, this.state));\n  };\n\n  render() {\n    const { wcif } = this.props;\n    const events = wcif.events.filter(event => !hasDistributedAttempts(event.id));\n\n    return anyActivityConfigured(wcif) ? (\n      <RoundsNavigation events={events} render={this.renderRound} />\n    ) : (\n      <Paper style={{ padding: 16 }}>\n        <Typography variant=\"h5\">Generate configuration</Typography>\n        <Grid container direction=\"column\">\n          <Grid item style={{ margin: '0.5em 0' }}>\n            <Typography variant=\"body1\">\n              Which of the following roles would you like to assign?\n            </Typography>\n          </Grid>\n          {['Scramblers', 'Runners', 'Judges'].map(roleLabel =>\n            <Grid item key={roleLabel}>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    checked={this.state[`assign${roleLabel}`]}\n                    name={`assign${roleLabel}`}\n                    onChange={this.handleCheckboxChange}\n                  />\n                }\n                label={roleLabel}\n              />\n            </Grid>\n          )}\n        </Grid>\n        <Button onClick={this.handleNextClick}>\n          Next\n        </Button>\n      </Paper>\n    );\n  }\n\n  renderRound = roundId => {\n    const { wcif, expectedCompetitorsByRound, onWcifChange } = this.props;\n\n    return (\n      <RoundConfig\n        roundId={roundId}\n        expectedCompetitorsByRound={expectedCompetitorsByRound}\n        wcif={wcif}\n        onWcifChange={onWcifChange}\n      />\n    );\n  };\n}\n","/**\n * Checks the URL hash for presence of OAuth access token\n * and saves it in the local storage if it's found.\n * Should be called on application initialization (before any kind of router takes over the location).\n */\nexport const initializeAuth = () => {\n  const hash = window.location.hash.replace(/^\\W*/, '');\n  const hashParams = new URLSearchParams(hash);\n  if (hashParams.has('access_token')) {\n    localStorage.setItem('Groupifier.accessToken', hashParams.get('access_token'));\n  }\n  if (hashParams.has('expires_in')) {\n    /* Expire the token 15 minutes before it actually does,\n       this way it doesn't expire right after the user enters the page. */\n    const expiresInSeconds = hashParams.get('expires_in') - 15 * 60;\n    const expirationTime = new Date(new Date().getTime() + expiresInSeconds * 1000);\n    localStorage.setItem('Groupifier.expirationTime', expirationTime.toISOString());\n  }\n  /* If the token expired, sign the user out. */\n  const expirationTime = localStorage.getItem('Groupifier.expirationTime');\n  if (expirationTime && new Date() >= new Date(expirationTime)) {\n    signOut();\n  }\n  /* Clear the hash only if there is a token, otherwise it may be a router path. */\n  if (hashParams.has('access_token')) {\n    window.location.hash = '';\n  }\n};\n\nexport const wcaAccessToken = () =>\n  localStorage.getItem('Groupifier.accessToken');\n\nexport const signIn = () => {\n  const redirectUri = window.location.href.split('/#')[0];\n  const params = new URLSearchParams({\n    client_id: process.env.REACT_APP_WCA_OAUTH_CLIENT_ID,\n    response_type: 'token',\n    redirect_uri: redirectUri,\n    scope: 'manage_competitions'\n  });\n  window.location = `${process.env.REACT_APP_WCA_ORIGIN}/oauth/authorize?${params}`\n};\n\nexport const signOut = () =>\n  localStorage.removeItem('Groupifier.accessToken');\n\nexport const isSignedIn = () => !!wcaAccessToken();\n","import { wcaAccessToken } from './auth';\n\nexport const getUpcomingManageableCompetitions = () => {\n  const oneWeekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n  const params = new URLSearchParams({\n    managed_by_me: true,\n    start: oneWeekAgo.toISOString()\n  });\n  return wcaApiFetch(`/competitions?${params}}`);\n};\n\nexport const getCompetitionWcif = competitionId =>\n  wcaApiFetch(`/competitions/${competitionId}/wcif`);\n\nexport const saveWcifChanges = (wcif, updatedWcif) =>\n  Promise.all([\n    wcif.persons !== updatedWcif.persons && patchWcifAttribute(updatedWcif, 'persons'),\n    wcif.events !== updatedWcif.events && patchWcifAttribute(updatedWcif, 'events'),\n    wcif.schedule !== updatedWcif.schedule && patchWcifAttribute(updatedWcif, 'schedule'),\n  ]);\n\nconst patchWcifAttribute = (wcif, attribute) =>\n  wcaApiFetch(`/competitions/${wcif.id}/wcif/${attribute}`, { method: 'PATCH', body: JSON.stringify(wcif[attribute]) });\n\nconst wcaApiFetch = (path, fetchOptions = {}) => {\n  const baseApiUrl = `${process.env.REACT_APP_WCA_ORIGIN}/api/v0`;\n\n  return fetch(`${baseApiUrl}${path}`, Object.assign({}, fetchOptions, {\n    headers: new Headers({\n      'Authorization': `Bearer ${wcaAccessToken()}`,\n      'Content-Type': 'application/json'\n    })\n  }))\n  .then(response => response.json());\n};\n","import React, { Component, Fragment } from 'react';\nimport Button from '@material-ui/core/Button';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Snackbar from '@material-ui/core/Snackbar';\n\nimport { saveWcifChanges } from '../../../logic/wca-api';\n\nexport default class SaveWcifButton extends Component {\n  state = {\n    saving: false,\n    failed: false\n  };\n\n  handleSaveClick = () => {\n    const { wcif, updatedWcif, onWcifUpdate, history } = this.props;\n    this.setState({ saving: true, failed: false });\n    saveWcifChanges(wcif, updatedWcif)\n      .then(() => {\n        onWcifUpdate(updatedWcif);\n        history.push(`/competitions/${updatedWcif.id}`);\n      })\n      .catch(() => this.setState({ saving: false, failed: true }));\n  };\n\n  handleSnackbarClose = () => {\n    this.setState({ failed: false });\n  };\n\n  render() {\n    const { saving, failed } = this.state;\n    const { disabled } = this.props;\n    return (\n      <Fragment>\n        <Snackbar\n          open={failed}\n          message=\"Failed to save data to the WCA website.\"\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'left',\n          }}\n          autoHideDuration={5000}\n          onClose={this.handleSnackbarClose}\n        />\n        <Button variant=\"contained\" color=\"primary\" onClick={this.handleSaveClick} disabled={disabled || saving}>\n          <span style={saving ? { visibility: 'hidden' } : {}}>Save</span>\n          {saving && <CircularProgress size={20} style={{ position: 'absolute' }} />}\n        </Button>\n      </Fragment>\n    );\n  }\n}\n","import { parseActivityCode, activityCodeToName, activityById } from './activities';\nimport { sortBy, sortByArray } from './utils';\n\nexport const best = (person, eventId, type) => {\n  if (!['single', 'average'].includes(type)) {\n    throw new Error(`Personal best type must be either 'single' or 'average'. Received '${type}'.`);\n  }\n  const personalBest = person.personalBests.find(pb => pb.eventId === eventId && pb.type === type);\n  return personalBest ? personalBest.best : Infinity;\n};\n\nexport const bestAverageAndSingle = (competitor, eventId) =>\n  [best(competitor, eventId, 'average'), best(competitor, eventId, 'single')];\n\nconst competitorsExpectedToAdvance = (sortedCompetitors, advancementCondition, eventId) => {\n  switch (advancementCondition.type) {\n    case 'ranking':\n      return sortedCompetitors.slice(0, advancementCondition.level);\n    case 'percent':\n      return sortedCompetitors.slice(0, Math.floor(sortedCompetitors.length * advancementCondition.level * 0.01));\n    case 'attemptResult':\n      /* Assume that competitors having personal best better than the advancement condition will make it to the next round. */\n      return sortedCompetitors.filter(person => best(person, eventId, 'single') < advancementCondition.level);\n    default:\n      throw new Error(`Unrecognised AdvancementCondition type: '${advancementCondition.type}'`);\n  }\n};\n\nexport const getExpectedCompetitorsByRound = wcif =>\n  wcif.events.reduce((expectedCompetitorsByRound, event) => {\n    const [firstRound, ...nextRounds] = event.rounds;\n    const registeredCompetitors = wcif.persons.filter(person =>\n      person.registration && person.registration.eventIds.includes(event.id)\n    );\n    expectedCompetitorsByRound[firstRound.id] = sortByArray(registeredCompetitors,\n      competitor => bestAverageAndSingle(competitor, event.id)\n    );\n    nextRounds.reduce(([round, competitors], nextRound) => {\n      const advancementCondition = round.advancementCondition;\n      if (!advancementCondition) throw new Error(`Mising advancement condition for ${activityCodeToName(round.id)}.`);\n      const nextRoundCompetitors = competitorsExpectedToAdvance(competitors, advancementCondition, event.id);\n      expectedCompetitorsByRound[nextRound.id] = nextRoundCompetitors;\n      return [nextRound, nextRoundCompetitors];\n    }, [firstRound, expectedCompetitorsByRound[firstRound.id]]);\n    return expectedCompetitorsByRound;\n  }, {});\n\nconst satisfiesAdvancementCondition = (result, advancementCondition, resultCount) => {\n  const { type, level } = advancementCondition;\n  if (type === 'ranking') return result.ranking <= level;\n  if (type === 'percent') return result.ranking <= Math.floor(resultCount * level * 0.01);\n  if (type === 'attemptResult') return result.attempts.some(attempt => attempt.result < level);\n  throw new Error(`Unrecognised AdvancementCondition type: '${type}'`);\n};\n\nconst advancingResults = (results, advancementCondition) => {\n  const sortedResults = sortBy(\n    results.filter(result => result.attempts.length > 0),\n    result => result.ranking\n  );\n  const maxAdvanceable = Math.floor(sortedResults.length * 0.75); /* See: https://www.worldcubeassociation.org/regulations/#9p1 */\n  const firstNonAdvancingRank = sortedResults[maxAdvanceable].rank;\n  /* Note: this ensures that people who tied either advance altogether or not. */\n  return sortedResults\n    .filter(result => result.rank < firstNonAdvancingRank)\n    .filter(result => satisfiesAdvancementCondition(result, advancementCondition, sortedResults.length));\n};\n\nexport const competitorsForRound = (wcif, roundId) => {\n  const { eventId, roundNumber } = parseActivityCode(roundId);\n  if (roundNumber === 1) {\n    const registeredCompetitors = wcif.persons.filter(({ registration }) =>\n      registration && registration.status === 'accepted' && registration.eventIds.includes(eventId)\n    );\n    return sortByArray(registeredCompetitors,\n      competitor => bestAverageAndSingle(competitor, eventId).map(result => -result)\n    );\n  } else {\n    const previousRound = wcif.events\n      .find(event => event.id === eventId).rounds\n      .find(round => parseActivityCode(round.id).roundNumber === roundNumber - 1);\n    const { results, advancementCondition } = previousRound;\n    return sortBy(advancingResults(results, advancementCondition), result => -result.ranking)\n      .map(result => wcif.persons.find(person => person.registrantId === result.personId));\n  }\n};\n\nexport const age = person => {\n  const diffMs = Date.now() - new Date(person.birthdate).getTime();\n  return Math.floor(diffMs / (1000 * 60 * 60 * 24 * 365.2425));\n}\n\nexport const staffAssignments = person =>\n  (person.assignments || []).filter(({ assignmentCode }) => assignmentCode.startsWith('staff-'));\n\nexport const staffAssignmentsForEvent = (wcif, person, eventId) =>\n  staffAssignments(person).filter(({ activityId }) =>\n    parseActivityCode(activityById(wcif, activityId).activityCode).eventId === eventId\n  );\n\nexport const acceptedPeople = wcif =>\n  wcif.persons.filter(person => !person.registration || person.registration.status === 'accepted');\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport AppBar from '@material-ui/core/AppBar';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Tab from '@material-ui/core/Tab';\nimport Tabs from '@material-ui/core/Tabs';\nimport Typography from '@material-ui/core/Typography';\n\nimport RoomsConfig from './RoomsConfig/RoomsConfig';\nimport RoundsConfig from './RoundsConfig/RoundsConfig';\nimport SaveWcifButton from '../../common/SaveWcifButton/SaveWcifButton';\nimport { getExpectedCompetitorsByRound } from '../../../logic/competitors';\nimport { roomsConfigComplete, activitiesConfigComplete, anyGroupAssignedOrCreated } from '../../../logic/activities';\nimport { removeExtensionData } from '../../../logic/wcif-extensions';\nimport { mapIn } from '../../../logic/utils';\n\nexport default class ConfigManager extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      localWcif: props.wcif,\n      tabValue: 0\n    };\n    this.expectedCompetitorsByRound = getExpectedCompetitorsByRound(props.wcif);\n  }\n\n  handleWcifChange = wcif => {\n    this.setState({ localWcif: wcif });\n  };\n\n  handleTabChange = (event, value) => {\n    this.setState({ tabValue: value });\n  };\n\n  clearConfig = () => {\n    const { localWcif } = this.state;\n    this.setState({\n      tabValue: 0,\n      localWcif: mapIn(localWcif, ['schedule', 'venues'], venue =>\n        mapIn(venue, ['rooms'], room =>\n          removeExtensionData(\n            'Room',\n            mapIn(room, ['activities'], activity => removeExtensionData('Activity', activity))\n          )\n        )\n      )\n    });\n  };\n\n  render() {\n    const { tabValue, localWcif } = this.state;\n    const { wcif, onWcifUpdate, history } = this.props;\n\n    const wcifConfigComplete = roomsConfigComplete(localWcif) && activitiesConfigComplete(localWcif);\n\n    return (\n      <Grid container spacing={8} justify=\"flex-end\">\n        <Grid item xs={12}>\n          <AppBar position=\"static\" color=\"default\">\n            <Tabs value={tabValue} onChange={this.handleTabChange} centered>\n              <Tab label=\"Rooms\" />\n              <Tab label=\"Rounds\" disabled={!roomsConfigComplete(localWcif)} />\n              <Tab label=\"General\" />\n            </Tabs>\n          </AppBar>\n        </Grid>\n        <Grid item xs={12}>\n          {tabValue === 0 && (\n            <RoomsConfig wcif={localWcif} onWcifChange={this.handleWcifChange} />\n          )}\n          {tabValue === 1 && (\n            <RoundsConfig wcif={localWcif} onWcifChange={this.handleWcifChange} expectedCompetitorsByRound={this.expectedCompetitorsByRound} />\n          )}\n          {tabValue === 2 && (\n            <Paper>\n              <Typography>General settings</Typography>\n            </Paper>\n          )}\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" component={Link} to={`/competitions/${localWcif.id}`}>\n            Cancel\n          </Button>\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" onClick={this.clearConfig} disabled={anyGroupAssignedOrCreated(localWcif)}>\n            Clear\n          </Button>\n        </Grid>\n        <Grid item>\n          <SaveWcifButton wcif={wcif} updatedWcif={localWcif} onWcifUpdate={onWcifUpdate} history={history} disabled={!wcifConfigComplete} />\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\n\nimport { activityCodeToName } from '../../../../logic/activities';\nimport { sortBy } from '../../../../logic/utils';\n\nexport default class GroupDialog extends Component {\n  render() {\n    const { wcif, groupActivity, onClose, open } = this.props;\n\n    const roles = [\n      { id: 'competitor', label: 'Competitors' },\n      { id: 'staff-scrambler', label: 'Scramblers' },\n      { id: 'staff-runner', label: 'Runners' },\n      { id: 'staff-judge', label: 'Judges' },\n    ];\n\n    const rolesWithPeople = roles.map(role => [\n      role,\n      wcif.persons.filter(person =>\n        (person.assignments || []).find(({ activityId, assignmentCode }) =>\n          activityId === groupActivity.id && assignmentCode === role.id\n        )\n      )\n    ])\n    .filter(([role, people]) => people.length > 0);\n\n    return (\n      <Dialog open={open} onClose={onClose} maxWidth={false}>\n        <DialogTitle>{activityCodeToName(groupActivity.activityCode)}</DialogTitle>\n        <DialogContent>\n          <Grid container spacing={16}>\n            {rolesWithPeople.map(([role, people]) => (\n              <Grid item xs={12} sm={6} md key={role.id}>\n                <Typography variant=\"subtitle2\">{role.label}</Typography>\n                <List dense={true} style={{ overflowY: 'auto', maxHeight: 300 }}>\n                  {sortBy(people, person => person.name).map(person => (\n                    <ListItem key={person.wcaUserId}>\n                      <ListItemText primary={person.name} />\n                    </ListItem>\n                  ))}\n                </List>\n              </Grid>\n            ))}\n            {rolesWithPeople.length === 0 && (\n              <Grid item>\n                <Typography variant=\"body2\">No assignments for this round.</Typography>\n              </Grid>\n            )}\n          </Grid>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onClose} color=\"primary\">\n            Ok\n          </Button>\n        </DialogActions>\n      </Dialog>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\n\nimport RoundsNavigation from '../../../common/RoundsNavigation/RoundsNavigation';\nimport RoomName from '../../../common/RoomName/RoomName';\nimport GroupDialog from '../GroupDialog/GroupDialog';\nimport { parseActivityCode, hasDistributedAttempts } from '../../../../logic/activities';\nimport { flatMap, shortTime } from '../../../../logic/utils';\n\nexport default class RoundWithGroups extends Component {\n  state = {\n    openedGroupActivity: null\n  };\n\n  handleGroupClick = groupActivity => {\n    this.setState({ openedGroupActivity: groupActivity });\n  };\n\n  handleDialogClose = () => {\n    this.setState({ openedGroupActivity: null });\n  };\n\n  render() {\n    const { openedGroupActivity } = this.state;\n    const { wcif } = this.props;\n    const events = wcif.events.filter(event => !hasDistributedAttempts(event.id));\n\n    return (\n      <React.Fragment>\n        <RoundsNavigation events={events} render={this.renderRound} />\n        {openedGroupActivity && (\n          <GroupDialog\n            open={true}\n            groupActivity={openedGroupActivity}\n            wcif={wcif}\n            onClose={this.handleDialogClose}\n          />\n        )}\n      </React.Fragment>\n    );\n  }\n\n  renderRound = roundId => {\n    const { wcif } = this.props;\n    const roomsWithTimezoneAndGroups = flatMap(wcif.schedule.venues, venue =>\n      venue.rooms.map(room =>\n        [room, venue.timezone, flatMap(\n          room.activities.filter(activity => activity.activityCode === roundId),\n          activity => activity.childActivities\n        )]\n      )\n    );\n\n    return (\n      <Grid container>\n        {roomsWithTimezoneAndGroups.map(([room, timezone, groupActivities]) => (\n          groupActivities.length > 0 && (\n            <Grid item xs={12} sm key={room.id}>\n              <RoomName room={room} />\n              <List>\n                {groupActivities.map(groupActivity => (\n                  <ListItem key={groupActivity.id} button onClick={() => this.handleGroupClick(groupActivity)}>\n                    <ListItemText\n                      primary={`Group ${parseActivityCode(groupActivity.activityCode).groupNumber}`}\n                      secondary={`${shortTime(groupActivity.startTime, timezone)} - ${shortTime(groupActivity.endTime, timezone)}`}\n                    />\n                  </ListItem>\n                ))}\n              </List>\n            </Grid>\n          )\n        ))}\n      </Grid>\n    );\n  };\n}\n","import { addMilliseconds, difference, findLast, flatMap, intersection, partition,\n         scaleToOne, setIn, sortBy, sortByArray, sum, uniq, updateIn, mapIn, zip } from './utils';\nimport { getExtensionData } from './wcif-extensions';\nimport { activitiesIntersection, activitiesOverlap, activityById, activityCodeToName,\n         activityDuration, activityStations, hasDistributedAttempts, maxActivityId, parseActivityCode,\n         roundActivities, roundGroupActivities, roundsMissingAssignments, updateActivity } from './activities';\nimport { acceptedPeople, age, bestAverageAndSingle, competitorsForRound, staffAssignments, staffAssignmentsForEvent } from './competitors';\n\nexport const createGroupActivities = wcif => {\n  const rounds = flatMap(wcif.events, event => event.rounds);\n  return rounds.reduce((wcif, round) => {\n    /* For FMC and MBLD the activities are already scheduled, and there is always a single group. */\n    if (hasDistributedAttempts(round.id)) return wcif;\n    /* If there are already groups created, don't override them. */\n    if (roundGroupActivities(wcif, round.id).length > 0) return wcif;\n    const currentActivityId = maxActivityId(wcif);\n    const activitiesWithGroups = roundActivities(wcif, round.id).map(activity => {\n      const { groups } = getExtensionData('Activity', activity);\n      const totalDuration = activityDuration(activity);\n      const groupDuration = totalDuration / groups;\n      const groupActivities = Array.from({ length: groups }, (_, index) => ({\n        id: null,\n        name: null,\n        activityCode: null,\n        startTime: addMilliseconds(activity.startTime, groupDuration * index),\n        endTime: addMilliseconds(activity.startTime, groupDuration * index + groupDuration),\n        childActivities: [],\n        scrambleSetId: null\n      }));\n      return { ...activity, childActivities: groupActivities };\n    });\n    sortByArray(\n      flatMap(activitiesWithGroups, activity => activity.childActivities),\n      ({ startTime, endTime }) => [startTime, endTime]\n    ).forEach((groupActivity, index) => {\n      const activityCode = `${round.id}-g${index + 1}`;\n      /* The child activities are newly created objects, so it's fine to mutate them at this point. */\n      return Object.assign(groupActivity, {\n        id: currentActivityId + index + 1,\n        name: activityCodeToName(activityCode),\n        activityCode\n      })\n    });\n    return activitiesWithGroups.reduce(updateActivity, wcif);\n  }, wcif);\n};\n\nexport const assignTasks = wcif => {\n  const roundsToAssign = roundsMissingAssignments(wcif);\n  return [assignGroups, assignScrambling, assignRunning, assignJudging]\n    .reduce((wcif, assignmentFn) => assignmentFn(wcif, roundsToAssign), wcif);\n};\n\nconst assignGroups = (wcif, roundsToAssign) => {\n  /* Sort rounds by the number of groups, so the further the more possible timeframes there are. */\n  const sortedRoundsToAssign = sortBy(roundsToAssign, round =>\n    hasDistributedAttempts(round.id) ? -Infinity : roundGroupActivities(wcif, round.id).length\n  );\n  return sortedRoundsToAssign.reduce((wcif, round) => {\n    const competitors = competitorsForRound(wcif, round.id);\n    if (hasDistributedAttempts(round.id)) {\n      /* In this case roundActivities are attempt activities, so we assign them all to the given person. */\n      const updatedCompetitors = roundActivities(wcif, round.id).reduce((competitors, activity) =>\n        assignActivity(activity, 'competitor', competitors)\n      , competitors);\n      return updatePeople(wcif, updatedCompetitors);\n    }\n    const groupActivitiesWithCapacity = flatMap(roundActivities(wcif, round.id), activity => {\n      const { capacity } = getExtensionData('Activity', activity);\n      return activity.childActivities.map(groupActivity =>\n        [groupActivity, capacity / activity.childActivities.length]\n      );\n    });\n    const [groupActivities, capacities] = zip(...groupActivitiesWithCapacity);\n    const groupSizes = calculateGroupSizes(capacities, competitors.length);\n    const initialGroups = zip(groupActivities, groupSizes).map(([activity, size]) => ({\n      id: activity.id,\n      activity,\n      size,\n      competitors: []\n    }));\n    const sortedInitialGroups = sortBy(initialGroups, ({ activity }) => parseActivityCode(activity.activityCode).groupNumber);\n    const groups = competitors.reduce((groups, competitor) => {\n      const availabilityRates = groups.map(group => availabilityRate(wcif, group.activity, competitor));\n      const maxAvailabilityRate = Math.max(...availabilityRates);\n      const mostAvailableGroups = groups.filter((group, index) => availabilityRates[index] === maxAvailabilityRate);\n      const preferredGroups = mostAvailableGroups.filter(group => !overlapsEveryoneWithSameRole(wcif, groups, group.activity, competitor));\n      const potentialGroups = preferredGroups.length > 0 ? preferredGroups : mostAvailableGroups;\n      const notFullGroup = potentialGroups.find(({ size, competitors }) => competitors.length < size);\n      if (notFullGroup) {\n        return addCompetitorToGroupEnd(groups, notFullGroup.id, competitor);\n      } else {\n        const group = potentialGroups[potentialGroups.length - 1];\n        const updatedGroups = addCompetitorToGroupEnd(groups, group.id, competitor);\n        return moveSomeoneRight(wcif, updatedGroups, group.id) || moveSomeoneLeft(wcif, updatedGroups, group.id) || updatedGroups;\n      }\n    }, sortedInitialGroups);\n    const updatedCompetitors = flatMap(groups, ({ activity, competitors }) =>\n      assignActivity(activity, 'competitor', competitors)\n    );\n    return updatePeople(wcif, updatedCompetitors);\n  }, wcif);\n};\n\nconst calculateGroupSizes = ([capacity, ...capacities], competitorCount) => {\n  if (!capacity) return [];\n  const groupSize = Math.round(capacity * competitorCount);\n  return [groupSize, ...calculateGroupSizes(scaleToOne(capacities), competitorCount - groupSize)];\n};\n\nconst moveSomeoneRight = (wcif, groups, groupId) => {\n  const group = groups.find(({ id }) => id === groupId);\n  return groups.slice(groups.indexOf(group) + 1).reduce((updatedGroups, furtherGroup) => {\n    if (updatedGroups) return updatedGroups;\n    const competitorToMove = findLast(group.competitors, competitor =>\n      availabilityRate(wcif, group.activity, competitor) === availabilityRate(wcif, furtherGroup.activity, competitor)\n      && !overlapsEveryoneWithSameRole(wcif, groups, furtherGroup.activity, competitor)\n    );\n    if (!competitorToMove) return null; // Try the next group.\n    if (furtherGroup.competitors.length < furtherGroup.size) {\n      return moveCompetitorToGroupStart(groups, groupId, furtherGroup.id, competitorToMove);\n    } else if (furtherGroup.competitors.length === furtherGroup.size) {\n      const groupsWithSpot = moveSomeoneRight(wcif, groups, furtherGroup.id);\n      return groupsWithSpot && moveCompetitorToGroupStart(groupsWithSpot, groupId, furtherGroup.id, competitorToMove);\n    }\n    return null;\n  }, null);\n};\n\nconst moveSomeoneLeft = (wcif, groups, groupId) => {\n  const group = groups.find(({ id }) => id === groupId);\n  return groups.slice(0, groups.indexOf(group)).reduceRight((updatedGroups, previousGroup) => {\n    if (updatedGroups) return updatedGroups;\n    const competitorToMove = group.competitors.find(competitor =>\n      availabilityRate(wcif, group.activity, competitor) === availabilityRate(wcif, previousGroup.activity, competitor)\n      && !overlapsEveryoneWithSameRole(wcif, groups, previousGroup.activity, competitor)\n    );\n    if (!competitorToMove) return null; // Try the previous group.\n    const groupsWithSpot = moveSomeoneRight(wcif, groups, previousGroup.id);\n    return groupsWithSpot && moveCompetitorToGroupEnd(groupsWithSpot, groupId, previousGroup.id, competitorToMove);\n  }, null);\n};\n\nconst updateCompetitorsInGroup = (groups, groupId, updater) =>\n  groups.map(group => group.id === groupId ? updateIn(group, ['competitors'], updater) : group);\n\nconst addCompetitorToGroupStart = (groups, groupId, competitor) =>\n  updateCompetitorsInGroup(groups, groupId, competitors => [competitor, ...competitors]);\n\nconst addCompetitorToGroupEnd = (groups, groupId, competitor) =>\n  updateCompetitorsInGroup(groups, groupId, competitors => [...competitors, competitor]);\n\nconst removeCompetitorFromGroup = (groups, groupId, competitor) =>\n  updateCompetitorsInGroup(groups, groupId, competitors => competitors.filter(other => other !== competitor));\n\nconst moveCompetitorToGroupStart = (groups, fromGroupId, toGroupId, competitor) =>\n  addCompetitorToGroupStart(removeCompetitorFromGroup(groups, fromGroupId, competitor), toGroupId, competitor);\n\nconst moveCompetitorToGroupEnd = (groups, fromGroupId, toGroupId, competitor) =>\n  addCompetitorToGroupEnd(removeCompetitorFromGroup(groups, fromGroupId, competitor), toGroupId, competitor);\n\nconst assignScrambling = (wcif, roundsToAssign) => {\n  /* Sort rounds by the number of competitors, so the further the more people able to scramble there are. */\n  const sortedRoundsToAssign = sortBy(roundsToAssign, round => competitorsForRound(wcif, round.id).length);\n  return sortedRoundsToAssign.reduce((wcif, round) => {\n    if (hasDistributedAttempts(round.id)) return wcif;\n    const eventId = parseActivityCode(round.id).eventId;\n    return roundActivities(wcif, round.id).reduce((wcif, activity) => {\n      const { scramblers } = getExtensionData('Activity', activity);\n      if (scramblers === 0) return wcif;\n      return activity.childActivities.reduce((wcif, groupActivity) => {\n        const staffScramblers = acceptedPeople(wcif).filter(person => person.roles.includes('staff-scrambler'));\n        const competitors = difference(competitorsForRound(wcif, round.id), staffScramblers);\n        const available = people => people.filter(person => availableDuring(wcif, groupActivity, person));\n        const sortedAvailableStaff = sortByArray(available(staffScramblers), competitor => [\n          /* Avoid difference in the number of tasks bigger than 3.\n             (General note: this is better than sorting by the number of tasks,\n             as it allows one person to be assigned a couple times in a row). */\n          Math.floor(staffAssignments(competitor).length / 3),\n          /* Prefer competitors better in the given event. */\n          ...bestAverageAndSingle(competitor, eventId)\n        ]);\n        const sortedAvailableCompetitors = sortedAvailableStaff.length >= scramblers ? [] : sortByArray(available(competitors), competitor => [\n          /* Strongly prefer people at least 10 years old. */\n          age(competitor) >= 10 ? -1 : 1,\n          /* Avoid assigning tasks to people already busy due to their role. */\n          intersection(['dataentry', 'delegate', 'organizer'], competitor.roles).length,\n          /* Avoid more than two assignments for the given event. */\n          staffAssignmentsForEvent(wcif, competitor, eventId).length >= 2 ? 1 : -1,\n          /* Avoid difference in the number of tasks bigger than 6. */\n          Math.floor(staffAssignments(competitor).length / 6),\n          /* Prefer competitors who doesn't solve soon after the group ends. */\n          competesIn15Minutes(wcif, competitor, groupActivity.endTime) ? 1 : -1,\n          /* Prefer competitors better in the given event. */\n          ...bestAverageAndSingle(competitor, eventId)\n        ]);\n        const potentialScramblers = [...sortedAvailableStaff, ...sortedAvailableCompetitors];\n        const updatedCompetitors = assignActivity(groupActivity, 'staff-scrambler', potentialScramblers.slice(0, scramblers));\n        return updatePeople(wcif, updatedCompetitors);\n      }, wcif);\n    }, wcif);\n  }, wcif);\n};\n\nconst assignRunning = (wcif, roundsToAssign) => {\n  return roundsToAssign.reduce((wcif, round) => {\n    if (hasDistributedAttempts(round.id)) return wcif;\n    const eventId = parseActivityCode(round.id).eventId;\n    return roundActivities(wcif, round.id).reduce((wcif, activity) => {\n      const { runners } = getExtensionData('Activity', activity);\n      if (runners === 0) return wcif;\n      return activity.childActivities.reduce((wcif, groupActivity) => {\n        const [staffRunners, people] = partition(acceptedPeople(wcif), person => person.roles.includes('staff-runner'));\n        const available = people => people.filter(person => availableDuring(wcif, groupActivity, person));\n        const sortedAvailableStaff = sortByArray(available(staffRunners), competitor => [\n          Math.floor(staffAssignments(competitor).length / 3),\n          competesIn15Minutes(wcif, competitor, groupActivity.endTime) ? 1 : -1\n        ]);\n        const sortedAvailablePeople = sortedAvailableStaff.length >= runners ? [] : sortByArray(available(people), competitor => [\n          age(competitor) >= 10 ? -1 : 1,\n          intersection(['dataentry', 'delegate', 'organizer'], competitor.roles).length,\n          staffAssignmentsForEvent(wcif, competitor, eventId).length >= 2 ? 1 : -1,\n          Math.floor(staffAssignments(competitor).length / 6),\n          competesIn15Minutes(wcif, competitor, groupActivity.endTime) ? 1 : -1\n        ]);\n        const potentialRunners = [...sortedAvailableStaff, ...sortedAvailablePeople];\n        const updatedPeople = assignActivity(groupActivity, 'staff-runner', potentialRunners.slice(0, runners));\n        return updatePeople(wcif, updatedPeople);\n      }, wcif);\n    }, wcif);\n  }, wcif);\n};\n\nconst assignJudging = (wcif, roundsToAssign) => {\n  return roundsToAssign.reduce((wcif, round) => {\n    if (hasDistributedAttempts(round.id)) return wcif;\n    const eventId = parseActivityCode(round.id).eventId;\n    return roundActivities(wcif, round.id).reduce((wcif, activity) => {\n      const { assignJudges } = getExtensionData('Activity', activity);\n      const stations = activityStations(wcif, activity);\n      if (!assignJudges) return wcif;\n      return activity.childActivities.reduce((wcif, groupActivity) => {\n        const [staffJudges, people] = partition(acceptedPeople(wcif), person => person.roles.includes('staff-judge'));\n        const available = people => people.filter(person => availableDuring(wcif, groupActivity, person));\n        const sortedAvailableStaff = sortByArray(available(staffJudges), competitor => [\n          /* Equally distribute tasks (judging is assigned last, so we want to eliminate inequality introduced by other assignments). */\n          staffAssignments(competitor).length,\n          competesIn15Minutes(wcif, competitor, groupActivity.endTime) ? 1 : -1\n        ]);\n        const sortedAvailablePeople = sortedAvailableStaff.length >= stations ? [] : sortByArray(available(people), competitor => [\n          age(competitor) >= 10 ? -1 : 1,\n          intersection(['dataentry', 'delegate', 'organizer'], competitor.roles).length,\n          staffAssignmentsForEvent(wcif, competitor, eventId).length >= 2 ? 1 : -1,\n          /* Equally distribute tasks (judging is assigned last, so we want to eliminate inequality introduced by other assignments). */\n          staffAssignments(competitor).length,\n          competesIn15Minutes(wcif, competitor, groupActivity.endTime) ? 1 : -1,\n          /* Prefer people that solve fewer events, to avoid overloading people solving more. */\n          competitor.registration ? competitor.registration.eventIds.length : 0,\n        ]);\n        const potentialJudges = [...sortedAvailableStaff, ...sortedAvailablePeople];\n        const updatedPeople = assignActivity(groupActivity, 'staff-judge', potentialJudges.slice(0, stations));\n        return updatePeople(wcif, updatedPeople);\n      }, wcif);\n    }, wcif);\n  }, wcif);\n};\n\nconst competesIn15Minutes = (wcif, competitor, isoString) => {\n  const competingStartTimes = (competitor.assignments || [])\n    .filter(({ assignmentCode }) => assignmentCode === 'competitor')\n    .map(({ activityId }) => activityById(wcif, activityId).startTime)\n    .filter(startTime => startTime >= isoString);\n  if (competingStartTimes.length === 0) return false;\n  const competingStart = competingStartTimes.reduce((x, y) => x < y ? x : y);\n  return (new Date(competingStart) - new Date(isoString)) <= 15 * 60 * 1000;\n};\n\nconst assignActivity = (activity, assignmentCode, competitors) =>\n  competitors.map(competitor => ({\n    ...competitor,\n    assignments: [...(competitor.assignments || []), { activityId: activity.id, assignmentCode }]\n  }));\n\nconst updatePeople = (wcif, updatedPeople) =>\n  mapIn(wcif, ['persons'], person =>\n    updatedPeople.find(updatedPerson => updatedPerson.wcaUserId === person.wcaUserId) || person\n  );\n\nconst availableDuring = (wcif, activity, competitor) =>\n  !(competitor.assignments || []).some(({ activityId }) =>\n    activitiesOverlap(activityById(wcif, activityId), activity)\n  );\n\nconst availabilityRate = (wcif, activity, competitor) => {\n  const intersections = (competitor.assignments || []).map(({ activityId }) =>\n    activitiesIntersection(activityById(wcif, activityId), activity)\n  );\n  const timeWhenBusy = sum(intersections);\n  return -(timeWhenBusy / activityDuration(activity));\n};\n\nconst overlapsEveryoneWithSameRole = (wcif, groups, activity, competitor) =>\n  intersection(['dataentry', 'delegate', 'organizer'], competitor.roles)\n    .some(role => {\n      const others = acceptedPeople(wcif).filter(person => person.roles.includes(role));\n      return others.length > 0 && others.every(other =>\n        !availableDuring(wcif, activity, other)\n        || groups.some(({ activity: groupActivity, competitors }) =>\n          competitors.includes(other) && activitiesOverlap(groupActivity, activity)\n        )\n      );\n    });\n\nexport const updateScrambleSetCount = wcif =>\n  mapIn(wcif, ['events'], event =>\n    mapIn(event, ['rounds'], round =>\n      setIn(round, ['scrambleSetCount'], scrambleSetCountForRound(wcif, round.id))\n    )\n  );\n\n/* Assume one scramble set for each unique timeframe, i.e. (startTime, endTime) pair. */\nconst scrambleSetCountForRound = (wcif, roundId) =>\n  hasDistributedAttempts(roundId) ? 1 : uniq(\n    roundGroupActivities(wcif, roundId).map(({ startTime, endTime }) => startTime + endTime)\n  ).length;\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\n\nimport GroupsNavigation from './GroupsNavigation/GroupsNavigation';\nimport SaveWcifButton from '../../common/SaveWcifButton/SaveWcifButton';\n\nimport { createGroupActivities, updateScrambleSetCount, assignTasks } from '../../../logic/groups';\nimport { allGroupsCreated, roundsMissingAssignments, anyResults } from '../../../logic/activities';\nimport { updateIn, mapIn, setIn } from '../../../logic/utils';\n\nexport default class GroupsManager extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      localWcif: props.wcif\n    };\n  }\n\n  createGroupActivities = () => {\n    const { localWcif } = this.state;\n    this.setState({\n      localWcif: updateScrambleSetCount(createGroupActivities(localWcif))\n    });\n  };\n\n  assignTasks = () => {\n    const { localWcif } = this.state;\n    const start = performance.now();\n    const wcifWithAssignments = assignTasks(localWcif);\n    console.log(wcifWithAssignments, 'Took', performance.now() - start);\n    this.setState({ localWcif: wcifWithAssignments });\n  };\n\n  clearGroups = () => {\n    const { localWcif } = this.state;\n    const persons = localWcif.persons.map(person =>\n      updateIn(person, ['assignments'], assignments =>\n        (assignments || []).filter(({ assignmentCode }) =>\n          !assignmentCode.startsWith('staff-') && assignmentCode !== 'competitor'\n        )\n      )\n    );\n    const schedule = mapIn(localWcif.schedule, ['venues'], venue =>\n      mapIn(venue, ['rooms'], room =>\n        mapIn(room, ['activities'], activity => setIn(activity, ['childActivities'], []))\n      )\n    );\n    this.setState({ localWcif: { ...localWcif, persons, schedule } });\n  };\n\n  render() {\n    const { localWcif } = this.state;\n    const { wcif, onWcifUpdate, history } = this.props;\n\n    const groupsCreated = allGroupsCreated(localWcif);\n\n    return (\n      <Grid container spacing={8} justify=\"flex-end\">\n        <Grid item xs={12}>\n          {!groupsCreated && (\n            <SnackbarContent\n              style={{ maxWidth: 'none' }}\n              message=\"To assign tasks you need to create groups first. This will also determine scramble set count for each round.\"\n              action={\n                <Button onClick={this.createGroupActivities} color=\"secondary\" size=\"small\">\n                  Create groups\n                </Button>\n              }\n            />\n          )}\n          {(groupsCreated && roundsMissingAssignments(localWcif).length > 0) && (\n            <SnackbarContent\n              style={{ maxWidth: 'none' }}\n              message=\"There are rounds with no tasks assigned.\"\n              action={\n                <Button onClick={this.assignTasks} color=\"secondary\" size=\"small\">\n                  Assign tasks\n                </Button>\n              }\n            />\n          )}\n        </Grid>\n        <Grid item xs={12}>\n          <GroupsNavigation wcif={localWcif} />\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" component={Link} to={`/competitions/${localWcif.id}`}>\n            Cancel\n          </Button>\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" onClick={this.clearGroups} disabled={anyResults(localWcif)}>\n            Clear\n          </Button>\n        </Grid>\n        <Grid item>\n          <SaveWcifButton wcif={wcif} updatedWcif={localWcif} onWcifUpdate={onWcifUpdate} history={history} />\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import { parseActivityCode } from './activities';\nimport { shortEventNameById } from './events';\n\nexport const cutoffToString = (cutoff, eventId) => {\n  if (eventId === '333mbf') {\n    return `${multibldAttemptResultToPoints(cutoff.attemptResult)} points`;\n  } else if (eventId === '333fm') {\n    return `${cutoff.attemptResult} moves`;\n  } else {\n    return centisecondsToClockFormat(cutoff.attemptResult);\n  }\n}\n\nexport const timeLimitToString = (timeLimit) => {\n  const { centiseconds, cumulativeRoundIds } = timeLimit;\n  const clockFormat = centisecondsToClockFormat(centiseconds);\n  if (cumulativeRoundIds.length === 0) {\n    return clockFormat;\n  } else if (cumulativeRoundIds.length === 1) {\n    return `${clockFormat} in total`;\n  } else {\n    const roundStrings = cumulativeRoundIds.map(roundId => {\n      const { eventId, roundNumber } = parseActivityCode(roundId);\n      return `${shortEventNameById(eventId)} R${roundNumber}`;\n    });\n    return `${clockFormat} total for ${roundStrings.join(', ')}`;\n  }\n}\n\nconst multibldAttemptResultToPoints = attemptResult =>\n  99 - (Math.floor(attemptResult / 10000000) % 100);\n\nconst centisecondsToClockFormat = centiseconds => {\n  const date = new Date(null);\n  date.setUTCMilliseconds(centiseconds * 10);\n  return date.toISOString().substr(11, 11).replace(/^[0:]*(?!\\.)/g, '');\n};\n","import pdfMake from 'pdfmake/build/pdfmake';\n\n/* Asynchronously download fonts bundle for PDF Make. */\nfetch('vfs-fonts.bundle.json')\n  .then(response => response.json())\n  .then(vfsFonts => pdfMake.vfs = vfsFonts);\n\nconst singleFileFont = file => ({\n  normal: file, bold: file, italic: file, bolditalics: file\n})\n\npdfMake.fonts = {\n  Roboto: {\n    normal: 'Roboto-Regular.ttf',\n    bold: 'Roboto-Medium.ttf',\n    italics: 'Roboto-Italic.ttf',\n    bolditalics: 'Roboto-MediumItalic.ttf'\n  },\n  WenQuanYiZenHei: singleFileFont('WenQuanYiZenHei.ttf'),\n  NotoSansThai: singleFileFont('NotoSansThai-Regular.ttf'),\n  NotoSansArabic: singleFileFont('NotoSansArabic-Regular.ttf'),\n  NotoSansGeorgian: singleFileFont('NotoSansGeorgian-Regular.ttf'),\n  NotoSansArmenian: singleFileFont('NotoSansArmenian-Regular.ttf')\n};\n\nexport default pdfMake;\n","import { inRange } from './utils';\n\nconst determineFont = text => {\n  const code = text.charCodeAt(0);\n  /* Based on https://en.wikipedia.org/wiki/Unicode_block */\n  if (inRange(code, 0x0000, 0x052F)) {\n    return 'Roboto';\n  } else if (inRange(code, 0x0600, 0x06FF) || inRange(code, 0x0750, 0x077F)) {\n    return 'NotoSansArabic';\n  } else if (inRange(code, 0x0E00, 0x0E7F)) {\n    return 'NotoSansThai';\n  } else if (inRange(code, 0x0530, 0x058F)) {\n    return 'NotoSansArmenian';\n  } else if (inRange(code, 0x10A0, 0x10FF)) {\n    return 'NotoSansGeorgian';\n  } else {\n    /* Default to WenQuanYiZenHei as it supports the most characters (mostly CJK). */\n    return 'WenQuanYiZenHei';\n  }\n};\n\nexport const pdfName = (name, swapLatinWithLocalNames = false) => {\n  /* Note: support normal and fullwidth parentheses. */\n  const [, latinName, localName] = name.match(/(.+)\\s*[(](.+)[)]/) || [null, name, null];\n  if (!localName) return latinName;\n  const pdfNames = [latinName, { text: localName, font: determineFont(localName) }];\n  const [first, second] = swapLatinWithLocalNames ? pdfNames.reverse() : pdfNames;\n  return [first, ' (', second, ')'];\n};\n","import { flatMap, sortBy, chunk } from './utils';\nimport { parseActivityCode, roundGroupActivities } from './activities';\nimport { eventNameById } from './events';\nimport { cutoffToString, timeLimitToString } from './formatters';\nimport { competitorsForRound } from './competitors';\n\nimport pdfMake from './pdfmake';\nimport { pdfName } from './pdf-utils';\n\n/* See: https://github.com/bpampuch/pdfmake/blob/3da11bd8148b190808b06f7bc27883102bf82917/src/standardPageSizes.js#L10 */\nconst pageWidth = 595.28;\nconst pageHeight = 841.89;\nconst scorecardMargin = 20;\n\nconst maxAttemptCountByFormat = { '1': 1, '2': 2, '3': 3, 'm': 3, 'a': 5 };\n\nexport const downloadScorecards = (wcif, rounds) => {\n  const start = performance.now();\n  const pdfDefinition = scorecardsPdfDefinition(wcif, rounds);\n  console.log('Definition took', performance.now() - start);\n  const start2 = performance.now();\n  pdfMake.createPdf(pdfDefinition).download(`${wcif.id}-scorecards.pdf`);\n  console.log('PDF creation took', performance.now() - start2);\n};\n\nconst scorecardsPdfDefinition = (wcif, rounds) => ({\n  background: [{\n    canvas: [\n      cutLine({ x1: scorecardMargin, y1: pageHeight / 2, x2: pageWidth - scorecardMargin, y2: pageHeight / 2 }),\n      cutLine({ x1: pageWidth / 2, y1: scorecardMargin, x2: pageWidth / 2, y2:  pageHeight - scorecardMargin })\n    ]\n  }],\n  pageMargins: [scorecardMargin, scorecardMargin],\n  content: {\n    layout: {\n      /* Outer margin is done using pageMargins, we use padding for the remaining inner margins. */\n      paddingLeft  : i => i % 2 === 0 ? 0 : scorecardMargin,\n      paddingRight : i => i % 2 === 0 ? scorecardMargin : 0,\n      paddingTop   : i => i % 2 === 0 ? 0 : scorecardMargin,\n      paddingBottom: i => i % 2 === 0 ? scorecardMargin : 0,\n      /* Get rid of borders. */\n      hLineWidth: () => 0,\n      vLineWidth: () => 0\n    },\n    table: {\n      widths: ['*', '*'],\n      /* A4 page height minus vertical margins, divided into a half. */\n      heights: (pageHeight - 4 * scorecardMargin) / 2,\n      dontBreakRows: true,\n      body: chunk(scorecards(wcif, rounds), 2)\n    }\n  }\n});\n\nconst cutLine = properties => ({\n  ...properties,\n  type: 'line', lineWidth: 0.1, dash: { length: 10 }, lineColor: '#888888'\n});\n\nconst scorecards = (wcif, rounds) => {\n  return flatMap(rounds, round => {\n    const sortedGroupActivities = sortBy(roundGroupActivities(wcif, round.id),\n      ({ activityCode }) => parseActivityCode(activityCode).groupNumber\n    );\n    const sortedCompetitors = competitorsForRound(wcif, round.id);\n    let scorecardNumber = sortedCompetitors.length;\n    return flatMap(sortedGroupActivities, groupActivity => {\n      const competitors = sortedCompetitors.filter(competitor =>\n        (competitor.assignments || []).find(assignment =>\n          assignment.activityId === groupActivity.id && assignment.assignmentCode === 'competitor'\n        )\n      );\n      const groupScorecards = competitors.map(competitor =>\n        scorecard({\n          scorecardNumber: scorecardNumber--,\n          competitionName: wcif.shortName,\n          activityCode: groupActivity.activityCode,\n          round,\n          competitor\n        })\n      );\n      const scorecardsOnLastPage = groupScorecards.length % 4;\n      return scorecardsOnLastPage === 0\n        ? groupScorecards\n        : groupScorecards.concat(Array.from({ length: 4 - scorecardsOnLastPage }, () => ({})));\n    });\n  });\n};\n\nconst scorecard = ({\n  scorecardNumber,\n  competitionName,\n  activityCode,\n  round,\n  competitor\n}) => {\n  const { eventId, roundNumber, groupNumber } = parseActivityCode(activityCode);\n  const { cutoff, timeLimit } = round;\n  const attemptCount = maxAttemptCountByFormat[round.format];\n\n  return [\n    { text: scorecardNumber, fontSize: 10 },\n    { text: competitionName, bold: true, fontSize: 15, margin: [0, 0, 0, 10], alignment: 'center' },\n    {\n      margin: [25, 0, 0, 0],\n      table: {\n        widths: ['*', 'auto', 'auto'],\n        body: [\n          columnLabels(['Event', 'Round', 'Group']),\n          [eventNameById(eventId), { text: roundNumber, alignment: 'center' }, { text: groupNumber, alignment: 'center' }]\n        ]\n      }\n    },\n    {\n      margin: [25, 0, 0, 0],\n      table: {\n        widths: ['auto', '*'],\n        body: [\n          columnLabels(['ID', 'Name']),\n          [{ text: competitor.registrantId, alignment: 'center' }, { text: pdfName(competitor.name), maxHeight: 20 /* See: https://github.com/bpampuch/pdfmake/issues/264#issuecomment-108347567 */ }]\n        ]\n      }\n    },\n    {\n      margin: [0, 10, 0, 0],\n      table: {\n        widths: [16, 25, '*', 25, 25], /* Note: 16 (width) + 4 + 4 (defult left and right padding) + 1 (left border) = 25 */\n        body: [\n          columnLabels(['', 'Scr', 'Result', 'Judge', 'Comp'], { alignment: 'center' }),\n          ...attemptRows(cutoff, attemptCount),\n          [{ text: 'Extra attempt', ...noBorder, colSpan: 5, margin: [0, 1], fontSize: 10 }],\n          attemptRow('_'),\n          [{ text: '', ...noBorder, colSpan: 5, margin: [0, 1] }]\n        ]\n      }\n    },\n    {\n      fontSize: 10,\n      columns: [\n        cutoff ? { text: `Cutoff: ${cutoffToString(cutoff, eventId)}`, alignment: 'center' } : {},\n        timeLimit ? { text: `Time limit: ${timeLimitToString(timeLimit)}`, alignment: 'center' } : {}\n      ]\n    },\n  ];\n};\n\nconst columnLabels = (labels, style = {}) =>\n  labels.map(label => ({\n    ...style, ...noBorder, fontSize: 9, text: label\n  }));\n\nconst attemptRows = (cutoff, attemptCount) =>\n  Array.from({ length: attemptCount }, (_, attemptIndex) => attemptRow(attemptIndex + 1))\n    .reduce((rows, attemptRow, attemptIndex) =>\n      (attemptIndex + 1 === attemptCount)\n        ? [...rows, attemptRow]\n        : [ ...rows, attemptRow,\n            attemptsSeparator(cutoff && (attemptIndex + 1 === cutoff.numberOfAttempts))\n          ]\n    , []);\n\nconst attemptsSeparator = cutoffLine => [{\n  ...noBorder, colSpan: 5, margin: [0, 1],\n  columns: !cutoffLine ? [] : [{\n    canvas: [{\n      type: 'line',\n      x1: 0, y1: 0,\n      x2: (pageWidth - 4 * scorecardMargin) / 2, y2: 0,\n      dash: { length: 5 },\n    }]\n  }]\n}];\n\nconst attemptRow = attemptNumber =>\n  [{ text: attemptNumber, ...noBorder, fontSize: 20, bold: true, alignment: 'center' }, {}, {}, {} ,{}];\n\nconst noBorder = { border: [false, false, false, false] };\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nimport CubingIcon from '../../common/CubingIcon/CubingIcon';\nimport { downloadScorecards } from '../../../logic/scorecards';\nimport { roundsMissingScorecards, parseActivityCode, activityCodeToName } from '../../../logic/activities';\nimport { difference } from '../../../logic/utils';\n\nexport default class PrintingManager extends Component {\n  constructor(props) {\n    super(props);\n    const rounds = roundsMissingScorecards(this.props.wcif);\n    const selectedRounds = rounds.every(round => parseActivityCode(round.id).roundNumber === 1) ? rounds : []\n    this.state = {\n      selectedRounds\n    };\n  }\n\n  handleDownloadClick = () => {\n    downloadScorecards(this.props.wcif, this.state.selectedRounds);\n  };\n\n  handleRoundClick = round => event => {\n    const { selectedRounds } = this.state;\n    this.setState({\n      selectedRounds: selectedRounds.includes(round)\n        ? difference(selectedRounds, [round])\n        : [...selectedRounds, round]\n    });\n  };\n\n  render() {\n    const { selectedRounds } = this.state;\n    const { wcif } = this.props;\n    const rounds = roundsMissingScorecards(wcif);\n\n    return (\n      <Grid container spacing={8} justify=\"flex-end\">\n        <Grid item xs={12}>\n          <Paper style={{ padding: 16 }}>\n            <Typography variant=\"h5\">Scorecards</Typography>\n            <List style={{ width: 400 }}>\n              {rounds.map(round => (\n                <ListItem key={round.id} button onClick={this.handleRoundClick(round)}>\n                  <ListItemIcon>\n                    <CubingIcon eventId={parseActivityCode(round.id).eventId} />\n                  </ListItemIcon>\n                  <ListItemText primary={activityCodeToName(round.id)} />\n                  <Checkbox\n                    checked={selectedRounds.includes(round)}\n                    tabIndex={-1}\n                    disableRipple\n                    style={{ padding: 0 }}\n                  />\n                </ListItem>\n              ))}\n            </List>\n            <Button\n              onClick={this.handleDownloadClick}\n              disabled={selectedRounds.length === 0}\n            >\n              Download scorecards\n            </Button>\n          </Paper>\n        </Grid>\n        <Grid item>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            component={Link}\n            to={`/competitions/${wcif.id}`}\n          >\n            Done\n          </Button>\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TablePagination from '@material-ui/core/TablePagination';\nimport TableRow from '@material-ui/core/TableRow';\nimport TextField from '@material-ui/core/TextField';\nimport Toolbar from '@material-ui/core/Toolbar';\n\nimport SaveWcifButton from '../../common/SaveWcifButton/SaveWcifButton';\nimport { acceptedPeople } from '../../../logic/competitors';\nimport { difference } from '../../../logic/utils';\n\nconst roles = [\n  { id: 'staff-scrambler', name: 'Scrambler' },\n  { id: 'staff-judge', name: 'Judge' },\n  { id: 'staff-runner', name: 'Runner' },\n  { id: 'staff-dataentry', name: 'Data entry' },\n];\n\nexport default class RolesManager extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      localWcif: props.wcif,\n      page: 0,\n      searchString: ''\n    }\n  }\n\n  handleSearchChange = event => {\n    this.setState({ searchString: event.target.value });\n  };\n\n  handleChangePage = (event, page) => {\n    this.setState({ page });\n  };\n\n  handleRoleChange(roleId, personWcaUserId, event) {\n    const { localWcif } = this.state;\n    const { checked } = event.target;\n\n    this.setState({\n      localWcif: {\n        ...localWcif,\n        persons: localWcif.persons.map(person =>\n          person.wcaUserId === personWcaUserId\n            ? { ...person, roles: checked ? [...person.roles, roleId] : difference(person.roles, [roleId]) }\n            : person\n        )\n      }\n    });\n  }\n\n  clearRoles = () => {\n    const { localWcif } = this.state;\n    const roleIds = roles.map(role => role.id);\n    this.setState({\n      localWcif: {\n        ...localWcif,\n        persons: localWcif.persons.map(person =>\n          ({ ...person, roles: difference(person.roles, roleIds)})\n        )\n      }\n    });\n  };\n\n  render() {\n    const { page, searchString, localWcif } = this.state;\n    const { wcif, onWcifUpdate, history } = this.props;\n    const rowsPerPage = 5;\n    const rowsPerPageOptions = [5];\n\n    const people = acceptedPeople(localWcif)\n      .filter(person => person.name.match(new RegExp(searchString, 'i')));\n\n    return (\n      <Grid container spacing={8} justify=\"flex-end\">\n        <Grid item xs={12}>\n          <Paper>\n            <Toolbar>\n              <TextField label=\"Search\" value={searchString} onChange={this.handleSearchChange} />\n            </Toolbar>\n            <div style={{ overflowX: 'auto' }}>\n              <Table>\n                <TableHead>\n                  <TableRow>\n                    <TableCell>Person</TableCell>\n                    {roles.map(role =>\n                      <TableCell key={role.id} padding=\"none\" style={{ textAlign: 'center' }}>{role.name}</TableCell>\n                    )}\n                  </TableRow>\n                </TableHead>\n                <TableBody>\n                  {people.slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage).map(person =>\n                    <TableRow key={person.wcaUserId} hover>\n                      <TableCell>{person.name}</TableCell>\n                      {roles.map(role =>\n                        <TableCell key={role.id} padding=\"checkbox\" style={{ textAlign: 'center' }}>\n                          <Checkbox\n                            checked={person.roles.includes(role.id)}\n                            onChange={this.handleRoleChange.bind(this, role.id, person.wcaUserId)}\n                          />\n                        </TableCell>\n                      )}\n                    </TableRow>\n                  )}\n                </TableBody>\n              </Table>\n            </div>\n            <TablePagination\n              component=\"div\"\n              count={people.length}\n              rowsPerPage={rowsPerPage}\n              rowsPerPageOptions={rowsPerPageOptions}\n              page={page}\n              onChangePage={this.handleChangePage}\n            />\n          </Paper>\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" component={Link} to={`/competitions/${localWcif.id}`}>\n            Cancel\n          </Button>\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" onClick={this.clearRoles}>\n            Clear\n          </Button>\n        </Grid>\n        <Grid item>\n          <SaveWcifButton wcif={wcif} updatedWcif={localWcif} onWcifUpdate={onWcifUpdate} history={history} />\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Route, Switch } from 'react-router-dom';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport Typography from '@material-ui/core/Typography';\n\nimport CompetitionMenu from './CompetitionMenu/CompetitionMenu';\nimport ConfigManager from './ConfigManager/ConfigManager';\nimport GroupsManager from './GroupsManager/GroupsManager';\nimport PrintingManager from './PrintingManager/PrintingManager';\nimport RolesManager from './RolesManager/RolesManager';\n\nimport { getCompetitionWcif } from '../../logic/wca-api';\n\nexport default class Competition extends Component {\n  state = {\n    wcif: null,\n    loading: true\n  };\n\n  componentDidMount() {\n    getCompetitionWcif(this.props.match.params.competitionId)\n      .then(wcif => this.setState({ wcif, loading: false }))\n  }\n\n  handleWcifUpdate = wcif => {\n    this.setState({ wcif });\n  };\n\n  render() {\n    const { wcif, loading } = this.state;\n    const { match } = this.props;\n\n    return loading ? <LinearProgress /> : (\n      <div>\n        <Typography variant=\"h5\" style={{ marginBottom: 16 }}>\n          {wcif.name}\n        </Typography>\n        <Switch>\n          <Route exact path={match.url} render={\n            props => <CompetitionMenu {...props} wcif={wcif} baseUrl={match.url} />\n          } />\n          <Route path={`${match.url}/roles`} render={\n            props => <RolesManager {...props} wcif={wcif} onWcifUpdate={this.handleWcifUpdate} />\n          } />\n          <Route path={`${match.url}/config`} render={\n            props => <ConfigManager {...props} wcif={wcif} onWcifUpdate={this.handleWcifUpdate} />\n          } />\n          <Route path={`${match.url}/groups`} render={\n            props => <GroupsManager {...props} wcif={wcif} onWcifUpdate={this.handleWcifUpdate} />\n          } />\n          <Route path={`${match.url}/printing`} render={\n            props => <PrintingManager {...props} wcif={wcif} />\n          } />\n        </Switch>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport Paper from '@material-ui/core/Paper';\nimport Icon from '@material-ui/core/Icon';\n\nimport { getUpcomingManageableCompetitions } from '../../logic/wca-api';\nimport { sortBy } from '../../logic/utils';\n\nexport default class CompetitionList extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      competitions: [],\n      loading: true\n    }\n  }\n\n  componentDidMount() {\n    getUpcomingManageableCompetitions()\n      .then(competitions => sortBy(competitions, competition => competition['start_date']))\n      .then(competitions => this.setState({ competitions, loading: false }));\n  }\n\n  render() {\n    const { competitions, loading } = this.state;\n\n    return (\n      <div>\n        <Paper>\n          <List subheader={<ListSubheader>Your competitions</ListSubheader>}>\n            {!loading && competitions.length === 0 &&\n              <ListItem>\n                <ListItemIcon>\n                  <Icon>sentiment_very_dissatisfied</Icon>\n                </ListItemIcon>\n                <ListItemText primary=\"You have no upcoming competitions to manage.\" />\n              </ListItem>\n            }\n            {competitions.map(competition =>\n              <ListItem key={competition.id} button component={Link} to={`/competitions/${competition.id}`}>\n                <ListItemText primary={competition.name} />\n              </ListItem>\n            )}\n          </List>\n          {loading && <LinearProgress />}\n        </Paper>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport Icon from '@material-ui/core/Icon';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\n\nimport './Footer.css';\n\nconst Footer = () => (\n  <Grid container className=\"footer\">\n    <Grid item style={{ flexGrow: 1 }}>\n      <Typography>\n        Made with <Icon className=\"footer-icon\">favorite</Icon>\n        {' '}by <a href=\"https://github.com/jonatanklosko\" target=\"_blank\" rel=\"noopener noreferrer\">Jonatan Kosko</a>\n      </Typography>\n    </Grid>\n    <Grid item>\n      <Typography>\n        <a href=\"https://github.com/jonatanklosko/groupifier\" target=\"_blank\" rel=\"noopener noreferrer\">\n          GitHub\n        </a>\n      </Typography>\n    </Grid>\n    <Grid item style={{ marginLeft: 8 }}>\n      <Typography>\n        <a href=\"mailto:jonatanklosko@gmail.com\" target=\"_blank\" rel=\"noopener noreferrer\">\n          Contact\n        </a>\n      </Typography>\n    </Grid>\n  </Grid>\n);\n\nexport default Footer;\n","import React from 'react';\nimport AppBar from '@material-ui/core/AppBar';\nimport Button from '@material-ui/core/Button';\nimport Icon from '@material-ui/core/Icon';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport { Link } from 'react-router-dom';\n\nconst Header = ({ isSignedIn, onSignIn, onSignOut }) => (\n  <AppBar position=\"static\" color=\"primary\">\n    <Toolbar>\n      <Typography variant=\"h6\" color=\"inherit\" style={{ flexGrow: 1 }}>\n        <Link to={isSignedIn ? '/competitions' : '/'}>\n          <Icon style={{ fontSize: '1.5em', verticalAlign: 'middle', marginRight: 10 }}>people</Icon>\n          Groupifier\n        </Link>\n      </Typography>\n      {isSignedIn\n        ? <Button color=\"inherit\" onClick={onSignOut}>Sign out</Button>\n        : <Button color=\"inherit\" onClick={onSignIn}>Sign in</Button>}\n    </Toolbar>\n  </AppBar>\n);\n\nexport default Header;\n","import React from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport Icon from '@material-ui/core/Icon';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\n\nconst features = [\n  'Automatically calculates a suitable group size.',\n  'Assigns tasks to people (scrambling, judging). Allows to select scramblers manually from a list.',\n  'Sorts competitors by their official results, so that each subsequent group represents a better level. When told otherwise, minimizes the amount of people with the same name in each group.',\n  'Handles events being held simultaneous by creating separate groups for people taking part in both main and side event.',\n  'Generates PDFs containing scorecards, personal cards with task assignment and a summary for each round.',\n  'Fetches cutoffs and time limits from the WCA website and puts them on scorecards.',\n  'Optionally sets the number of scramble groups for each round based on advancement conditions and saves that to the WCA website, so there is no need for entering them manually.'\n];\n\nconst Home = () => (\n  <Grid container spacing={24} direction=\"column\">\n    <Grid item>\n      <Typography variant=\"h4\">What is Groupifier?</Typography>\n    </Grid>\n    <Grid item>\n      <Typography variant=\"subtitle1\">\n        It is a tool meant for WCA competition organizers.\n        Its main objective is to simplify the process of splitting competitors into groups\n        and provide the best result with minimal configuration.\n      </Typography>\n    </Grid>\n    <Grid item>\n      <Typography variant=\"h4\">What does it do?</Typography>\n    </Grid>\n    <Grid item>\n      <List>\n        {features.map(feature =>\n          <ListItem key={feature}>\n            <ListItemIcon>\n              <Icon>check</Icon>\n            </ListItemIcon>\n            <ListItemText primary={feature} />\n          </ListItem>\n        )}\n      </List>\n    </Grid>\n  </Grid>\n);\n\nexport default Home;\n","import React, { Component } from 'react';\nimport { HashRouter as Router, Route, Switch, Redirect } from 'react-router-dom';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Grid from '@material-ui/core/Grid';\n\nimport Competition from '../Competition/Competition';\nimport CompetitionList from '../CompetitionList/CompetitionList';\nimport Footer from '../Footer/Footer';\nimport Header from '../Header/Header';\nimport Home from '../Home/Home';\n\nimport { isSignedIn, signIn, signOut } from '../../logic/auth';\n\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isSignedIn: isSignedIn()\n    };\n  }\n\n  handleSignIn = () => {\n    signIn();\n  };\n\n  handleSignOut = () => {\n    signOut();\n    this.setState({ isSignedIn: false })\n  };\n\n  render() {\n    return (\n      <Router>\n        <div>\n          <CssBaseline />\n          <Header\n            isSignedIn={this.state.isSignedIn}\n            onSignIn={this.handleSignIn}\n            onSignOut={this.handleSignOut}\n          />\n          <Grid container justify=\"center\">\n            <Grid item xs={12} md={8} style={{ padding: 16 }}>\n              {this.state.isSignedIn\n                ? <Switch>\n                    <Route path=\"/competitions/:competitionId\" component={Competition} />\n                    <Route path=\"/competitions\" component={CompetitionList} />\n                    <Redirect to=\"/competitions\" />\n                  </Switch>\n                : <Switch>\n                    <Route exact path=\"/\" component={Home} />\n                    <Redirect to=\"/\" />\n                  </Switch>\n              }\n            </Grid>\n          </Grid>\n          <Route exact path=\"/\" component={Footer} />\n        </div>\n      </Router>\n    );\n  }\n}\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport App from './components/App/App';\nimport registerServiceWorker from './registerServiceWorker';\nimport { initializeAuth } from './logic/auth';\n\ninitializeAuth();\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}