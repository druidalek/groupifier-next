{"version":3,"sources":["polyfills.js","logic/utils.js","logic/wcif-extensions.js","logic/events.js","logic/activities.js","logic/formulas.js","components/Competition/CompetitionMenu/CompetitionMenu.js","components/common/RoomName/RoomName.js","components/common/PositiveIntegerInput/PositiveIntegerInput.js","components/common/ZeroablePositiveIntegerInput/ZeroablePositiveIntegerInput.js","components/Competition/ConfigManager/RoomConfig/RoomConfig.js","components/Competition/ConfigManager/RoomsConfig/RoomsConfig.js","components/common/CubingIcon/CubingIcon.js","components/common/EventSelect/EventSelect.js","components/common/RoundsNavigation/RoundPanel/RoundPanel.js","components/common/RoundsNavigation/RoundsNavigation.js","components/Competition/ConfigManager/RoundActivityConfig/RoundActivityConfig.js","components/Competition/ConfigManager/RoundConfig/RoundConfig.js","components/Competition/ConfigManager/RoundsConfig/RoundsConfig.js","components/Competition/ConfigManager/GeneralConfig/GeneralConfig.js","logic/wca-env.js","logic/auth.js","logic/wca-api.js","components/common/SaveWcifButton/SaveWcifButton.js","logic/wcif.js","logic/competitors.js","components/Competition/ConfigManager/ConfigManager.js","components/Competition/GroupsManager/GroupDialog/GroupDialog.js","components/Competition/GroupsManager/GroupsNavigation/GroupsNavigation.js","logic/groups.js","components/Competition/GroupsManager/GroupsManager.js","logic/documents/pdfmake.js","logic/formatters.js","logic/documents/pdf-utils.js","logic/documents/scorecards.js","logic/documents/group-overview.js","components/Competition/PrintingManager/Scorecards/Scorecards.js","logic/documents/competitor-cards.js","components/Competition/PrintingManager/CompetitorCards/CompetitorCards.js","components/Competition/PrintingManager/PrintingManager.js","components/Competition/RolesManager/RolesManager.js","logic/wcif-validation.js","logic/__cubecomps__.js","components/Competition/Competition.js","components/CompetitionList/CompetitionList.js","components/Footer/Footer.js","components/Header/Header.js","components/Home/Home.js","components/App/App.js","registerServiceWorker.js","index.js"],"names":["smoothscroll","polyfill","updateIn","object","updater","property","properyChain","length","setIn","value","mapIn","mapper","array","map","isPresentDeep","obj","Object","values","every","pluralize","count","singular","plural","scaleToOne","arr","arrSum","sum","x","flatMap","fn","reduce","xs","concat","groupBy","zip","arrs","_","i","findLast","predicate","reduceRight","found","undefined","intersection","ys","filter","includes","difference","partition","sortCompare","y","sortBy","slice","sort","sortByArray","Map","result","firstResult","get","a","b","chunk","size","times","n","Array","from","index","uniq","Set","inRange","addMilliseconds","isoString","milliseconds","Date","getTime","toISOString","isoTimeDiff","first","second","Math","abs","shortTime","timeZone","toLocaleTimeString","hour","minute","groupifierExtensionId","extensionName","buildGroupifierExtension","data","id","specUrl","setExtensionData","wcifEntity","otherExtensions","extensions","extension","defaultExtensionData","ActivityConfig","RoomConfig","stations","CompetitionConfig","localNamesFirst","scorecardsBackgroundUrl","competitorsSortingRule","noTasksForNewcomers","tasksForOwnEventsOnly","getExtensionData","find","defaultData","removeExtensionData","events","name","shortName","eventNameById","eventId","propertyById","event","sortWcifEvents","wcifEvents","wcifEvent","findIndex","parseActivityCode","activityCode","match","e","r","g","roundNumber","parseInt","groupNumber","attemptNumber","activityCodeToName","join","hasDistributedAttempts","activityDuration","startTime","endTime","activityDurationString","timezone","activitiesOverlap","rooms","wcif","schedule","venues","venue","stationsByActivity","activityId","room","activities","some","roomByActivity","allActivities","allChildActivities","childActivities","activitiesByIdCachedBySchedule","activityById","has","activitiesById","activity","set","updateActivity","updatedActivity","populateRoundActivitiesConfig","expectedCompetitorsByRound","defaults","rounds","round","expectedRoundCompetitors","roundActivities","shouldHaveGroups","capacities","capacity","competitors","groups","preferredGroupSize","calculatedGroupCount","max","suggestedGroupCount","scramblers","assignScramblers","groupCompetitors","floor","min","suggestedScramblerCount","runners","assignRunners","suggestedRunnerCount","assignJudges","anyActivityConfig","activitiesConfigComplete","roomsConfigComplete","roundId","startsWith","groupActivitiesByRound","roomsWithTimezoneAndGroups","activityAssigned","persons","person","assignments","assignment","groupActivitiesAssigned","roundsWithoutResults","results","attempts","roundsMissingResults","roundsMissingAssignments","roundsMissingScorecards","anyGroupAssignedOrCreated","clearGroupsAndAssignments","clearableRounds","clearableRoundIds","clearableActivityIds","assignmentCode","menuItems","path","text","icon","enabled","anyCompetitorAssignment","CompetitionMenu","baseUrl","Paper","List","menuItem","ListItem","key","button","component","Link","to","disabled","ListItemIcon","Icon","ListItemText","primary","RoomName","Typography","variant","style","display","width","height","marginRight","borderRadius","backgroundColor","color","PositiveIntegerInput","handleKeyPress","preventDefault","handleTextFieldChange","newValue","target","Number","isNaN","props","onChange","this","TextField","type","onKeyPress","PureComponent","ZeroablePositiveIntegerInput","handleCheckboxChange","checked","inputRef","React","createRef","prevProps","current","focus","Checkbox","handleInputChange","label","Component","RoomsConfig","handleRoomChange","updatedRoom","onWcifChange","padding","Grid","container","spacing","item","lg","CubingIcon","fontSize","className","EventSelect","selected","Tooltip","title","placement","IconButton","onClick","opacity","RoundWithGroups","handlePanelChange","expanded","scrollToElement","node","window","scrollTo","top","parentNode","getBoundingClientRect","behavior","render","ExpansionPanel","CollapseProps","onEntered","ExpansionPanelSummary","expandIcon","ExpansionPanelDetails","RoundsNavigation","handleEventChange","setState","selectedEventId","handleRoundChange","expandedRoundId","state","selectedEvent","justify","RoundActivityConfig","handlePropertyChange","nextProps","expectedCompetitors","groupSize","groupsHelperText","scramblersHelperText","runnersHelperText","groupsCreated","groupsAssigned","direction","helperText","margin","FormControlLabel","control","RoundConfig","handleActivityChange","activitiesWithRooms","RoundsConfig","handleNextClick","renderRound","activityCodesMissingConfig","activitiesWithUnpopulatedConfig","roleLabel","Button","competitorsSortingRules","description","GeneralConfig","FormControl","fullWidth","InputLabel","htmlFor","Select","inputProps","MenuItem","FormHelperText","production","URLSearchParams","location","search","WCA_ORIGIN","WCA_OAUTH_CLIENT_ID","localStorageKey","wcaAccessToken","localStorage","getItem","signIn","params","client_id","response_type","redirect_uri","oauthRedirectUri","scope","toString","origin","pathname","staging","appUri","replace","signOut","removeItem","isSignedIn","saveWcifChanges","previousWcif","newWcif","competitionId","keysDiff","keys","Promise","resolve","newObj","wcaApiFetch","method","body","JSON","stringify","fetchOptions","baseApiUrl","fetch","assign","headers","Headers","then","response","ok","Error","statusText","json","SaveWcifButton","saving","failed","handleSaveClick","updatedWcif","onWcifUpdate","history","push","catch","handleSnackbarClose","Snackbar","open","message","anchorOrigin","vertical","horizontal","autoHideDuration","onClose","visibility","CircularProgress","position","eventById","best","personalBest","personalBests","pb","Infinity","bestAverageAndSingle","competitor","getExpectedCompetitorsByRound","firstRound","nextRounds","acceptedPeopleRegisteredForEvent","nextRound","advancementCondition","nextRoundCompetitors","sortedCompetitors","level","competitorsExpectedToAdvance","competitorsForRound","competitorsInRound","roundById","personId","registrantId","personById","previous","previousRound","ranking","age","diffMs","now","birthdate","staffAssignments","staffAssignmentsForEvent","acceptedPeople","registration","status","eventIds","hasAssignment","ConfigManager","handleWcifChange","localWcif","handleTabChange","tabValue","clearConfig","withoutCompetitionConfig","wcifConfigComplete","AppBar","Tabs","centered","Tab","GroupDialog","groupActivity","rolesWithPeople","role","Dialog","maxWidth","DialogTitle","DialogContent","people","sm","md","dense","overflowY","maxHeight","wcaUserId","DialogActions","openedGroupActivity","handleGroupClick","handleDialogClose","groupActivities","secondary","Fragment","createGroupActivities","currentActivityId","maxActivityId","activitiesWithGroups","groupDuration","scrambleSetId","forEach","assignTasks","roundsToAssign","assignGroups","assignScrambling","assignRunning","assignJudging","assignmentFn","sortedCompetitorsForRound","activitiesByAttempt","updatedCompetitors","attemptActivities","competitorsPerActivity","ceil","activitiesWithCompetitors","assignActivity","updatePeople","initialGroups","sortedGroupActivitiesWithSize","availabilityRates","group","availabilityRate","maxAvailabilityRate","mostAvailableGroups","preferredGroups","overlapsEveryoneWithSameRole","potentialGroups","notFullGroup","addCompetitorToGroupEnd","updatedGroups","moveSomeoneRight","moveSomeoneLeft","competitorCount","groupActivitiesWithCapacity","groupSizes","calculateGroupSizes","sortedByRanks","groupCount","indexOf","competitorsByName","split","competitorsWithSameName","chunkSize","groupId","furtherGroup","competitorToMove","moveCompetitorToGroupStart","groupsWithSpot","previousGroup","moveCompetitorToGroupEnd","updateCompetitorsInGroup","removeCompetitorFromGroup","other","fromGroupId","toGroupId","addCompetitorToGroupStart","staffScramblers","roles","available","availableDuring","sortedAvailableStaff","sortedAvailableCompetitors","wcaId","presenceRate","competesIn15Minutes","potentialScramblers","staffRunners","sortedAvailablePeople","potentialRunners","updatedPeople","judges","staffJudges","potentialJudges","competingStartTimes","competingStart","time","activitiesThisDay","getDay","startTimes","endTimes","previousEndTime","nextStartTime","updatedPerson","intersections","middleStart","middleEnd","activitiesIntersection","others","updateScrambleSetCount","scrambleSetCountForRound","GroupsManager","clearGroups","allGroupsCreated","SnackbarContent","action","pink","vfsFonts","pdfMake","vfs","singleFileFont","file","normal","bold","italic","bolditalics","fonts","Roboto","italics","WenQuanYiZenHei","NotoSansThai","NotoSansArabic","NotoSansGeorgian","NotoSansArmenian","cutoffToString","cutoff","multibldAttemptResultToPoints","attemptResult","centisecondsToClockFormat","timeLimitToString","timeLimit","centiseconds","cumulativeRoundIds","clockFormat","roundStrings","shortEventNameById","date","setUTCMilliseconds","substr","determineFont","code","charCodeAt","pdfName","swapLatinWithLocalNames","short","latinName","localName","pdfNames","font","reverse","getImageDataUrl","url","bri","bg","w","h","t","output","encoding","maxAttemptCountByFormat","downloadScorecards","imageData","pdfDefinition","scorecardsPdfDefinition","scorecards","createPdf","download","downloadBlankScorecards","blankScorecards","scorecardList","background","absolutePosition","image","canvas","cutLine","x1","y1","pageHeight","x2","pageWidth","y2","pageMargins","content","layout","paddingLeft","paddingRight","paddingTop","paddingBottom","hLineWidth","vLineWidth","table","widths","heights","dontBreakRows","properties","lineWidth","dash","lineColor","groupsWithCompetitors","groupActivitiesWithCompetitors","scorecardNumber","groupScorecards","scorecard","competitionName","attemptCount","format","scorecardsOnLastPage","expectedCompetitorCount","attemptCounts","alignment","columnLabels","attemptRows","noBorder","colSpan","attemptRow","columns","labels","attemptIndex","rows","attemptsSeparator","numberOfAttempts","cutoffLine","border","downloadGroupOverview","groupOverviewPdfDefinition","footer","currentPage","pageCount","overviewForGroup","headersWithPeople","header","unbreakable","stack","ul","Scorecards","handleScorecardsDownloadClick","selectedRounds","handleGroupOverviewDownloadClick","handleBlankScorecardsDownloadClick","handleRoundClick","missingScorecards","tabIndex","disableRipple","flexGrow","downloadCompetitorCards","competitorCardsPdfDefinition","competitorCards","cards","competitorCard","cardsInLastRow","tasks","task","assignmentCodes","groupsText","CompetitorCards","handleDownloadClick","PrintingManager","RolesManager","handleSearchChange","searchString","handleChangePage","page","clearRoles","roleIds","roleId","personWcaUserId","allSortedPeople","searchPart","RegExp","Toolbar","alignItems","overflowX","Table","TableHead","TableRow","TableCell","textAlign","TableBody","hover","handleRoleChange","bind","TablePagination","rowsPerPage","rowsPerPageOptions","onChangePage","validateWcif","advancementConditionErrors","roundActivityErrors","__withCubecompsIds__","getCompetitions","competitions","competition","getCompetition","normalizeName","toLowerCase","trim","cubecompsApiFetch","competitionCubecompsId","Competition","loading","errors","handleWcifUpdate","error","LinearProgress","marginBottom","Switch","Route","exact","CompetitionList","oneWeekAgo","managed_by_me","start","getUpcomingManageableCompetitions","subheader","ListSubheader","links","version","Footer","red","href","rel","Header","onSignIn","onSignOut","verticalAlign","features","Home","feature","theme","createMuiTheme","palette","indigo","grey","typography","useNextVariants","App","handleSignIn","handleSignOut","MuiThemeProvider","minHeight","flexDirection","CssBaseline","Redirect","Boolean","hostname","hash","hashParams","setItem","expiresInSeconds","expirationTime","redirectPath","initializeAuth","ReactDOM","document","getElementById","navigator","serviceWorker","ready","unregister"],"mappings":"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","file":"static/js/main.e0e6498a.chunk.js","sourcesContent":["import 'core-js/features/url-search-params';\nimport 'core-js/features/object/values';\n\nimport smoothscroll from 'smoothscroll-polyfill';\nsmoothscroll.polyfill();\n","/**\n * Returns a copy of the object with the value at the specified path transformed by the update function.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Function} updater\n * @returns {Object}\n */\nexport const updateIn = (object, [property, ...properyChain], updater) =>\n  properyChain.length === 0\n    ? { ...object, [property]: updater(object[property]) }\n    : { ...object, [property]: updateIn(object[property], properyChain, updater) };\n\n/**\n * Returns a copy of the object with the value at the specified path set to the given one.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {*} value\n * @returns {Object}\n */\nexport const setIn = (object, properyChain, value) =>\n  updateIn(object, properyChain, () => value);\n\n/**\n * Returns a copy of the object with the value at the specified path merged with the given one.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Object} newValue\n * @returns {Object}\n */\nexport const mergeIn = (object, properyChain, newValue) =>\n  updateIn(object, properyChain, currentValue => ({ ...currentValue, ...newValue }));\n\n/**\n * Returns a copy of the object with the array at the specified path mapped with the given function.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Object} mapper\n * @returns {Object}\n */\nexport const mapIn = (object, properyChain, mapper) =>\n  updateIn(object, properyChain, array => array && array.map(mapper));\n\n/**\n * Returns object's value at the specified path or the default value if it doesn't exist.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {*} defaultValue\n * @returns {*}\n */\nexport const getIn = (object, [property, ...propertyChain], defaultValue = null) =>\n  object ? (\n    propertyChain.length === 0\n      ? (object.hasOwnProperty(property) ? object[property] : defaultValue)\n      : getIn(object[property], propertyChain, defaultValue)\n  ) : defaultValue;\n\n/**\n * Checks if the given value is an object.\n *\n * @param {*} value\n * @returns {boolean}\n */\nconst isObject = obj => obj === Object(obj);\n\n/**\n * When given an object, deeply checks if it doesn't contain null values.\n * Otherwise, checks if the given value is not null.\n *\n * @param {*} value\n * @returns {boolean}\n */\nexport const isPresentDeep = value =>\n  isObject(value)\n    ? Object.values(value).every(isPresentDeep)\n    : value != null;\n\n/**\n * Pluralizes a word according to the given number.\n * When no plural form given, uses singular form with an 's' appended.\n *\n * @param {number} count\n * @param {string} singular\n * @param {string} plural\n * @returns {string}\n */\nexport const pluralize = (count, singular, plural) =>\n  `${count} ${count === 1 ? singular : (plural || singular + 's')}`\n\n/**\n * Returns a new array with items summing up to 1, preserving elements proportionality.\n * When the given array is empty, returns an empty array.\n *\n * @param {Array} arr\n * @returns {Array}\n */\nexport const scaleToOne = arr => {\n  if (arr.length === 0) return [];\n  const arrSum = sum(arr);\n  return arr.map(x => arrSum !== 0 ? x / arrSum : 1 / arr.length);\n};\n\n/**\n * Applies the given function to the elements and returns the first truthy value of these calls.\n *\n * @param {Array} arr\n * @returns {*}\n */\nexport const firstResult = (arr, fn) =>\n  arr.reduce((result, x) => result || fn(x), null);\n\nexport const flatMap = (arr, fn) =>\n  arr.reduce((xs, x) => xs.concat(fn(x)), []);\n\nexport const groupBy = (arr, fn) =>\n  arr.reduce((obj, x) =>\n    updateIn(obj, [fn(x)], xs => (xs || []).concat(x))\n  , {});\n\nexport const zip = (...arrs) =>\n  arrs.length === 0 ? [] : arrs[0].map((_, i) => arrs.map(arr => arr[i]));\n\nexport const findLast = (arr, predicate) =>\n  arr.reduceRight((found, x) =>\n    found !== undefined ? found : (predicate(x) ? x : undefined)\n  , undefined);\n\nexport const intersection = (xs, ys) =>\n  xs.filter(x => ys.includes(x));\n\nexport const difference = (xs, ys) =>\n  xs.filter(x => !ys.includes(x));\n\nexport const partition = (xs, fn) =>\n  [xs.filter(fn), xs.filter(x => !fn(x))];\n\nconst sortCompare = (x, y) =>\n  x < y ? -1 : (x > y ? 1 : 0);\n\nexport const sortBy = (arr, fn) =>\n  arr.slice().sort((x, y) => sortCompare(fn(x), fn(y)));\n\nexport const sortByArray = (arr, fn) => {\n  const values = new Map(arr.map(x => [x, fn(x)])); /* Compute every value once. */\n  return arr.slice().sort((x, y) =>\n    firstResult(zip(values.get(x), values.get(y)), ([a, b]) => sortCompare(a, b))\n  );\n}\n\nexport const chunk = (arr, size) =>\n  arr.length <= size\n    ? [arr]\n    : [arr.slice(0, size), ...chunk(arr.slice(size), size)];\n\nexport const times = (n, fn) =>\n  Array.from({ length: n }, (_, index) => fn(index));\n\nexport const uniq = arr =>\n  [...new Set(arr)];\n\nexport const sum = arr =>\n  arr.reduce((x, y) => x + y, 0);\n\nexport const pick = (obj, keys) =>\n  keys.reduce((newObj, key) => ({ ...newObj, [key]: obj[key] }), {});\n\nexport const inRange = (x, a, b) =>\n  a <= x && x <= b;\n\nexport const addMilliseconds = (isoString, milliseconds) =>\n  new Date(new Date(isoString).getTime() + milliseconds).toISOString();\n\nexport const isoTimeDiff = (first, second) =>\n  Math.abs(new Date(first) - new Date(second));\n\nexport const shortTime = (isoString, timeZone = 'UTC') =>\n  new Date(isoString).toLocaleTimeString('en-US', { timeZone, hour: 'numeric', minute: 'numeric' });\n","const groupifierExtensionId = extensionName => `groupifier.${extensionName}`;\n\nconst buildGroupifierExtension = (extensionName, data) => ({\n  id: groupifierExtensionId(extensionName),\n  specUrl: `https://jonatanklosko.github.io/groupifier-next/wcif-extensions/${extensionName}.json`,\n  data\n});\n\nexport const setExtensionData = (extensionName, wcifEntity, data) => {\n  const otherExtensions = wcifEntity.extensions\n    .filter(extension => extension.id !== groupifierExtensionId(extensionName));\n  return {\n    ...wcifEntity,\n    extensions: [...otherExtensions, buildGroupifierExtension(extensionName, data)]\n  };\n};\n\nconst defaultExtensionData = {\n  ActivityConfig: null, /* This always gets generated, so it's fine for it to be null until then. */\n  RoomConfig: {\n    stations: null\n  },\n  CompetitionConfig: {\n    localNamesFirst: false,\n    scorecardsBackgroundUrl: '',\n    competitorsSortingRule: 'ranks',\n    noTasksForNewcomers: false,\n    tasksForOwnEventsOnly: false\n  }\n};\n\nexport const getExtensionData = (extensionName, wcifEntity) => {\n  const extension = wcifEntity.extensions\n    .find(extension => extension.id === groupifierExtensionId(extensionName));\n  const defaultData = defaultExtensionData[extensionName];\n  if (defaultData === null) return extension && extension.data;\n  return extension ? { ...defaultData, ...extension.data } : defaultData;\n};\n\nexport const removeExtensionData = (extensionName, wcifEntity) => ({\n  ...wcifEntity,\n  extensions: wcifEntity.extensions.filter(extension =>\n    extension.id !== groupifierExtensionId(extensionName)\n  )\n});\n","import { sortBy } from './utils';\n\nconst events = [\n  { id: '333',    name: '3x3x3 Cube',         shortName: '3x3'   },\n  { id: '222',    name: '2x2x2 Cube',         shortName: '2x2'   },\n  { id: '444',    name: '4x4x4 Cube',         shortName: '4x4'   },\n  { id: '555',    name: '5x5x5 Cube',         shortName: '5x5'   },\n  { id: '666',    name: '6x6x6 Cube',         shortName: '6x6'   },\n  { id: '777',    name: '7x7x7 Cube',         shortName: '7x7'   },\n  { id: '333bf',  name: '3x3x3 Blindfolded',  shortName: '3BLD'  },\n  { id: '333fm',  name: '3x3x3 Fewest Moves', shortName: 'FMC'   },\n  { id: '333oh',  name: '3x3x3 One-Handed',   shortName: '3OH'   },\n  { id: '333ft',  name: '3x3x3 With Feet',    shortName: '3WF'   },\n  { id: 'minx',   name: 'Megaminx',           shortName: 'Minx'  },\n  { id: 'pyram',  name: 'Pyraminx',           shortName: 'Pyra'  },\n  { id: 'clock',  name: 'Clock',              shortName: 'Clock' },\n  { id: 'skewb',  name: 'Skewb',              shortName: 'Skewb' },\n  { id: 'sq1',    name: 'Square-1',           shortName: 'Sq1'   },\n  { id: '444bf',  name: '4x4x4 Blindfolded',  shortName: '4BLD'  },\n  { id: '555bf',  name: '5x5x5 Blindfolded',  shortName: '5BLD'  },\n  { id: '333mbf', name: '3x3x3 Multi-Blind',  shortName: 'MBLD'  }\n];\n\nexport const eventNameById = eventId =>\n  propertyById('name', eventId);\n\nexport const shortEventNameById = eventId =>\n  propertyById('shortName', eventId);\n\nconst propertyById = (property, eventId) =>\n  events.find(event => event.id === eventId)[property];\n\nexport const sortWcifEvents = wcifEvents =>\n  sortBy(wcifEvents, wcifEvent => events.findIndex(event => event.id === wcifEvent.id));\n","import { mapIn, updateIn, setIn, flatMap, zip, scaleToOne, shortTime, isPresentDeep } from './utils';\nimport { getExtensionData, setExtensionData } from './wcif-extensions';\nimport { suggestedGroupCount, suggestedScramblerCount, suggestedRunnerCount } from './formulas';\nimport { eventNameById } from './events';\n\nexport const parseActivityCode = activityCode => {\n  const [, e, r, g, a] = activityCode.match(/(\\w+)(?:-r(\\d+))?(?:-g(\\d+))?(?:-a(\\d+))?/);\n  return {\n    eventId: e,\n    roundNumber: r && parseInt(r, 10),\n    groupNumber: g && parseInt(g, 10),\n    attemptNumber: a && parseInt(a, 10)\n  };\n};\n\nexport const activityCodeToName = activityCode => {\n  const { eventId, roundNumber, groupNumber, attemptNumber } = parseActivityCode(activityCode);\n  return [\n    eventId && eventNameById(eventId),\n    roundNumber && `Round ${roundNumber}`,\n    groupNumber && `Group ${groupNumber}`,\n    attemptNumber && `Attempt ${attemptNumber}`\n  ].filter(x => x).join(', ');\n};\n\nexport const hasDistributedAttempts = activityCode =>\n  ['333fm', '333mbf'].includes(parseActivityCode(activityCode).eventId);\n\nexport const activityDuration = ({ startTime, endTime }) =>\n  new Date(endTime) - new Date(startTime);\n\nexport const activityDurationString = ({ startTime, endTime }, timezone = 'UTC') =>\n  `${shortTime(startTime, timezone)} - ${shortTime(endTime, timezone)}`;\n\nexport const activitiesOverlap = (first, second) =>\n  new Date(first.startTime) < new Date(second.endTime) && new Date(second.startTime) < new Date(first.endTime);\n\nexport const activitiesIntersection = (first, second) => {\n  if (!activitiesOverlap(first, second)) return 0;\n  const [, middleStart, middleEnd] = [first.startTime, first.endTime, second.startTime, second.endTime].sort();\n  /* Time distance between the two middle points in time. */\n  return new Date(middleEnd) - new Date(middleStart);\n};\n\nexport const rooms = wcif =>\n  flatMap(wcif.schedule.venues, venue => venue.rooms);\n\nexport const roomByActivity = (wcif, activityId) =>\n  rooms(wcif).find(room =>\n    room.activities.some(({ id }) => id === activityId)\n  );\n\nexport const stationsByActivity = (wcif, activityId) =>\n  getExtensionData('RoomConfig', roomByActivity(wcif, activityId)).stations\n\nconst allActivities = wcif => {\n  const allChildActivities = ({ childActivities }) =>\n    childActivities.length > 0\n      ? [...childActivities, ...flatMap(childActivities, allChildActivities)]\n      : childActivities;\n  const activities = flatMap(rooms(wcif), room => room.activities);\n  return [...activities, ...flatMap(activities, allChildActivities)];\n};\n\nexport const maxActivityId = wcif =>\n  Math.max(...allActivities(wcif).map(activity => activity.id));\n\n/* Assigning tasks invokes activityById enormous number of times.\n   But during that process activities (schedule) don't change.\n   Caching is gives an invaluable speed boost in this case. */\nconst activitiesByIdCachedBySchedule = new Map();\n\nexport const activityById = (wcif, activityId) => {\n  if (activitiesByIdCachedBySchedule.has(wcif.schedule)) {\n    return activitiesByIdCachedBySchedule.get(wcif.schedule).get(activityId);\n  } else {\n    const activities = allActivities(wcif);\n    const activitiesById = new Map(activities.map(activity => [activity.id, activity]));\n    activitiesByIdCachedBySchedule.set(wcif.schedule, activitiesById);\n    return activitiesById.get(activityId);\n  }\n}\n\nexport const updateActivity = (wcif, updatedActivity) =>\n  mapIn(wcif, ['schedule', 'venues'], venue =>\n    mapIn(venue, ['rooms'], room =>\n      mapIn(room, ['activities'], activity =>\n        activity.id === updatedActivity.id ? updatedActivity : activity\n      )\n    )\n  );\n\nexport const populateRoundActivitiesConfig = (wcif, expectedCompetitorsByRound, defaults) => {\n  const activitiesWithConfig = flatMap(wcif.events, event => {\n    return flatMap(event.rounds, round => {\n      const { roundNumber } = parseActivityCode(round.id);\n      const expectedRoundCompetitors = expectedCompetitorsByRound[round.id].length;\n      const activities = roundActivities(wcif, round.id).filter(shouldHaveGroups);\n      const alreadyHaveConfig = activities.every(activity => getExtensionData('ActivityConfig', activity));\n      if (alreadyHaveConfig) return activities;\n      const capacities = scaleToOne(activities.map(activity =>\n        stationsByActivity(wcif, activity.id) * activityDuration(activity)\n      ));\n      return zip(activities, capacities).map(([activity, capacity]) => {\n        const stations = stationsByActivity(wcif, activity.id);\n        const competitors = Math.round(capacity * expectedRoundCompetitors);\n        const groups = suggestedGroupCount(competitors, stations, roundNumber);\n        const scramblers = defaults.assignScramblers ? suggestedScramblerCount(competitors / groups, stations) : 0;\n        const runners = defaults.assignRunners ? suggestedRunnerCount(competitors / groups, stations) : 0;\n        const assignJudges = stations > 0 && defaults.assignJudges;\n        return setExtensionData('ActivityConfig', activity, {\n          capacity, groups, scramblers, runners, assignJudges\n        });\n      });\n    });\n  });\n  return activitiesWithConfig.reduce(updateActivity, wcif);\n};\n\nexport const shouldHaveGroups = activity => {\n  const { eventId, roundNumber, groupNumber, attemptNumber } = parseActivityCode(activity.activityCode);\n  return !!(eventId && roundNumber && !groupNumber && !attemptNumber);\n};\n\nexport const anyActivityConfig = wcif =>\n  rooms(wcif).some(room =>\n    room.activities.some(activity => getExtensionData('ActivityConfig', activity))\n  );\n\nexport const activitiesWithUnpopulatedConfig = wcif =>\n  flatMap(rooms(wcif), room =>\n    room.activities\n      .filter(shouldHaveGroups)\n      .filter(activity => !getExtensionData('ActivityConfig', activity))\n  );\n\nexport const activitiesConfigComplete = wcif =>\n  rooms(wcif).every(room =>\n    room.activities\n      .filter(shouldHaveGroups)\n      .map(activity => getExtensionData('ActivityConfig', activity))\n      .every(isPresentDeep)\n  );\n\nexport const roomsConfigComplete = wcif =>\n  rooms(wcif)\n    .map(room => getExtensionData('RoomConfig', room))\n    .every(isPresentDeep);\n\nexport const roundActivities = (wcif, roundId) =>\n  flatMap(rooms(wcif), room =>\n    room.activities.filter(({ activityCode }) => activityCode.startsWith(roundId))\n  );\n\nexport const groupActivitiesByRound = (wcif, roundId) =>\n  flatMap(roundActivities(wcif, roundId), activity =>\n    hasDistributedAttempts(roundId) ? [activity] : activity.childActivities\n  );\n\nexport const roomsWithTimezoneAndGroups = (wcif, roundId) =>\n  flatMap(wcif.schedule.venues, venue =>\n    venue.rooms.map(room =>\n      [room, venue.timezone, flatMap(\n        room.activities.filter(activity => activity.activityCode === roundId),\n        activity => activity.childActivities\n      )]\n    )\n  );\n\nexport const activityAssigned = (wcif, activityId) =>\n  wcif.persons.some(person =>\n    person.assignments.some(assignment => assignment.activityId === activityId)\n  );\n\nexport const groupActivitiesAssigned = (wcif, roundId) =>\n  groupActivitiesByRound(wcif, roundId).some(activity =>\n    activityAssigned(wcif, activity.id)\n  );\n\nexport const roundsWithoutResults = wcif =>\n  flatMap(wcif.events, event => event.rounds).filter(round =>\n    round.results.length === 0 || round.results.every(result => result.attempts.length === 0)\n  );\n\n/* Round is missing results if it has all results empty\n   or it's the first round and has no results at all.\n   In other words no one's competed in such round, but we know who should compete in it. */\nconst roundsMissingResults = wcif =>\n  wcif.events.map(event =>\n    event.rounds.find(round => {\n      const { roundNumber } = parseActivityCode(round.id);\n      return (round.results.length === 0 && roundNumber === 1)\n          || (round.results.length > 0 && round.results.every(result => result.attempts.length === 0));\n    })\n  )\n  .filter(round => round);\n\nexport const roundsMissingAssignments = wcif =>\n  roundsMissingResults(wcif)\n    .filter(round => !groupActivitiesAssigned(wcif, round.id));\n\nexport const roundsMissingScorecards = wcif =>\n  roundsMissingResults(wcif)\n    .filter(round => groupActivitiesAssigned(wcif, round.id))\n    .filter(round => parseActivityCode(round.id).eventId !== '333fm');\n\nexport const allGroupsCreated = wcif =>\n  wcif.events.every(event =>\n    event.rounds.every(round =>\n      groupActivitiesByRound(wcif, round.id).length > 0\n    )\n  );\n\nexport const anyCompetitorAssignment = wcif =>\n  wcif.persons.some(person =>\n    person.assignments.some(assignment => assignment.assignmentCode === 'competitor')\n  );\n\nexport const anyGroupAssignedOrCreated = wcif =>\n  wcif.events.some(event =>\n    event.rounds.some(round =>\n      hasDistributedAttempts(event.id)\n        ? groupActivitiesAssigned(wcif, round.id)\n        : groupActivitiesByRound(wcif, round.id).length > 0\n    )\n  );\n\nexport const anyResults = wcif =>\n  wcif.events.some(event =>\n    event.rounds.some(round => round.results.length > 0)\n  );\n\n/* Clears groups and assignments only for rounds without results. */\nexport const clearGroupsAndAssignments = wcif => {\n  const clearableRounds = roundsWithoutResults(wcif);\n  const clearableRoundIds = clearableRounds.map(({ id }) => id);\n  const clearableActivities = flatMap(clearableRounds, round =>\n    groupActivitiesByRound(wcif, round.id)\n  );\n  const clearableActivityIds = clearableActivities.map(({ id }) => id);\n\n  const persons = wcif.persons.map(person =>\n    updateIn(person, ['assignments'], assignments =>\n      assignments\n        .filter(({ activityId }) => !clearableActivityIds.includes(activityId))\n        .filter(({ assignmentCode }) =>\n          !assignmentCode.startsWith('staff-') && assignmentCode !== 'competitor'\n        )\n    )\n  );\n  const schedule = mapIn(wcif.schedule, ['venues'], venue =>\n    mapIn(venue, ['rooms'], room =>\n      mapIn(room, ['activities'], activity =>\n        clearableRoundIds.includes(activity.activityCode) ? setIn(activity, ['childActivities'], []) : activity\n      )\n    )\n  );\n  return { ...wcif, persons, schedule };\n};\n","export const suggestedGroupCount = (competitors, stations, roundNumber) => {\n  if (stations === 0) return 1;\n  const preferredGroupSize = stations * 1.7;\n  /* We calculate the number of perfectly-sized groups, and round it up starting from x.1,\n     this way we don't end up with much more than the perfect amount of people in a single group.\n     Having more small groups is preferred over having fewer big groups. */\n  const calculatedGroupCount = Math.round(competitors / preferredGroupSize + 0.4);\n  /* Suggest at least 2 groups for first rounds, so that there are people to scramble. */\n  return Math.max(calculatedGroupCount, roundNumber === 1 ? 2 : 1);\n};\n\n/* Take min{groupCompetitors, stations} (i.e. stations in use) and suggest one scrambler for each 5 of them. */\nexport const suggestedScramblerCount = (groupCompetitors, stations) =>\n  Math.floor(1 + (Math.min(groupCompetitors, stations) - 1) / 5);\n\n/* Take min{groupCompetitors, stations} (i.e. stations in use) and suggest one runner for each 8 of them. */\nexport const suggestedRunnerCount = (groupCompetitors, stations) =>\n  Math.floor(1 + (Math.min(groupCompetitors, stations) - 1) / 8);\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport Icon from '@material-ui/core/Icon';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Paper from '@material-ui/core/Paper';\n\nimport { roomsConfigComplete, activitiesConfigComplete, anyCompetitorAssignment } from '../../../logic/activities';\n\nconst menuItems = [\n  { path: '/roles', text: \"Edit roles\", icon: 'perm_contact_calendar', enabled: wcif => true },\n  { path: '/config', text: \"Configure\", icon: 'settings', enabled: wcif => true },\n  { path: '/groups', text: \"Manage groups\", icon: 'people', enabled: wcif => roomsConfigComplete(wcif) && activitiesConfigComplete(wcif) },\n  { path: '/printing', text: \"Print documents\", icon: 'print', enabled: wcif => anyCompetitorAssignment(wcif) }\n];\n\nconst CompetitionMenu = ({ wcif, baseUrl }) => (\n  <Paper>\n    <List>\n      {menuItems.map(menuItem =>\n        <ListItem key={menuItem.path} button component={Link} to={`${baseUrl}${menuItem.path}`} disabled={!menuItem.enabled(wcif)}>\n          <ListItemIcon><Icon>{menuItem.icon}</Icon></ListItemIcon>\n          <ListItemText primary={menuItem.text} />\n        </ListItem>\n      )}\n    </List>\n  </Paper>\n);\n\nexport default CompetitionMenu;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\n\nconst RoomName = ({ room }) => (\n  <Typography variant=\"subtitle2\">\n    <span style={{\n        display: 'inline-block',\n        width: 10, height: 10, marginRight: 5,\n        borderRadius: '100%', backgroundColor: room.color\n      }}\n    />\n    <span>{room.name}</span>\n  </Typography>\n);\n\nexport default RoomName;\n","import React, { PureComponent } from 'react';\nimport TextField from '@material-ui/core/TextField';\n\nexport default class PositiveIntegerInput extends PureComponent {\n  /* Prevent from entering characters like minus, plus and dot.\n     These don't trigger the change event for numeric input. */\n  handleKeyPress = event => {\n    if (event.key.match(/\\D/)) event.preventDefault();\n  };\n\n  handleTextFieldChange = event => {\n    const newValue = event.target.value.length > 0 ? parseInt(event.target.value, 10) : null;\n    if (newValue === null || (!Number.isNaN(newValue) && newValue >= 1)) {\n      this.props.onChange(event, newValue);\n    }\n  };\n\n  render() {\n    const { value, onChange, ...props } = this.props;\n\n    return (\n      <TextField\n        {...props}\n        type=\"number\"\n        value={value === null ? '' : value}\n        onKeyPress={this.handleKeyPress}\n        onChange={this.handleTextFieldChange}\n      />\n    );\n  }\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport Checkbox from '@material-ui/core/Checkbox';\n\nimport PositiveIntegerInput from '../PositiveIntegerInput/PositiveIntegerInput';\n\nexport default class ZeroablePositiveIntegerInput extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.inputRef = React.createRef();\n  }\n\n  handleCheckboxChange = event => {\n    const { checked } = event.target;\n    this.props.onChange(event, checked ? null : 0);\n  };\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.value === 0 && this.props.value !== 0) {\n      this.inputRef.current.focus();\n    }\n  }\n\n  render() {\n    const { value, disabled, ...props } = this.props;\n\n    return (\n      <Fragment>\n        <PositiveIntegerInput {...props} value={value} disabled={value === 0 || disabled} inputRef={this.inputRef} />\n        <Checkbox name={props.name} checked={value !== 0} onChange={this.handleCheckboxChange} disabled={disabled} />\n      </Fragment>\n    );\n  }\n};\n","import React, { Component } from 'react';\n\nimport RoomName from '../../../common/RoomName/RoomName';\nimport ZeroablePositiveIntegerInput from '../../../common/ZeroablePositiveIntegerInput/ZeroablePositiveIntegerInput';\nimport { setIn } from '../../../../logic/utils';\nimport { getExtensionData, setExtensionData } from '../../../../logic/wcif-extensions';\n\nexport default class RoomConfig extends Component {\n  handleInputChange = (event, value) => {\n    const { room, onChange } = this.props;\n    onChange(\n      setExtensionData('RoomConfig', room, setIn(\n        getExtensionData('RoomConfig', room), [event.target.name], value)\n      )\n    );\n  };\n\n  render() {\n    const { room, disabled } = this.props;\n    const { stations } = getExtensionData('RoomConfig', room);\n\n    return (\n      <div>\n        <RoomName room={room} />\n        <ZeroablePositiveIntegerInput\n          label=\"Timing stations\"\n          value={stations}\n          name=\"stations\"\n          onChange={this.handleInputChange}\n          disabled={disabled}\n        />\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\n\nimport RoomConfig from '../RoomConfig/RoomConfig';\nimport { mapIn } from '../../../../logic/utils';\nimport { anyActivityConfig, rooms } from '../../../../logic/activities';\n\nexport default class RoomsConfig extends Component {\n  handleRoomChange = updatedRoom => {\n    const { wcif, onWcifChange } = this.props;\n    onWcifChange(\n      mapIn(wcif, ['schedule', 'venues'], venue =>\n        mapIn(venue, ['rooms'], room =>\n          room.id === updatedRoom.id ? updatedRoom : room\n        )\n      )\n    );\n  };\n\n  render() {\n    const { wcif } = this.props;\n    /* Disable rooms configuration once activities config has been populated. */\n    const disabled = anyActivityConfig(wcif);\n\n    return (\n      <Paper style={{ padding: 16 }}>\n        <Grid container spacing={16}>\n          {rooms(wcif).map(room =>\n            <Grid item lg key={room.id}>\n              <RoomConfig room={room} onChange={this.handleRoomChange} disabled={disabled} />\n            </Grid>\n          )}\n        </Grid>\n      </Paper>\n    );\n  }\n}\n","import React from 'react';\n\nconst CubingIcon = ({ eventId, ...props }) => (\n  <span style={{ fontSize: 24 }} className={`cubing-icon event-${eventId}`} {...props} />\n);\n\nexport default CubingIcon;\n","import React, { Component } from 'react';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport CubingIcon from '../CubingIcon/CubingIcon';\nimport { eventNameById } from '../../../logic/events';\n\nexport default class EventSelect extends Component {\n  render() {\n    const { selected, events } = this.props;\n\n    return (\n      <div>\n        {events.map(event => (\n          <Tooltip key={event.id} title={eventNameById(event.id)} placement=\"top\">\n            <IconButton onClick={() => this.props.onChange(event.id)}>\n              <CubingIcon eventId={event.id} style={{ opacity: event.id === selected ? 1 : 0.3 }} />\n            </IconButton>\n          </Tooltip>\n        ))}\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport Icon from '@material-ui/core/Icon';\nimport Typography from '@material-ui/core/Typography';\n\nimport { activityCodeToName } from '../../../../logic/activities';\n\nexport default class RoundWithGroups extends Component {\n  handlePanelChange = (event, expanded) => {\n    const { onChange, roundId } = this.props;\n    onChange(expanded ? roundId : null);\n  };\n\n  scrollToElement = node => {\n    /* Node is the panel content, so the panel is its parent. */\n    window.scrollTo({\n      top: node.parentNode.getBoundingClientRect().top - 8,\n      behavior: 'smooth'\n    });\n  };\n\n  render() {\n    const { expanded, roundId, render } = this.props;\n\n    return (\n      <ExpansionPanel\n        onChange={this.handlePanelChange}\n        expanded={expanded}\n        CollapseProps={{ onEntered: this.scrollToElement }}\n      >\n        <ExpansionPanelSummary expandIcon={<Icon>expand_more</Icon>}>\n          <Typography variant=\"subtitle1\">\n            {activityCodeToName(roundId)}\n          </Typography>\n        </ExpansionPanelSummary>\n        <ExpansionPanelDetails>\n          {expanded && render(roundId)}\n        </ExpansionPanelDetails>\n      </ExpansionPanel>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Grid from '@material-ui/core/Grid';\n\nimport EventSelect from '../../common/EventSelect/EventSelect';\nimport RoundPanel from './RoundPanel/RoundPanel';\n\nexport default class RoundsNavigation extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedEventId: props.events[0].id,\n      expandedRoundId: null\n    };\n  }\n\n  handleEventChange = eventId => {\n    this.setState({ selectedEventId: eventId });\n  };\n\n  handleRoundChange = roundId => {\n    this.setState({ expandedRoundId: roundId });\n  };\n\n  render() {\n    const { selectedEventId, expandedRoundId } = this.state;\n    const { events, render } = this.props;\n    const selectedEvent = events.find(event => event.id === selectedEventId);\n\n    return (\n      <Grid container spacing={8} justify=\"flex-end\">\n        <Grid item xs={12}>\n          <EventSelect selected={selectedEventId} events={events} onChange={this.handleEventChange} />\n        </Grid>\n        <Grid item xs={12}>\n          {selectedEvent.rounds.map(round => (\n            <RoundPanel\n              key={round.id}\n              expanded={round.id === expandedRoundId}\n              roundId={round.id}\n              render={render}\n              onChange={this.handleRoundChange}\n            />\n          ))}\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Grid from '@material-ui/core/Grid';\n\nimport PositiveIntegerInput from '../../../common/PositiveIntegerInput/PositiveIntegerInput';\nimport ZeroablePositiveIntegerInput from '../../../common/ZeroablePositiveIntegerInput/ZeroablePositiveIntegerInput';\nimport { setIn, pluralize } from '../../../../logic/utils';\nimport { getExtensionData, setExtensionData } from '../../../../logic/wcif-extensions';\nimport { activityAssigned } from '../../../../logic/activities';\n\nexport default class RoundActivityConfig extends Component {\n  handlePropertyChange = (property, value) => {\n    const { activity, onChange } = this.props;\n    onChange(\n      setExtensionData('ActivityConfig', activity, setIn(getExtensionData('ActivityConfig', activity), [property], value))\n    );\n  };\n\n  handleInputChange = (event, value) => {\n    this.handlePropertyChange(event.target.name, value);\n  };\n\n  handleCheckboxChange = event => {\n    const { name, checked } = event.target;\n    this.handlePropertyChange(name, checked);\n  };\n\n  shouldComponentUpdate(nextProps) {\n    return this.props.activity !== nextProps.activity;\n  }\n\n  render() {\n    const { activity, room, expectedCompetitors, wcif } = this.props;\n    const { groups, scramblers, runners, assignJudges, capacity } = getExtensionData('ActivityConfig', activity);\n\n    const stations = getExtensionData('RoomConfig', room).stations;\n    const competitors = Math.round(expectedCompetitors.length * capacity);\n    const groupSize = Math.round(competitors / groups);\n\n    const groupsHelperText = groups\n      ? pluralize(groupSize, 'person', 'people') + ' in group'\n      : ' ';\n    const scramblersHelperText = scramblers\n      ? pluralize(Math.round(groupSize / scramblers), 'cube') + ' per scrambler'\n      : ' ';\n    const runnersHelperText = runners\n      ? pluralize(Math.round(stations / runners), 'station') + ' per runner'\n      : ' ';\n\n    const groupsCreated = activity.childActivities.length > 0;\n    const groupsAssigned = activity.childActivities.some(({ id }) => activityAssigned(wcif, id));\n\n    return (\n      <Grid container direction=\"column\">\n        <Grid item>\n          <PositiveIntegerInput\n            label=\"Groups\"\n            value={groups}\n            name=\"groups\"\n            helperText={groupsHelperText}\n            onChange={this.handleInputChange}\n            margin=\"dense\"\n            disabled={groupsCreated || groupsAssigned}\n          />\n        </Grid>\n        <Grid item>\n          <ZeroablePositiveIntegerInput\n            label=\"Scramblers\"\n            value={scramblers}\n            name=\"scramblers\"\n            helperText={scramblersHelperText}\n            onChange={this.handleInputChange}\n            margin=\"dense\"\n            disabled={groupsAssigned}\n          />\n        </Grid>\n        <Grid item>\n          <ZeroablePositiveIntegerInput\n            label=\"Runners\"\n            value={runners}\n            name=\"runners\"\n            helperText={runnersHelperText}\n            onChange={this.handleInputChange}\n            margin=\"dense\"\n            disabled={groupsAssigned}\n          />\n        </Grid>\n        <Grid item>\n          <FormControlLabel\n            control={\n              <Checkbox\n                checked={assignJudges}\n                name=\"assignJudges\"\n                onChange={this.handleCheckboxChange}\n                disabled={stations === 0 || groupsAssigned}\n              />\n            }\n            label=\"Assign judges\"\n          />\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport Grid from '@material-ui/core/Grid';\n\nimport RoundActivityConfig from '../RoundActivityConfig/RoundActivityConfig';\nimport RoomName from '../../../common/RoomName/RoomName';\nimport { flatMap } from '../../../../logic/utils';\nimport { updateActivity, rooms } from '../../../../logic/activities';\n\nexport default class RoundConfig extends PureComponent {\n  handleActivityChange = activity => {\n    const { wcif, onWcifChange } = this.props;\n    onWcifChange(updateActivity(wcif, activity));\n  };\n\n  render() {\n    const { roundId, wcif, expectedCompetitorsByRound } = this.props;\n\n    const activitiesWithRooms = flatMap(rooms(wcif), room =>\n      room.activities\n        .filter(activity => activity.activityCode === roundId)\n        .map(activity => [activity, room])\n    );\n\n    return (\n      <Grid container spacing={16}>\n        {activitiesWithRooms.map(([activity, room]) =>\n          <Grid item xs key={activity.id}>\n            <RoomName room={room} />\n            <RoundActivityConfig\n              wcif={wcif}\n              activity={activity}\n              room={room}\n              onChange={this.handleActivityChange}\n              expectedCompetitors={expectedCompetitorsByRound[roundId]}\n            />\n          </Grid>\n        )}\n      </Grid>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Grid from '@material-ui/core/Grid';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nimport RoundsNavigation from '../../../common/RoundsNavigation/RoundsNavigation';\nimport RoundConfig from '../RoundConfig/RoundConfig';\nimport { populateRoundActivitiesConfig, anyActivityConfig, hasDistributedAttempts, activitiesWithUnpopulatedConfig, activityCodeToName } from '../../../../logic/activities';\nimport { uniq } from '../../../../logic/utils';\n\nexport default class RoundsConfig extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      assignScramblers: true,\n      assignRunners: true,\n      assignJudges: true\n    };\n  }\n\n  handleCheckboxChange = event => {\n    const { name, checked } = event.target;\n    this.setState({ [name]: checked });\n  };\n\n  handleNextClick = () => {\n    const { wcif, expectedCompetitorsByRound, onWcifChange } = this.props;\n    onWcifChange(populateRoundActivitiesConfig(wcif, expectedCompetitorsByRound, this.state));\n  };\n\n  render() {\n    const { wcif } = this.props;\n    const events = wcif.events.filter(event => !hasDistributedAttempts(event.id));\n\n    const activityCodesMissingConfig = uniq(\n      activitiesWithUnpopulatedConfig(wcif).map(activity => activity.activityCode)\n    );\n\n    return activityCodesMissingConfig.length === 0 ? (\n      <RoundsNavigation events={events} render={this.renderRound} />\n    ) : (\n      <Paper style={{ padding: 16 }}>\n        <Typography variant=\"h5\">\n          {anyActivityConfig(wcif) ? (\n            `Generate missing configuration for\n            ${activityCodesMissingConfig.map(activityCodeToName).join(', ')}`\n          ) : (\n            `Generate initial configuration`\n          )}\n        </Typography>\n        <Grid container direction=\"column\">\n          <Grid item style={{ margin: '0.5em 0' }}>\n            <Typography variant=\"body1\">\n              Which of the following roles would you like to assign?\n            </Typography>\n          </Grid>\n          {['Scramblers', 'Runners', 'Judges'].map(roleLabel =>\n            <Grid item key={roleLabel}>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    checked={this.state[`assign${roleLabel}`]}\n                    name={`assign${roleLabel}`}\n                    onChange={this.handleCheckboxChange}\n                  />\n                }\n                label={roleLabel}\n              />\n            </Grid>\n          )}\n        </Grid>\n        <Button onClick={this.handleNextClick}>\n          Next\n        </Button>\n      </Paper>\n    );\n  }\n\n  renderRound = roundId => {\n    const { wcif, expectedCompetitorsByRound, onWcifChange } = this.props;\n\n    return (\n      <RoundConfig\n        roundId={roundId}\n        expectedCompetitorsByRound={expectedCompetitorsByRound}\n        wcif={wcif}\n        onWcifChange={onWcifChange}\n      />\n    );\n  };\n}\n","import React, { Component } from 'react';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Paper from '@material-ui/core/Paper';\nimport Select from '@material-ui/core/Select';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\n\nimport { getExtensionData, setExtensionData } from '../../../../logic/wcif-extensions';\nimport { setIn } from '../../../../logic/utils';\n\nconst competitorsSortingRules = [{\n  id: 'ranks',\n  name: 'Official rankings',\n  description: 'Sort competitors by their official rankings.'\n}, {\n  id: 'balanced',\n  name: 'Balanced',\n  description: 'Sort competitors in 3x3x3 (any variation), 2x2x2, Pyraminx and Skewb by their official rankings. For other events put best people in different groups, so that there are good scramblers for each group.'\n}, {\n  id: 'symmetric',\n  name: 'Symmetric',\n  description: 'Put best people in different groups, so that there are good scramblers for each group.'\n}, {\n  id: 'name-optimised',\n  name: 'Name-optimised',\n  description: 'Sort competitors by their official rankings, but also minimize the number of people with the same name in each group. Use it when many competitors have the same name.'\n}];\n\nexport default class GeneralConfig extends Component {\n  handlePropertyChange = (property, value) => {\n    const { wcif, onWcifChange } = this.props;\n    onWcifChange(\n      setExtensionData('CompetitionConfig', wcif, setIn(getExtensionData('CompetitionConfig', wcif), [property], value))\n    );\n  };\n\n  handleCheckboxChange = event => {\n    const { name, checked } = event.target;\n    this.handlePropertyChange(name, checked);\n  };\n\n  handleTextFieldChange = event => {\n    const { name, value } = event.target;\n    this.handlePropertyChange(name, value);\n  };\n\n  render() {\n    const { wcif } = this.props;\n    const {\n      competitorsSortingRule,\n      noTasksForNewcomers,\n      tasksForOwnEventsOnly,\n      localNamesFirst,\n      scorecardsBackgroundUrl\n    } = getExtensionData('CompetitionConfig', wcif);\n\n    return (\n      <Paper style={{ padding: 16 }}>\n        <Grid container direction=\"column\" spacing={16}>\n          <Grid item>\n            <Typography variant=\"h5\">Assignments</Typography>\n            <FormControl fullWidth>\n              <InputLabel htmlFor=\"competitors-sorting-rule\">Competitors sorting rule</InputLabel>\n              <Select\n                value={competitorsSortingRule}\n                onChange={this.handleTextFieldChange}\n                inputProps={{ name: 'competitorsSortingRule', id: 'competitors-sorting-rule' }}\n              >\n                {competitorsSortingRules.map(({ id, name }) => (\n                  <MenuItem value={id} key={id}>{name}</MenuItem>\n                ))}\n              </Select>\n              <FormHelperText>\n                {competitorsSortingRules.find(({ id }) => id === competitorsSortingRule).description + ' Note: this applies to first rounds only.'}\n              </FormHelperText>\n            </FormControl>\n            <Grid container direction=\"column\">\n              <Grid item>\n                <FormControlLabel\n                  control={\n                    <Checkbox\n                      name=\"noTasksForNewcomers\"\n                      checked={noTasksForNewcomers}\n                      onChange={this.handleCheckboxChange}\n                      />\n                  }\n                  label=\"Don't assign tasks to newcomers\"\n                />\n              </Grid>\n              <Grid item>\n                <FormControlLabel\n                  control={\n                    <Checkbox\n                      name=\"tasksForOwnEventsOnly\"\n                      checked={tasksForOwnEventsOnly}\n                      onChange={this.handleCheckboxChange}\n                      />\n                  }\n                  label=\"Assign tasks to competitors only in events they registered for\"\n                />\n              </Grid>\n            </Grid>\n          </Grid>\n          <Grid item>\n            <Typography variant=\"h5\">Printing</Typography>\n            <FormControlLabel\n              control={\n                <Checkbox\n                  name=\"localNamesFirst\"\n                  checked={localNamesFirst}\n                  onChange={this.handleCheckboxChange}\n                />\n              }\n              label=\"Swap latin names with local ones\"\n            />\n            <TextField\n              label=\"Scorecards background image URL\"\n              name=\"scorecardsBackgroundUrl\"\n              value={scorecardsBackgroundUrl}\n              onChange={this.handleTextFieldChange}\n              fullWidth\n            />\n          </Grid>\n        </Grid>\n      </Paper>\n    );\n  }\n}\n","const searchParams = new URLSearchParams(window.location.search);\nconst production = process.env.NODE_ENV === 'production' && !searchParams.get('staging');\n\nexport const WCA_ORIGIN = production\n  ? 'https://www.worldcubeassociation.org'\n  : 'https://staging.worldcubeassociation.org';\n\nexport const WCA_OAUTH_CLIENT_ID = production\n  ? '7af43bdb765a9b555e09cc575351d15acee640c0db098626e40e8d1ee352ec3a'\n  : 'example-application-id';\n","import { WCA_ORIGIN, WCA_OAUTH_CLIENT_ID } from './wca-env';\n\n/* Use separate set of keys for each OAuth client (e.g. for WCA production and staging). */\nconst localStorageKey = key => `GroupifierNext.${WCA_OAUTH_CLIENT_ID}.${key}`;\n\n/**\n * Checks the URL hash for presence of OAuth access token\n * and saves it in the local storage if it's found.\n * Should be called on application initialization (before any kind of router takes over the location).\n */\nexport const initializeAuth = () => {\n  const hash = window.location.hash.replace(/^\\W*/, '');\n  const hashParams = new URLSearchParams(hash);\n  if (hashParams.has('access_token')) {\n    localStorage.setItem(localStorageKey('accessToken'), hashParams.get('access_token'));\n  }\n  if (hashParams.has('expires_in')) {\n    /* Expire the token 15 minutes before it actually does,\n       this way it doesn't expire right after the user enters the page. */\n    const expiresInSeconds = hashParams.get('expires_in') - 15 * 60;\n    const expirationTime = new Date(new Date().getTime() + expiresInSeconds * 1000);\n    localStorage.setItem(localStorageKey('expirationTime'), expirationTime.toISOString());\n  }\n  /* If the token expired, sign the user out. */\n  const expirationTime = localStorage.getItem(localStorageKey('expirationTime'));\n  if (expirationTime && new Date() >= new Date(expirationTime)) {\n    signOut();\n  }\n  /* Clear the hash only if there is a token, otherwise it may be a router path. */\n  if (hashParams.has('access_token')) {\n    window.location.hash = '';\n  }\n\n  /* Check if we know what path to redirect to (after OAuth redirect). */\n  const redirectPath = localStorage.getItem(localStorageKey('redirectPath'));\n  if (redirectPath) {\n    window.location.hash = redirectPath;\n    localStorage.removeItem(localStorageKey('redirectPath'));\n  }\n  /* If non-signed in user tries accessing a competition path, redirect to OAuth sign in straightaway. */\n  const path = window.location.hash.replace(/^#/, '');\n  if (path.startsWith('/competitions') && !isSignedIn()) {\n    localStorage.setItem(localStorageKey('redirectPath'), path);\n    signIn();\n  }\n};\n\nexport const wcaAccessToken = () =>\n  localStorage.getItem(localStorageKey('accessToken'));\n\nexport const signIn = () => {\n  const params = new URLSearchParams({\n    client_id: WCA_OAUTH_CLIENT_ID,\n    response_type: 'token',\n    redirect_uri: oauthRedirectUri(),\n    scope: 'manage_competitions'\n  });\n  window.location = `${WCA_ORIGIN}/oauth/authorize?${params.toString()}`\n};\n\nconst oauthRedirectUri = () => {\n  const { origin, pathname, search } = window.location;\n  const searchParams = new URLSearchParams(search);\n  const staging = searchParams.get('staging');\n  const appUri = `${origin}${pathname}`.replace(/\\/$/, '');\n  return staging ? `${appUri}?staging=true` : appUri;\n};\n\nexport const signOut = () =>\n  localStorage.removeItem(localStorageKey('accessToken'));\n\nexport const isSignedIn = () => !!wcaAccessToken();\n","import { wcaAccessToken } from './auth';\nimport { WCA_ORIGIN } from './wca-env';\nimport { pick } from './utils';\n\nexport const getUpcomingManageableCompetitions = () => {\n  const oneWeekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n  const params = new URLSearchParams({\n    managed_by_me: true,\n    start: oneWeekAgo.toISOString()\n  });\n  return wcaApiFetch(`/competitions?${params.toString()}`);\n};\n\nexport const getWcif = competitionId =>\n  wcaApiFetch(`/competitions/${competitionId}/wcif`);\n\nconst updateWcif = (competitionId, wcif) =>\n  wcaApiFetch(`/competitions/${competitionId}/wcif`, {\n    method: 'PATCH',\n    body: JSON.stringify(wcif)\n  });\n\nexport const saveWcifChanges = (previousWcif, newWcif) => {\n  const keysDiff = Object.keys(newWcif).filter(key => previousWcif[key] !== newWcif[key]);\n  if (keysDiff.length === 0) return Promise.resolve();\n  return updateWcif(newWcif.id, pick(newWcif, keysDiff));\n};\n\nconst wcaApiFetch = (path, fetchOptions = {}) => {\n  const baseApiUrl = `${WCA_ORIGIN}/api/v0`;\n\n  return fetch(`${baseApiUrl}${path}`, Object.assign({}, fetchOptions, {\n    headers: new Headers({\n      'Authorization': `Bearer ${wcaAccessToken()}`,\n      'Content-Type': 'application/json'\n    })\n  }))\n  .then(response => {\n    if (!response.ok) throw new Error(response.statusText);\n    return response;\n  })\n  .then(response => response.json());\n};\n","import React, { Component, Fragment } from 'react';\nimport Button from '@material-ui/core/Button';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Snackbar from '@material-ui/core/Snackbar';\n\nimport { saveWcifChanges } from '../../../logic/wca-api';\n\nexport default class SaveWcifButton extends Component {\n  state = {\n    saving: false,\n    failed: false\n  };\n\n  handleSaveClick = () => {\n    const { wcif, updatedWcif, onWcifUpdate, history } = this.props;\n    this.setState({ saving: true, failed: false });\n    saveWcifChanges(wcif, updatedWcif)\n      .then(() => {\n        onWcifUpdate(updatedWcif);\n        history.push(`/competitions/${updatedWcif.id}`);\n      })\n      .catch(() => this.setState({ saving: false, failed: true }));\n  };\n\n  handleSnackbarClose = () => {\n    this.setState({ failed: false });\n  };\n\n  render() {\n    const { saving, failed } = this.state;\n    const { disabled } = this.props;\n    return (\n      <Fragment>\n        <Snackbar\n          open={failed}\n          message=\"Failed to save data to the WCA website.\"\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'left',\n          }}\n          autoHideDuration={5000}\n          onClose={this.handleSnackbarClose}\n        />\n        <Button variant=\"contained\" color=\"primary\" onClick={this.handleSaveClick} disabled={disabled || saving}>\n          <span style={saving ? { visibility: 'hidden' } : {}}>Save</span>\n          {saving && <CircularProgress size={20} style={{ position: 'absolute' }} />}\n        </Button>\n      </Fragment>\n    );\n  }\n}\n","import { parseActivityCode } from './activities';\n\nexport const eventById = (wcif, eventId) => {\n  return wcif.events.find(event => event.id === eventId);\n};\n\nexport const personById = (wcif, personId) => {\n  return wcif.persons.find(person => person.registrantId === personId);\n};\n\nexport const roundById = (wcif, roundId) => {\n  const { eventId } = parseActivityCode(roundId);\n  return eventById(wcif, eventId).rounds.find(round => round.id === roundId);\n};\n\nexport const previousRound = (wcif, roundId) => {\n  const { eventId, roundNumber } = parseActivityCode(roundId);\n  const event = eventById(wcif, eventId);\n  return event.rounds.find(\n    ({ id }) => parseActivityCode(id).roundNumber === roundNumber - 1\n  );\n};\n","import { parseActivityCode, activityCodeToName, activityById } from './activities';\nimport { personById, roundById, previousRound } from './wcif';\nimport { sortBy, sortByArray } from './utils';\n\nexport const best = (person, eventId, type) => {\n  if (!['single', 'average'].includes(type)) {\n    throw new Error(`Personal best type must be either 'single' or 'average'. Received '${type}'.`);\n  }\n  const personalBest = person.personalBests.find(pb => pb.eventId === eventId && pb.type === type);\n  return personalBest ? personalBest.best : Infinity;\n};\n\nexport const bestAverageAndSingle = (competitor, eventId) =>\n  [best(competitor, eventId, 'average'), best(competitor, eventId, 'single')];\n\nconst competitorsExpectedToAdvance = (sortedCompetitors, advancementCondition, eventId) => {\n  switch (advancementCondition.type) {\n    case 'ranking':\n      return sortedCompetitors.slice(0, advancementCondition.level);\n    case 'percent':\n      return sortedCompetitors.slice(0, Math.floor(sortedCompetitors.length * advancementCondition.level * 0.01));\n    case 'attemptResult':\n      /* Assume that competitors having personal best better than the advancement condition will make it to the next round. */\n      return sortedCompetitors.filter(person => best(person, eventId, 'single') < advancementCondition.level);\n    default:\n      throw new Error(`Unrecognised AdvancementCondition type: '${advancementCondition.type}'`);\n  }\n};\n\nexport const getExpectedCompetitorsByRound = wcif =>\n  wcif.events.reduce((expectedCompetitorsByRound, event) => {\n    const [firstRound, ...nextRounds] = event.rounds;\n    expectedCompetitorsByRound[firstRound.id] = sortByArray(\n      acceptedPeopleRegisteredForEvent(wcif, event.id),\n      competitor => bestAverageAndSingle(competitor, event.id)\n    );\n    nextRounds.reduce(([round, competitors], nextRound) => {\n      const advancementCondition = round.advancementCondition;\n      if (!advancementCondition) throw new Error(`Mising advancement condition for ${activityCodeToName(round.id)}.`);\n      const nextRoundCompetitors = competitorsExpectedToAdvance(competitors, advancementCondition, event.id);\n      expectedCompetitorsByRound[nextRound.id] = nextRoundCompetitors;\n      return [nextRound, nextRoundCompetitors];\n    }, [firstRound, expectedCompetitorsByRound[firstRound.id]]);\n    return expectedCompetitorsByRound;\n  }, {});\n\n/* Returns competitors for the given round sorted from worst to best. */\nexport const competitorsForRound = (wcif, roundId) => {\n  const { eventId, roundNumber } = parseActivityCode(roundId);\n  const round = roundById(wcif, roundId);\n  const competitorsInRound = round.results.map(({ personId }) => personById(wcif, personId));\n  if (roundNumber === 1) {\n    /* For first rounds, if there are no empty results to use, get whoever registered for the given event. */\n    const competitors =\n      competitorsInRound.length > 0\n        ? competitorsInRound\n        : acceptedPeopleRegisteredForEvent(wcif, eventId);\n    return sortByArray(competitors, competitor =>\n      bestAverageAndSingle(competitor, eventId).map(result => -result)\n    );\n  } else if (competitorsInRound.length > 0) {\n    const previous = previousRound(wcif, roundId);\n    return sortBy(competitorsInRound, person => {\n      const previousResult = previous.results.find(\n        result => result.personId === person.registrantId\n      );\n      return -previousResult.ranking;\n    });\n  } else {\n    return null;\n  }\n};\n\nexport const age = person => {\n  const diffMs = Date.now() - new Date(person.birthdate).getTime();\n  return Math.floor(diffMs / (1000 * 60 * 60 * 24 * 365.2425));\n}\n\nexport const staffAssignments = person =>\n  person.assignments.filter(({ assignmentCode }) => assignmentCode.startsWith('staff-'));\n\nexport const staffAssignmentsForEvent = (wcif, person, eventId) =>\n  staffAssignments(person).filter(({ activityId }) =>\n    parseActivityCode(activityById(wcif, activityId).activityCode).eventId === eventId\n  );\n\nexport const acceptedPeople = wcif =>\n  wcif.persons.filter(person => person.registration && person.registration.status === 'accepted');\n\nconst acceptedPeopleRegisteredForEvent = (wcif, eventId) =>\n  acceptedPeople(wcif).filter(({ registration }) => registration.eventIds.includes(eventId));\n\nexport const hasAssignment = (person, activityId, assignmentCode) =>\n  person.assignments.some(assignment =>\n    assignment.activityId === activityId && assignment.assignmentCode === assignmentCode\n  );\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport AppBar from '@material-ui/core/AppBar';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport Tab from '@material-ui/core/Tab';\nimport Tabs from '@material-ui/core/Tabs';\n\nimport RoomsConfig from './RoomsConfig/RoomsConfig';\nimport RoundsConfig from './RoundsConfig/RoundsConfig';\nimport GeneralConfig from './GeneralConfig/GeneralConfig';\nimport SaveWcifButton from '../../common/SaveWcifButton/SaveWcifButton';\nimport { getExpectedCompetitorsByRound } from '../../../logic/competitors';\nimport { roomsConfigComplete, activitiesConfigComplete, anyGroupAssignedOrCreated } from '../../../logic/activities';\nimport { removeExtensionData } from '../../../logic/wcif-extensions';\nimport { mapIn } from '../../../logic/utils';\n\nexport default class ConfigManager extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      localWcif: props.wcif,\n      tabValue: 0\n    };\n    this.expectedCompetitorsByRound = getExpectedCompetitorsByRound(props.wcif);\n  }\n\n  handleWcifChange = wcif => {\n    this.setState({ localWcif: wcif });\n  };\n\n  handleTabChange = (event, value) => {\n    this.setState({ tabValue: value });\n  };\n\n  clearConfig = () => {\n    const { localWcif } = this.state;\n    const withoutCompetitionConfig = removeExtensionData('CompetitionConfig', localWcif);\n    this.setState({\n      tabValue: 0,\n      localWcif: mapIn(withoutCompetitionConfig, ['schedule', 'venues'], venue =>\n        mapIn(venue, ['rooms'], room =>\n          removeExtensionData(\n            'RoomConfig',\n            mapIn(room, ['activities'], activity => removeExtensionData('ActivityConfig', activity))\n          )\n        )\n      )\n    });\n  };\n\n  render() {\n    const { tabValue, localWcif } = this.state;\n    const { wcif, onWcifUpdate, history } = this.props;\n\n    const wcifConfigComplete = roomsConfigComplete(localWcif) && activitiesConfigComplete(localWcif);\n\n    return (\n      <Grid container spacing={8} justify=\"flex-end\">\n        <Grid item xs={12}>\n          <AppBar position=\"static\" color=\"default\">\n            <Tabs value={tabValue} onChange={this.handleTabChange} centered>\n              <Tab label=\"Rooms\" />\n              <Tab label=\"Rounds\" disabled={!roomsConfigComplete(localWcif)} />\n              <Tab label=\"General\" />\n            </Tabs>\n          </AppBar>\n        </Grid>\n        <Grid item xs={12}>\n          {tabValue === 0 && (\n            <RoomsConfig wcif={localWcif} onWcifChange={this.handleWcifChange} />\n          )}\n          {tabValue === 1 && (\n            <RoundsConfig wcif={localWcif} onWcifChange={this.handleWcifChange} expectedCompetitorsByRound={this.expectedCompetitorsByRound} />\n          )}\n          {tabValue === 2 && (\n            <GeneralConfig wcif={localWcif} onWcifChange={this.handleWcifChange} />\n          )}\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" component={Link} to={`/competitions/${localWcif.id}`}>\n            Cancel\n          </Button>\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" onClick={this.clearConfig} disabled={anyGroupAssignedOrCreated(localWcif)}>\n            Clear\n          </Button>\n        </Grid>\n        <Grid item>\n          <SaveWcifButton wcif={wcif} updatedWcif={localWcif} onWcifUpdate={onWcifUpdate} history={history} disabled={!wcifConfigComplete} />\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\n\nimport { activityCodeToName } from '../../../../logic/activities';\nimport { hasAssignment } from '../../../../logic/competitors';\nimport { sortBy } from '../../../../logic/utils';\n\nexport default class GroupDialog extends Component {\n  render() {\n    const { wcif, groupActivity, onClose, open } = this.props;\n\n    const roles = [\n      { id: 'competitor', label: 'Competitors' },\n      { id: 'staff-scrambler', label: 'Scramblers' },\n      { id: 'staff-runner', label: 'Runners' },\n      { id: 'staff-judge', label: 'Judges' },\n    ];\n\n    const rolesWithPeople = roles.map(role => [\n      role,\n      wcif.persons.filter(person =>\n        hasAssignment(person, groupActivity.id, role.id)\n      )\n    ])\n    .filter(([role, people]) => people.length > 0);\n\n    return (\n      <Dialog open={open} onClose={onClose} maxWidth={false}>\n        <DialogTitle>{activityCodeToName(groupActivity.activityCode)}</DialogTitle>\n        <DialogContent>\n          <Grid container spacing={16}>\n            {rolesWithPeople.map(([role, people]) => (\n              <Grid item xs={12} sm={6} md key={role.id}>\n                <Typography variant=\"subtitle2\">{role.label}</Typography>\n                <List dense={true} style={{ overflowY: 'auto', maxHeight: 300 }}>\n                  {sortBy(people, person => person.name).map(person => (\n                    <ListItem key={person.wcaUserId}>\n                      <ListItemText primary={person.name} />\n                    </ListItem>\n                  ))}\n                </List>\n              </Grid>\n            ))}\n            {rolesWithPeople.length === 0 && (\n              <Grid item>\n                <Typography variant=\"body2\">No assignments for this round.</Typography>\n              </Grid>\n            )}\n          </Grid>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onClose} color=\"secondary\">\n            Ok\n          </Button>\n        </DialogActions>\n      </Dialog>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\n\nimport RoundsNavigation from '../../../common/RoundsNavigation/RoundsNavigation';\nimport RoomName from '../../../common/RoomName/RoomName';\nimport GroupDialog from '../GroupDialog/GroupDialog';\nimport { activityDurationString, parseActivityCode, hasDistributedAttempts, roomsWithTimezoneAndGroups } from '../../../../logic/activities';\n\nexport default class RoundWithGroups extends Component {\n  state = {\n    openedGroupActivity: null\n  };\n\n  handleGroupClick = groupActivity => {\n    this.setState({ openedGroupActivity: groupActivity });\n  };\n\n  handleDialogClose = () => {\n    this.setState({ openedGroupActivity: null });\n  };\n\n  render() {\n    const { openedGroupActivity } = this.state;\n    const { wcif } = this.props;\n    const events = wcif.events.filter(event => !hasDistributedAttempts(event.id));\n\n    return (\n      <React.Fragment>\n        <RoundsNavigation events={events} render={this.renderRound} />\n        {openedGroupActivity && (\n          <GroupDialog\n            open={true}\n            groupActivity={openedGroupActivity}\n            wcif={wcif}\n            onClose={this.handleDialogClose}\n          />\n        )}\n      </React.Fragment>\n    );\n  }\n\n  renderRound = roundId => {\n    const { wcif } = this.props;\n\n    return (\n      <Grid container>\n        {roomsWithTimezoneAndGroups(wcif, roundId).map(([room, timezone, groupActivities]) => (\n          groupActivities.length > 0 && (\n            <Grid item xs={12} sm key={room.id}>\n              <RoomName room={room} />\n              <List>\n                {groupActivities.map(groupActivity => (\n                  <ListItem key={groupActivity.id} button onClick={() => this.handleGroupClick(groupActivity)}>\n                    <ListItemText\n                      primary={`Group ${parseActivityCode(groupActivity.activityCode).groupNumber}`}\n                      secondary={activityDurationString(groupActivity, timezone)}\n                    />\n                  </ListItem>\n                ))}\n              </List>\n            </Grid>\n          )\n        ))}\n      </Grid>\n    );\n  };\n}\n","import { addMilliseconds, chunk, difference, findLast, flatMap, groupBy, intersection, isoTimeDiff, partition,\n         scaleToOne, setIn, sortBy, sortByArray, sum, uniq, updateIn, mapIn, times, zip } from './utils';\nimport { getExtensionData } from './wcif-extensions';\nimport { activitiesIntersection, activitiesOverlap, activityById, activityCodeToName,\n         activityDuration, hasDistributedAttempts, maxActivityId, parseActivityCode,\n         roundActivities, groupActivitiesByRound, roundsMissingAssignments, stationsByActivity, updateActivity } from './activities';\nimport { acceptedPeople, age, bestAverageAndSingle, competitorsForRound, hasAssignment, staffAssignments, staffAssignmentsForEvent } from './competitors';\n\nexport const createGroupActivities = wcif => {\n  const rounds = flatMap(wcif.events, event => event.rounds);\n  return rounds.reduce((wcif, round) => {\n    /* For FMC and MBLD the activities are already scheduled, and there is always a single group. */\n    if (hasDistributedAttempts(round.id)) return wcif;\n    /* If there are already groups created, don't override them. */\n    if (groupActivitiesByRound(wcif, round.id).length > 0) return wcif;\n    const currentActivityId = maxActivityId(wcif);\n    const activitiesWithGroups = roundActivities(wcif, round.id).map(activity => {\n      const { groups } = getExtensionData('ActivityConfig', activity);\n      const totalDuration = activityDuration(activity);\n      const groupDuration = totalDuration / groups;\n      const groupActivities = times(groups, index => ({\n        id: null,\n        name: null,\n        activityCode: null,\n        startTime: addMilliseconds(activity.startTime, groupDuration * index),\n        endTime: addMilliseconds(activity.startTime, groupDuration * index + groupDuration),\n        childActivities: [],\n        scrambleSetId: null\n      }));\n      return { ...activity, childActivities: groupActivities };\n    });\n    sortByArray(\n      flatMap(activitiesWithGroups, activity => activity.childActivities),\n      ({ startTime, endTime }) => [startTime, endTime]\n    ).forEach((groupActivity, index) => {\n      const activityCode = `${round.id}-g${index + 1}`;\n      /* The child activities are newly created objects, so it's fine to mutate them at this point. */\n      return Object.assign(groupActivity, {\n        id: currentActivityId + index + 1,\n        name: activityCodeToName(activityCode),\n        activityCode\n      })\n    });\n    return activitiesWithGroups.reduce(updateActivity, wcif);\n  }, wcif);\n};\n\nexport const assignTasks = wcif => {\n  const roundsToAssign = roundsMissingAssignments(wcif);\n  return [assignGroups, assignScrambling, assignRunning, assignJudging]\n    .reduce((wcif, assignmentFn) => assignmentFn(wcif, roundsToAssign), wcif);\n};\n\nconst assignGroups = (wcif, roundsToAssign) => {\n  /* Sort rounds by the number of groups, so the further the more possible timeframes there are. */\n  const sortedRoundsToAssign = sortBy(roundsToAssign, round =>\n    hasDistributedAttempts(round.id) ? -Infinity : groupActivitiesByRound(wcif, round.id).length\n  );\n  return sortedRoundsToAssign.reduce((wcif, round) => {\n    const competitors = sortedCompetitorsForRound(wcif, round.id);\n    if (hasDistributedAttempts(round.id)) {\n      /* In this case roundActivities are attempt activities.\n         We want every competitor to be assigned all attempts.\n         The same attempt may take place in many different rooms,\n         so for each attempt we split people among this attempt's activities. */\n      const activitiesByAttempt = groupBy(\n        roundActivities(wcif, round.id),\n        ({ activityCode }) => parseActivityCode(activityCode).attemptNumber\n      );\n      const updatedCompetitors = Object.values(activitiesByAttempt)\n        .reduce((competitors, attemptActivities) => {\n          const competitorsPerActivity = Math.ceil(competitors.length / attemptActivities.length);\n          const activitiesWithCompetitors = zip(attemptActivities, chunk(competitors, competitorsPerActivity));\n          return flatMap(\n            activitiesWithCompetitors,\n            ([activity, competitors]) => assignActivity(activity.id, 'competitor', competitors)\n          );\n        }, competitors)\n      return updatePeople(wcif, updatedCompetitors);\n    }\n    const initialGroups = sortedGroupActivitiesWithSize(wcif, round.id, competitors.length)\n      .map(([activity, size]) => ({\n        id: activity.id,\n        activity,\n        size,\n        competitors: []\n      }));\n    const groups = competitors.reduce((groups, competitor) => {\n      const availabilityRates = groups.map(group => availabilityRate(wcif, group.activity, competitor));\n      const maxAvailabilityRate = Math.max(...availabilityRates);\n      const mostAvailableGroups = groups.filter((group, index) => availabilityRates[index] === maxAvailabilityRate);\n      const preferredGroups = mostAvailableGroups.filter(group => !overlapsEveryoneWithSameRole(wcif, groups, group.activity, competitor));\n      const potentialGroups = preferredGroups.length > 0 ? preferredGroups : mostAvailableGroups;\n      const notFullGroup = potentialGroups.find(({ size, competitors }) => competitors.length < size);\n      if (notFullGroup) {\n        return addCompetitorToGroupEnd(groups, notFullGroup.id, competitor);\n      } else {\n        const group = potentialGroups[potentialGroups.length - 1];\n        const updatedGroups = addCompetitorToGroupEnd(groups, group.id, competitor);\n        return moveSomeoneRight(wcif, updatedGroups, group.id) || moveSomeoneLeft(wcif, updatedGroups, group.id) || updatedGroups;\n      }\n    }, initialGroups);\n    const updatedCompetitors = flatMap(groups, ({ activity, competitors }) =>\n      assignActivity(activity.id, 'competitor', competitors)\n    );\n    return updatePeople(wcif, updatedCompetitors);\n  }, wcif);\n};\n\nexport const sortedGroupActivitiesWithSize = (wcif, roundId, competitorCount) => {\n  const groupActivitiesWithCapacity = flatMap(roundActivities(wcif, roundId), activity => {\n    const { capacity } = getExtensionData('ActivityConfig', activity);\n    return activity.childActivities.map(groupActivity =>\n      [groupActivity, capacity / activity.childActivities.length]\n    );\n  });\n  const [groupActivities, capacities] = zip(...groupActivitiesWithCapacity);\n  const groupSizes = calculateGroupSizes(capacities, competitorCount);\n  return sortBy(\n    zip(groupActivities, groupSizes),\n    ([{ activityCode }]) => parseActivityCode(activityCode).groupNumber\n  );\n};\n\nconst calculateGroupSizes = ([capacity, ...capacities], competitorCount) => {\n  if (!capacity) return [];\n  const groupSize = Math.round(capacity * competitorCount);\n  return [groupSize, ...calculateGroupSizes(scaleToOne(capacities), competitorCount - groupSize)];\n};\n\nconst sortedCompetitorsForRound = (wcif, roundId) => {\n  const { competitorsSortingRule } = getExtensionData('CompetitionConfig', wcif);\n  const sortedByRanks = competitorsForRound(wcif, roundId);\n  const { eventId, roundNumber } = parseActivityCode(roundId);\n  if (roundNumber > 1) return sortedByRanks;\n  if (competitorsSortingRule === 'ranks') return sortedByRanks;\n  if (competitorsSortingRule === 'balanced' && ['333', '222', '333bf', '333oh', '333ft', 'pyram', 'skewb'].includes(eventId)) return sortedByRanks;\n  if (['balanced', 'symmetric'].includes(competitorsSortingRule)) {\n    const groupCount = groupActivitiesByRound(wcif, roundId).length;\n    return sortBy(sortedByRanks, competitor =>\n      groupCount - ((sortedByRanks.length - sortedByRanks.indexOf(competitor) - 1) % groupCount)\n    );\n  }\n  if (competitorsSortingRule === 'name-optimised') {\n    const competitorsByName = groupBy(sortedByRanks, ({ name }) => name.split(' ')[0]);\n    /* We take sets of competitors with the same name and sort them by quantity.\n       Starting with the smallest sets we keep adding competitors to a single set of `competitors`.\n       For each set of competitors of length N (having the same name), we split `competitors` into N chunks\n       and add one competitor to each of those chunks. Then we join the chunks back forming the new `competitors` set.\n       This way we maximise the gap between people with the same name. */\n    return sortBy(Object.values(competitorsByName), competitors => competitors.length)\n      .reduce((competitors, competitorsWithSameName) => {\n        const chunkSize = Math.ceil(competitors.length / competitorsWithSameName.length);\n        return flatMap(\n          zip(chunk(competitors, chunkSize), competitorsWithSameName),\n          ([competitors, competitor]) => [...competitors, competitor]\n        );\n      });\n  }\n  throw new Error(`Unrecognised competitors sorting rule: '${competitorsSortingRule}'`);\n};\n\nconst moveSomeoneRight = (wcif, groups, groupId) => {\n  const group = groups.find(({ id }) => id === groupId);\n  return groups.slice(groups.indexOf(group) + 1).reduce((updatedGroups, furtherGroup) => {\n    if (updatedGroups) return updatedGroups;\n    const competitorToMove = findLast(group.competitors, competitor =>\n      availabilityRate(wcif, group.activity, competitor) === availabilityRate(wcif, furtherGroup.activity, competitor)\n      && !overlapsEveryoneWithSameRole(wcif, groups, furtherGroup.activity, competitor)\n    );\n    if (!competitorToMove) return null; // Try the next group.\n    if (furtherGroup.competitors.length < furtherGroup.size) {\n      return moveCompetitorToGroupStart(groups, groupId, furtherGroup.id, competitorToMove);\n    } else if (furtherGroup.competitors.length === furtherGroup.size) {\n      const groupsWithSpot = moveSomeoneRight(wcif, groups, furtherGroup.id);\n      return groupsWithSpot && moveCompetitorToGroupStart(groupsWithSpot, groupId, furtherGroup.id, competitorToMove);\n    }\n    return null;\n  }, null);\n};\n\nconst moveSomeoneLeft = (wcif, groups, groupId) => {\n  const group = groups.find(({ id }) => id === groupId);\n  return groups.slice(0, groups.indexOf(group)).reduceRight((updatedGroups, previousGroup) => {\n    if (updatedGroups) return updatedGroups;\n    const competitorToMove = group.competitors.find(competitor =>\n      availabilityRate(wcif, group.activity, competitor) === availabilityRate(wcif, previousGroup.activity, competitor)\n      && !overlapsEveryoneWithSameRole(wcif, groups, previousGroup.activity, competitor)\n    );\n    if (!competitorToMove) return null; // Try the previous group.\n    const groupsWithSpot = moveSomeoneRight(wcif, groups, previousGroup.id);\n    return groupsWithSpot && moveCompetitorToGroupEnd(groupsWithSpot, groupId, previousGroup.id, competitorToMove);\n  }, null);\n};\n\nconst updateCompetitorsInGroup = (groups, groupId, updater) =>\n  groups.map(group => group.id === groupId ? updateIn(group, ['competitors'], updater) : group);\n\nconst addCompetitorToGroupStart = (groups, groupId, competitor) =>\n  updateCompetitorsInGroup(groups, groupId, competitors => [competitor, ...competitors]);\n\nconst addCompetitorToGroupEnd = (groups, groupId, competitor) =>\n  updateCompetitorsInGroup(groups, groupId, competitors => [...competitors, competitor]);\n\nconst removeCompetitorFromGroup = (groups, groupId, competitor) =>\n  updateCompetitorsInGroup(groups, groupId, competitors => competitors.filter(other => other !== competitor));\n\nconst moveCompetitorToGroupStart = (groups, fromGroupId, toGroupId, competitor) =>\n  addCompetitorToGroupStart(removeCompetitorFromGroup(groups, fromGroupId, competitor), toGroupId, competitor);\n\nconst moveCompetitorToGroupEnd = (groups, fromGroupId, toGroupId, competitor) =>\n  addCompetitorToGroupEnd(removeCompetitorFromGroup(groups, fromGroupId, competitor), toGroupId, competitor);\n\nconst assignScrambling = (wcif, roundsToAssign) => {\n  const { noTasksForNewcomers } = getExtensionData('CompetitionConfig', wcif);\n  /* Sort rounds by the number of competitors, so the further the more people able to scramble there are. */\n  const sortedRoundsToAssign = sortBy(roundsToAssign, round => competitorsForRound(wcif, round.id).length);\n  return sortedRoundsToAssign.reduce((wcif, round) => {\n    if (hasDistributedAttempts(round.id)) return wcif;\n    const { eventId } = parseActivityCode(round.id);\n    return roundActivities(wcif, round.id).reduce((wcif, activity) => {\n      const { scramblers } = getExtensionData('ActivityConfig', activity);\n      if (scramblers === 0) return wcif;\n      return activity.childActivities.reduce((wcif, groupActivity) => {\n        const staffScramblers = acceptedPeople(wcif).filter(person => person.roles.includes('staff-scrambler'));\n        const competitors = difference(competitorsForRound(wcif, round.id), staffScramblers);\n        const available = people => people.filter(person => availableDuring(wcif, groupActivity, person));\n        const sortedAvailableStaff = sortByArray(available(staffScramblers), competitor => [\n          /* Avoid difference in the number of tasks bigger than 3.\n             (General note: this is better than sorting by the number of tasks,\n             as it allows one person to be assigned a couple times in a row). */\n          Math.floor(staffAssignments(competitor).length / 3),\n          /* Prefer competitors better in the given event. */\n          ...bestAverageAndSingle(competitor, eventId)\n        ]);\n        const sortedAvailableCompetitors = sortedAvailableStaff.length >= scramblers ? [] : sortByArray(available(competitors), competitor => [\n          /* Optionally avoid assigning tasks to newcomers. */\n          noTasksForNewcomers && !competitor.wcaId ? 1 : -1,\n          /* Strongly prefer people at least 10 years old. */\n          age(competitor) >= 10 ? -1 : 1,\n          /* Avoid assigning tasks to people already busy due to their role. */\n          intersection(['staff-dataentry', 'delegate', 'organizer'], competitor.roles).length,\n          /* Avoid more than two assignments for the given event. */\n          staffAssignmentsForEvent(wcif, competitor, eventId).length >= 2 ? 1 : -1,\n          /* Prefer competitors that are likely to be on the venue. */\n          -presenceRate(wcif, competitor, groupActivity.startTime),\n          /* Avoid difference in the number of tasks bigger than 6. */\n          Math.floor(staffAssignments(competitor).length / 6),\n          /* Prefer competitors who doesn't solve soon after the group ends. */\n          competesIn15Minutes(wcif, competitor, groupActivity.endTime) ? 1 : -1,\n          /* Prefer competitors better in the given event. */\n          ...bestAverageAndSingle(competitor, eventId)\n        ]);\n        const potentialScramblers = [...sortedAvailableStaff, ...sortedAvailableCompetitors];\n        const updatedCompetitors = assignActivity(groupActivity.id, 'staff-scrambler', potentialScramblers.slice(0, scramblers));\n        return updatePeople(wcif, updatedCompetitors);\n      }, wcif);\n    }, wcif);\n  }, wcif);\n};\n\nconst assignRunning = (wcif, roundsToAssign) => {\n  const { noTasksForNewcomers, tasksForOwnEventsOnly } = getExtensionData('CompetitionConfig', wcif);\n  return roundsToAssign.reduce((wcif, round) => {\n    if (hasDistributedAttempts(round.id)) return wcif;\n    const { eventId } = parseActivityCode(round.id);\n    return roundActivities(wcif, round.id).reduce((wcif, activity) => {\n      const { runners } = getExtensionData('ActivityConfig', activity);\n      if (runners === 0) return wcif;\n      return activity.childActivities.reduce((wcif, groupActivity) => {\n        const [staffRunners, people] = partition(acceptedPeople(wcif), person => person.roles.includes('staff-runner'));\n        const available = people => people.filter(person => availableDuring(wcif, groupActivity, person));\n        const sortedAvailableStaff = sortByArray(available(staffRunners), competitor => [\n          Math.floor(staffAssignments(competitor).length / 3),\n          competesIn15Minutes(wcif, competitor, groupActivity.endTime) ? 1 : -1\n        ]);\n        const sortedAvailablePeople = sortedAvailableStaff.length >= runners ? [] : sortByArray(available(people), competitor => [\n          noTasksForNewcomers && !competitor.wcaId ? 1 : -1,\n          tasksForOwnEventsOnly && !competitor.registration.eventIds.includes(eventId) ? 1 : -1,\n          age(competitor) >= 10 ? -1 : 1,\n          intersection(['staff-dataentry', 'delegate', 'organizer'], competitor.roles).length,\n          staffAssignmentsForEvent(wcif, competitor, eventId).length >= 2 ? 1 : -1,\n          -presenceRate(wcif, competitor, groupActivity.startTime),\n          Math.floor(staffAssignments(competitor).length / 6),\n          competesIn15Minutes(wcif, competitor, groupActivity.endTime) ? 1 : -1\n        ]);\n        const potentialRunners = [...sortedAvailableStaff, ...sortedAvailablePeople];\n        const updatedPeople = assignActivity(groupActivity.id, 'staff-runner', potentialRunners.slice(0, runners));\n        return updatePeople(wcif, updatedPeople);\n      }, wcif);\n    }, wcif);\n  }, wcif);\n};\n\nconst assignJudging = (wcif, roundsToAssign) => {\n  const { noTasksForNewcomers, tasksForOwnEventsOnly } = getExtensionData('CompetitionConfig', wcif);\n  return roundsToAssign.reduce((wcif, round) => {\n    if (hasDistributedAttempts(round.id)) return wcif;\n    const { eventId } = parseActivityCode(round.id);\n    return roundActivities(wcif, round.id).reduce((wcif, activity) => {\n      const { assignJudges } = getExtensionData('ActivityConfig', activity);\n      const stations = stationsByActivity(wcif, activity.id);\n      if (!assignJudges) return wcif;\n      return activity.childActivities.reduce((wcif, groupActivity) => {\n        const competitors = wcif.persons.filter(competitor =>\n          hasAssignment(competitor, groupActivity.id, 'competitor')\n        ).length;\n        const judges = Math.min(stations, competitors);\n        const [staffJudges, people] = partition(acceptedPeople(wcif), person => person.roles.includes('staff-judge'));\n        const available = people => people.filter(person => availableDuring(wcif, groupActivity, person));\n        const sortedAvailableStaff = sortByArray(available(staffJudges), competitor => [\n          /* Equally distribute tasks (judging is assigned last, so we want to eliminate inequality introduced by other assignments). */\n          staffAssignments(competitor).length,\n          competesIn15Minutes(wcif, competitor, groupActivity.endTime) ? 1 : -1\n        ]);\n        const sortedAvailablePeople = sortedAvailableStaff.length >= judges ? [] : sortByArray(available(people), competitor => [\n          noTasksForNewcomers && !competitor.wcaId ? 1 : -1,\n          tasksForOwnEventsOnly && !competitor.registration.eventIds.includes(eventId) ? 1 : -1,\n          age(competitor) >= 10 ? -1 : 1,\n          intersection(['staff-dataentry', 'delegate', 'organizer'], competitor.roles).length,\n          staffAssignmentsForEvent(wcif, competitor, eventId).length >= 2 ? 1 : -1,\n          -presenceRate(wcif, competitor, groupActivity.startTime),\n          /* Equally distribute tasks (judging is assigned last, so we want to eliminate inequality introduced by other assignments). */\n          staffAssignments(competitor).length,\n          competesIn15Minutes(wcif, competitor, groupActivity.endTime) ? 1 : -1,\n          /* Prefer people that solve fewer events, to avoid overloading people solving more. */\n          competitor.registration ? competitor.registration.eventIds.length : 0,\n        ]);\n        const potentialJudges = [...sortedAvailableStaff, ...sortedAvailablePeople];\n        const updatedPeople = assignActivity(groupActivity.id, 'staff-judge', potentialJudges.slice(0, judges));\n        return updatePeople(wcif, updatedPeople);\n      }, wcif);\n    }, wcif);\n  }, wcif);\n};\n\nconst competesIn15Minutes = (wcif, competitor, isoString) => {\n  const competingStartTimes = competitor.assignments\n    .filter(({ assignmentCode }) => assignmentCode === 'competitor')\n    .map(({ activityId }) => activityById(wcif, activityId).startTime)\n    .filter(startTime => startTime >= isoString);\n  if (competingStartTimes.length === 0) return false;\n  const competingStart = competingStartTimes.reduce((x, y) => x < y ? x : y);\n  return isoTimeDiff(competingStart, isoString) <= 15 * 60 * 1000;\n};\n\n/* The lower, the less likely the competitor is to be at the venue. */\nconst presenceRate = (wcif, competitor, time) => {\n  const activitiesThisDay = competitor.assignments\n    .map(({ activityId }) => activityById(wcif, activityId))\n    .filter(({ startTime }) => new Date(startTime).getDay() === new Date(time).getDay());\n  if (activitiesThisDay.length === 0) return 0;\n  const [startTimes, endTimes] = zip(\n    ...activitiesThisDay.map(({ startTime, endTime }) => [startTime, endTime])\n  ).map(times => times.sort());\n  /* If first activity is in the future, the sonner it is, the more likely the person is to be at the venue. */\n  if (startTimes[0] > time) return 1 + (1 / isoTimeDiff(time, startTimes[0]));\n  const previousEndTime = findLast(endTimes, endTime => endTime <= time);\n  const nextStartTime = startTimes.find(startTime => startTime >= time);\n  if (previousEndTime) {\n    if (nextStartTime) {\n      /* > 1 hour after last activity and > 1 hour before next one */\n      if (isoTimeDiff(time, previousEndTime) > 60 * 60 * 1000 && isoTimeDiff(time, nextStartTime) > 60 * 60 * 1000) return 3;\n    } else {\n      /* > 30 min after last activity */\n      if (isoTimeDiff(time, previousEndTime) > 30 * 60 * 1000) return 2;\n    }\n  }\n  return 4;\n};\n\nconst assignActivity = (activityId, assignmentCode, competitors) =>\n  competitors.map(competitor => ({\n    ...competitor,\n    assignments: [...competitor.assignments, { activityId, assignmentCode }]\n  }));\n\nconst updatePeople = (wcif, updatedPeople) =>\n  mapIn(wcif, ['persons'], person =>\n    updatedPeople.find(updatedPerson => updatedPerson.wcaUserId === person.wcaUserId) || person\n  );\n\nconst availableDuring = (wcif, activity, competitor) =>\n  !competitor.assignments.some(({ activityId }) =>\n    activitiesOverlap(activityById(wcif, activityId), activity)\n  );\n\nconst availabilityRate = (wcif, activity, competitor) => {\n  const intersections = competitor.assignments.map(({ activityId }) =>\n    activitiesIntersection(activityById(wcif, activityId), activity)\n  );\n  const timeWhenBusy = sum(intersections);\n  return -(timeWhenBusy / activityDuration(activity));\n};\n\nconst overlapsEveryoneWithSameRole = (wcif, groups, activity, competitor) =>\n  intersection(['staff-dataentry', 'delegate', 'organizer'], competitor.roles)\n    .some(role => {\n      const others = acceptedPeople(wcif)\n        .filter(person => person.wcaUserId !== competitor.wcaUserId)\n        .filter(person => person.roles.includes(role));\n      return others.length > 0 && others.every(other =>\n        !availableDuring(wcif, activity, other)\n        || groups.some(({ activity: groupActivity, competitors }) =>\n          competitors.includes(other) && activitiesOverlap(groupActivity, activity)\n        )\n      );\n    });\n\nexport const updateScrambleSetCount = wcif =>\n  mapIn(wcif, ['events'], event =>\n    mapIn(event, ['rounds'], round =>\n      setIn(round, ['scrambleSetCount'], scrambleSetCountForRound(wcif, round.id))\n    )\n  );\n\n/* Assume one scramble set for each unique timeframe, i.e. (startTime, endTime) pair. */\nconst scrambleSetCountForRound = (wcif, roundId) =>\n  hasDistributedAttempts(roundId) ? 1 : uniq(\n    groupActivitiesByRound(wcif, roundId).map(({ startTime, endTime }) => startTime + endTime)\n  ).length;\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport pink from '@material-ui/core/colors/pink';\n\nimport GroupsNavigation from './GroupsNavigation/GroupsNavigation';\nimport SaveWcifButton from '../../common/SaveWcifButton/SaveWcifButton';\n\nimport { createGroupActivities, updateScrambleSetCount, assignTasks } from '../../../logic/groups';\nimport { allGroupsCreated, roundsMissingAssignments, clearGroupsAndAssignments } from '../../../logic/activities';\n\nexport default class GroupsManager extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      localWcif: props.wcif\n    };\n  }\n\n  createGroupActivities = () => {\n    const { localWcif } = this.state;\n    this.setState({\n      localWcif: updateScrambleSetCount(createGroupActivities(localWcif))\n    });\n  };\n\n  assignTasks = () => {\n    const { localWcif } = this.state;\n    this.setState({ localWcif: assignTasks(localWcif) });\n  };\n\n  clearGroups = () => {\n    const { localWcif } = this.state;\n    this.setState({ localWcif: clearGroupsAndAssignments(localWcif) });\n  };\n\n  render() {\n    const { localWcif } = this.state;\n    const { wcif, onWcifUpdate, history } = this.props;\n\n    const groupsCreated = allGroupsCreated(localWcif);\n\n    return (\n      <Grid container spacing={8} justify=\"flex-end\">\n        <Grid item xs={12}>\n          {!groupsCreated && (\n            <SnackbarContent\n              style={{ maxWidth: 'none' }}\n              message=\"To assign tasks you need to create groups first. This will also determine scramble set count for each round.\"\n              action={\n                <Button onClick={this.createGroupActivities} style={{ color: pink[500] }} size=\"small\">\n                  Create groups\n                </Button>\n              }\n            />\n          )}\n          {(groupsCreated && roundsMissingAssignments(localWcif).length > 0) && (\n            <SnackbarContent\n              style={{ maxWidth: 'none' }}\n              message=\"There are rounds with no tasks assigned.\"\n              action={\n                <Button onClick={this.assignTasks} style={{ color: pink[500] }} size=\"small\">\n                  Assign tasks\n                </Button>\n              }\n            />\n          )}\n        </Grid>\n        <Grid item xs={12}>\n          <GroupsNavigation wcif={localWcif} />\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" component={Link} to={`/competitions/${localWcif.id}`}>\n            Cancel\n          </Button>\n        </Grid>\n        <Grid item>\n          <Tooltip title=\"This clears groups and assignments only for rounds without results.\" placement=\"bottom\">\n            <Button variant=\"contained\" onClick={this.clearGroups}>\n              Clear\n            </Button>\n          </Tooltip>\n        </Grid>\n        <Grid item>\n          <SaveWcifButton wcif={wcif} updatedWcif={localWcif} onWcifUpdate={onWcifUpdate} history={history} />\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import pdfMake from 'pdfmake/build/pdfmake';\n\n/* Asynchronously download fonts bundle for PDF Make. */\nfetch('vfs-fonts.bundle.v2.json')\n  .then(response => response.json())\n  .then(vfsFonts => pdfMake.vfs = vfsFonts);\n\nconst singleFileFont = file => ({\n  normal: file, bold: file, italic: file, bolditalics: file\n})\n\npdfMake.fonts = {\n  Roboto: {\n    normal: 'Roboto-Regular.ttf',\n    bold: 'Roboto-Medium.ttf',\n    italics: 'Roboto-Italic.ttf',\n    bolditalics: 'Roboto-MediumItalic.ttf'\n  },\n  WenQuanYiZenHei: singleFileFont('WenQuanYiZenHei.ttf'),\n  /* Note: https://github.com/googlefonts/noto-fonts/blob/master/FAQ.md#whats-the-difference-between-the-ui-and-non-ui-versions */\n  NotoSansThai: singleFileFont('NotoSansThaiUI-Regular.ttf'),\n  NotoSansArabic: singleFileFont('NotoSansArabicUI-Regular.ttf'),\n  NotoSansGeorgian: singleFileFont('NotoSansGeorgian-Regular.ttf'),\n  NotoSansArmenian: singleFileFont('NotoSansArmenian-Regular.ttf')\n};\n\nexport default pdfMake;\n","import { parseActivityCode } from './activities';\nimport { shortEventNameById } from './events';\n\nexport const cutoffToString = (cutoff, eventId) => {\n  if (eventId === '333mbf') {\n    return `${multibldAttemptResultToPoints(cutoff.attemptResult)} points`;\n  } else if (eventId === '333fm') {\n    return `${cutoff.attemptResult} moves`;\n  } else {\n    return centisecondsToClockFormat(cutoff.attemptResult);\n  }\n}\n\nexport const timeLimitToString = timeLimit => {\n  const { centiseconds, cumulativeRoundIds } = timeLimit;\n  const clockFormat = centisecondsToClockFormat(centiseconds);\n  if (cumulativeRoundIds.length === 0) {\n    return clockFormat;\n  } else if (cumulativeRoundIds.length === 1) {\n    return `${clockFormat} in total`;\n  } else {\n    const roundStrings = cumulativeRoundIds.map(roundId => {\n      const { eventId, roundNumber } = parseActivityCode(roundId);\n      return `${shortEventNameById(eventId)} R${roundNumber}`;\n    });\n    return `${clockFormat} total for ${roundStrings.join(', ')}`;\n  }\n}\n\nconst multibldAttemptResultToPoints = attemptResult =>\n  99 - (Math.floor(attemptResult / 10000000) % 100);\n\nconst centisecondsToClockFormat = centiseconds => {\n  const date = new Date(null);\n  date.setUTCMilliseconds(centiseconds * 10);\n  return date.toISOString().substr(11, 11).replace(/^[0:]*(?!\\.)/g, '');\n};\n","import { inRange } from '../utils';\n\nconst determineFont = text => {\n  const code = text.charCodeAt(0);\n  /* Based on https://en.wikipedia.org/wiki/Unicode_block */\n  if (inRange(code, 0x0000, 0x052F)) {\n    return 'Roboto';\n  } else if (inRange(code, 0x0600, 0x06FF) || inRange(code, 0x0750, 0x077F)) {\n    return 'NotoSansArabic';\n  } else if (inRange(code, 0x0E00, 0x0E7F)) {\n    return 'NotoSansThai';\n  } else if (inRange(code, 0x0530, 0x058F)) {\n    return 'NotoSansArmenian';\n  } else if (inRange(code, 0x10A0, 0x10FF)) {\n    return 'NotoSansGeorgian';\n  } else {\n    /* Default to WenQuanYiZenHei as it supports the most characters (mostly CJK). */\n    return 'WenQuanYiZenHei';\n  }\n};\n\nexport const pdfName = (name, { swapLatinWithLocalNames = false, short = false } = {}) => {\n  /* Note: support normal and fullwidth parentheses. */\n  const [, latinName, localName] = name.match(/(.+)\\s*[(](.+)[)]/) || [null, name, null];\n  if (!localName) return latinName;\n  const pdfNames = [latinName, { text: localName, font: determineFont(localName) }];\n  const [first, second] = swapLatinWithLocalNames ? pdfNames.reverse() : pdfNames;\n  return short ? first : [first, ' (', second, ')'];\n};\n\nexport const getImageDataUrl = url => {\n  if (!url) return Promise.resolve(null);\n  const params = new URLSearchParams({\n    url,\n    bri: 50,\n    bg: 'white',\n    w: 200,\n    h: 200,\n    t: 'letterbox',\n    output: 'jpg',\n    encoding: 'base64'\n  });\n  return fetch(`https://images.weserv.nl/?${params.toString()}`)\n    .then(response => response.text())\n    .catch(() => null);\n};\n","import pdfMake from './pdfmake';\nimport { flatMap, sortBy, chunk, times, sum, uniq } from '../utils';\nimport { parseActivityCode, groupActivitiesByRound, hasDistributedAttempts } from '../activities';\nimport { eventNameById } from '../events';\nimport { cutoffToString, timeLimitToString } from '../formatters';\nimport { getExpectedCompetitorsByRound, competitorsForRound, hasAssignment } from '../competitors';\nimport { getExtensionData } from '../wcif-extensions';\nimport { pdfName, getImageDataUrl } from './pdf-utils';\nimport { sortedGroupActivitiesWithSize } from '../groups';\n\n/* See: https://github.com/bpampuch/pdfmake/blob/3da11bd8148b190808b06f7bc27883102bf82917/src/standardPageSizes.js#L10 */\nconst pageWidth = 595.28;\nconst pageHeight = 841.89;\nconst scorecardMargin = 20;\n\nconst maxAttemptCountByFormat = { '1': 1, '2': 2, '3': 3, 'm': 3, 'a': 5 };\n\nexport const downloadScorecards = (wcif, rounds) => {\n  const { scorecardsBackgroundUrl } = getExtensionData('CompetitionConfig', wcif);\n  getImageDataUrl(scorecardsBackgroundUrl).then(imageData => {\n    const pdfDefinition = scorecardsPdfDefinition(scorecards(wcif, rounds), imageData);\n    pdfMake.createPdf(pdfDefinition).download(`${wcif.id}-scorecards.pdf`);\n  });\n};\n\nexport const downloadBlankScorecards = wcif => {\n  const { scorecardsBackgroundUrl } = getExtensionData('CompetitionConfig', wcif);\n  getImageDataUrl(scorecardsBackgroundUrl).then(imageData => {\n    const pdfDefinition = scorecardsPdfDefinition(blankScorecards(wcif), imageData);\n    pdfMake.createPdf(pdfDefinition).download(`${wcif.id}-blank-scorecards.pdf`);\n  });\n};\n\nconst scorecardsPdfDefinition = (scorecardList, imageData) => ({\n  background: [\n    ...(imageData === null ? [] : [\n        /* Determined empirically to fit results table. */\n        { x: 60, y: 170 }, { x: 360, y: 170 },\n        { x: 60, y: 590 }, { x: 360, y: 590 }\n      ].map(absolutePosition => ({ absolutePosition, image: imageData }))\n    ), {\n    canvas: [\n      cutLine({ x1: scorecardMargin, y1: pageHeight / 2, x2: pageWidth - scorecardMargin, y2: pageHeight / 2 }),\n      cutLine({ x1: pageWidth / 2, y1: scorecardMargin, x2: pageWidth / 2, y2:  pageHeight - scorecardMargin })\n    ]\n  }],\n  pageMargins: [scorecardMargin, scorecardMargin],\n  content: {\n    layout: {\n      /* Outer margin is done using pageMargins, we use padding for the remaining inner margins. */\n      paddingLeft  : i => i % 2 === 0 ? 0 : scorecardMargin,\n      paddingRight : i => i % 2 === 0 ? scorecardMargin : 0,\n      paddingTop   : i => i % 2 === 0 ? 0 : scorecardMargin,\n      paddingBottom: i => i % 2 === 0 ? scorecardMargin : 0,\n      /* Get rid of borders. */\n      hLineWidth: () => 0,\n      vLineWidth: () => 0\n    },\n    table: {\n      widths: ['*', '*'],\n      /* A4 page height minus vertical margins, divided into a half. */\n      heights: (pageHeight - 4 * scorecardMargin) / 2,\n      dontBreakRows: true,\n      body: chunk(scorecardList, 2)\n    }\n  }\n});\n\nconst cutLine = properties => ({\n  ...properties,\n  type: 'line', lineWidth: 0.1, dash: { length: 10 }, lineColor: '#888888'\n});\n\nconst scorecards = (wcif, rounds) => {\n  const { localNamesFirst } = getExtensionData('CompetitionConfig', wcif);\n  return flatMap(rounds, round => {\n    const groupsWithCompetitors = groupActivitiesWithCompetitors(wcif, round.id);\n    let scorecardNumber = sum(groupsWithCompetitors.map(([_, competitors]) => competitors.length));\n    return flatMap(groupsWithCompetitors, ([groupActivity, competitors]) => {\n      const groupScorecards = competitors.map(competitor =>\n        scorecard({\n          scorecardNumber: scorecardNumber--,\n          competitionName: wcif.shortName,\n          activityCode: groupActivity.activityCode,\n          round,\n          attemptCount: maxAttemptCountByFormat[round.format],\n          competitor,\n          localNamesFirst\n        })\n      );\n      const scorecardsOnLastPage = groupScorecards.length % 4;\n      return scorecardsOnLastPage === 0\n        ? groupScorecards\n        : groupScorecards.concat(times(4 - scorecardsOnLastPage, () => ({})));\n    });\n  });\n};\n\nconst groupActivitiesWithCompetitors = (wcif, roundId) => {\n  const sortedCompetitors = competitorsForRound(wcif, roundId);\n  if (sortedCompetitors) {\n    const sortedGroupActivities = hasDistributedAttempts(roundId)\n      ? groupActivitiesByRound(wcif, roundId).slice(0, 1)\n      : sortBy(groupActivitiesByRound(wcif, roundId),\n        ({ activityCode }) => parseActivityCode(activityCode).groupNumber\n      );\n    return sortedGroupActivities.map(groupActivity => [\n      groupActivity,\n      sortedCompetitors.filter(competitor => hasAssignment(competitor, groupActivity.id, 'competitor'))\n    ]);\n  } else {\n    /* If competitors for this round are not known yet, generate nameless scorecards. */\n    const expectedCompetitorCount = getExpectedCompetitorsByRound(wcif)[roundId].length;\n    const groupsWithSize = hasDistributedAttempts(roundId)\n      ? [[groupActivitiesByRound(wcif, roundId)[0], expectedCompetitorCount]]\n      : sortedGroupActivitiesWithSize(wcif, roundId, expectedCompetitorCount);\n    return groupsWithSize.map(([groupActivity, size]) => [\n      groupActivity,\n      times(size, () => ({ name: ' ', registrantId: ' ' }))\n    ]);\n  }\n};\n\nconst blankScorecards = wcif => {\n  const attemptCounts = flatMap(wcif.events, event => event.rounds)\n    .map(round => maxAttemptCountByFormat[round.format]);\n  return flatMap(uniq(attemptCounts), attemptCount =>\n    times(4, () => scorecard({ competitionName: wcif.name, attemptCount }))\n  );\n};\n\nconst scorecard = ({\n  scorecardNumber,\n  competitionName,\n  activityCode,\n  round,\n  attemptCount = 5,\n  competitor = { name: ' ', registrantId: ' ' },\n  localNamesFirst = false\n}) => {\n  const { eventId, roundNumber, groupNumber } = activityCode ? parseActivityCode(activityCode) : {};\n  const { cutoff, timeLimit } = round || {};\n\n  return [\n    { text: scorecardNumber, fontSize: 10 },\n    { text: competitionName, bold: true, fontSize: 15, margin: [0, 0, 0, 10], alignment: 'center' },\n    {\n      margin: [25, 0, 0, 0],\n      table: {\n        widths: ['*', 'auto', 'auto'],\n        body: [\n          columnLabels(['Event', 'Round', 'Group']),\n          [eventId ? eventNameById(eventId) : ' ', { text: roundNumber, alignment: 'center' }, { text: groupNumber, alignment: 'center' }]\n        ]\n      }\n    },\n    {\n      margin: [25, 0, 0, 0],\n      table: {\n        widths: [25, '*'],\n        body: [\n          columnLabels(['ID', 'Name']),\n          [{ text: competitor.registrantId, alignment: 'center' }, { text: pdfName(competitor.name, { swapLatinWithLocalNames: localNamesFirst }), maxHeight: 20 /* See: https://github.com/bpampuch/pdfmake/issues/264#issuecomment-108347567 */ }]\n        ]\n      }\n    },\n    {\n      margin: [0, 10, 0, 0],\n      table: {\n        widths: [16, 25, '*', 25, 25], /* Note: 16 (width) + 4 + 4 (defult left and right padding) + 1 (left border) = 25 */\n        body: [\n          columnLabels(['', 'Scr', 'Result', 'Judge', 'Comp'], { alignment: 'center' }),\n          ...attemptRows(cutoff, attemptCount),\n          [{ text: 'Extra attempt', ...noBorder, colSpan: 5, margin: [0, 1], fontSize: 10 }],\n          attemptRow('_'),\n          [{ text: '', ...noBorder, colSpan: 5, margin: [0, 1] }]\n        ]\n      }\n    },\n    {\n      fontSize: 10,\n      columns: [\n        cutoff ? { text: `Cutoff: ${cutoffToString(cutoff, eventId)}`, alignment: 'center' } : {},\n        timeLimit ? { text: `Time limit: ${timeLimitToString(timeLimit)}`, alignment: 'center' } : {}\n      ]\n    },\n  ];\n};\n\nconst columnLabels = (labels, style = {}) =>\n  labels.map(label => ({\n    ...style, ...noBorder, fontSize: 9, text: label\n  }));\n\nconst attemptRows = (cutoff, attemptCount) =>\n  times(attemptCount, attemptIndex => attemptRow(attemptIndex + 1))\n    .reduce((rows, attemptRow, attemptIndex) =>\n      (attemptIndex + 1 === attemptCount)\n        ? [...rows, attemptRow]\n        : [ ...rows, attemptRow,\n            attemptsSeparator(cutoff && (attemptIndex + 1 === cutoff.numberOfAttempts))\n          ]\n    , []);\n\nconst attemptsSeparator = cutoffLine => [{\n  ...noBorder, colSpan: 5, margin: [0, 1],\n  columns: !cutoffLine ? [] : [{\n    canvas: [{\n      type: 'line',\n      x1: 0, y1: 0,\n      x2: (pageWidth - 4 * scorecardMargin) / 2, y2: 0,\n      dash: { length: 5 },\n    }]\n  }]\n}];\n\nconst attemptRow = attemptNumber =>\n  [{ text: attemptNumber, ...noBorder, fontSize: 20, bold: true, alignment: 'center' }, {}, {}, {} ,{}];\n\nconst noBorder = { border: [false, false, false, false] };\n","import pdfMake from './pdfmake';\nimport { flatMap, sortByArray } from '../utils';\nimport { activityCodeToName, activityDurationString, parseActivityCode, roomsWithTimezoneAndGroups } from '../activities';\nimport { hasAssignment } from '../competitors';\nimport { pdfName } from './pdf-utils';\n\nexport const downloadGroupOverview = (wcif, rounds) => {\n  const pdfDefinition = groupOverviewPdfDefinition(wcif, rounds);\n  pdfMake.createPdf(pdfDefinition).download(`${wcif.id}-group-overview.pdf`);\n};\n\nconst groupOverviewPdfDefinition = (wcif, rounds) => ({\n  footer: (currentPage, pageCount) => ({\n    text: `${currentPage} of ${pageCount}`, alignment: 'center', fontSize: 10\n  }),\n  content: sortByArray(\n    flatMap(\n      flatMap(rounds, round => roomsWithTimezoneAndGroups(wcif, round.id)),\n      ([room, timezone, groupActivities]) => groupActivities.map(groupActivity => [room, timezone, groupActivity])\n    ),\n    ([room, timezone, ({ startTime, activityCode })]) => [startTime, parseActivityCode(activityCode).groupNumber]\n  )\n  .map(([room, timezone, groupActivity]) => overviewForGroup(wcif, room, timezone, groupActivity))\n});\n\nconst overviewForGroup = (wcif, room, timezone, groupActivity) => {\n  const headersWithPeople = [\n    ['Competitors', 'competitor'], ['Scramblers', 'staff-scrambler'], ['Runners', 'staff-runner', ], ['Judges', 'staff-judge']\n  ].map(([header, assignmentCode]) => [\n    header,\n    wcif.persons.filter(person => hasAssignment(person, groupActivity.id, assignmentCode))\n  ]).filter(([header, people]) => people.length > 0);\n  return {\n    unbreakable: true,\n    margin: [0, 0, 0, 10],\n    stack: [\n      { text: activityCodeToName(groupActivity.activityCode), bold: true, fontSize: 14 },\n      {\n        columns: [`Time: ${activityDurationString(groupActivity, timezone)}`, `Room: ${room.name}`],\n        margin: [0, 5, 0, 5]\n      },\n      {\n        fontSize: 8,\n        columns: headersWithPeople.map(([header, people]) => [\n          { text: `${header} (${people.length})`, bold: true, fontSize: 10, margin: [0, 0, 0, 2] },\n          { ul: people.map(person => pdfName(person.name, { short: true })).sort() }\n        ])\n      }\n    ]\n  };\n};\n","import React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nimport CubingIcon from '../../../common/CubingIcon/CubingIcon';\nimport { downloadScorecards, downloadBlankScorecards } from '../../../../logic/documents/scorecards';\nimport { downloadGroupOverview } from '../../../../logic/documents/group-overview';\nimport { roundsWithoutResults, roundsMissingScorecards, parseActivityCode, activityCodeToName } from '../../../../logic/activities';\nimport { difference, sortBy } from '../../../../logic/utils';\n\nexport default class Scorecards extends Component {\n  constructor(props) {\n    super(props);\n    const missingScorecards = roundsMissingScorecards(this.props.wcif);\n    const selectedRounds = missingScorecards.every(round => parseActivityCode(round.id).roundNumber === 1) ? missingScorecards : [];\n    this.state = {\n      selectedRounds\n    };\n  }\n\n  handleScorecardsDownloadClick = () => {\n    downloadScorecards(this.props.wcif, this.state.selectedRounds);\n  };\n\n  handleGroupOverviewDownloadClick = () => {\n    downloadGroupOverview(this.props.wcif, this.state.selectedRounds);\n  };\n\n  handleBlankScorecardsDownloadClick = () => {\n    downloadBlankScorecards(this.props.wcif);\n  };\n\n  handleRoundClick = round => event => {\n    const { selectedRounds } = this.state;\n    this.setState({\n      selectedRounds: selectedRounds.includes(round)\n        ? difference(selectedRounds, [round])\n        : [...selectedRounds, round]\n    });\n  };\n\n  render() {\n    const { selectedRounds } = this.state;\n    const { wcif } = this.props;\n    const rounds = sortBy(\n      roundsWithoutResults(wcif).filter(round => parseActivityCode(round.id).eventId !== '333fm'),\n      round => parseActivityCode(round.id).roundNumber\n    );\n    const missingScorecards = roundsMissingScorecards(wcif);\n\n    return (\n      <Paper style={{ padding: 16 }}>\n        <Typography variant=\"body1\">Select rounds</Typography>\n        <List style={{ width: 400 }}>\n          {rounds.map(round => (\n            <ListItem\n              key={round.id}\n              button\n              onClick={this.handleRoundClick(round)}\n              style={missingScorecards.includes(round) ? {} : { opacity: 0.5 }}\n            >\n              <ListItemIcon>\n                <CubingIcon eventId={parseActivityCode(round.id).eventId} />\n              </ListItemIcon>\n              <ListItemText primary={activityCodeToName(round.id)} />\n              <Checkbox\n                checked={selectedRounds.includes(round)}\n                tabIndex={-1}\n                disableRipple\n                style={{ padding: 0 }}\n              />\n            </ListItem>\n          ))}\n        </List>\n        <Grid container spacing={8}>\n          <Grid item>\n            <Button onClick={this.handleScorecardsDownloadClick} disabled={selectedRounds.length === 0}>\n              Scorecards\n            </Button>\n          </Grid>\n          <Grid item>\n            <Button onClick={this.handleGroupOverviewDownloadClick} disabled={selectedRounds.length === 0}>\n              Group overview\n            </Button>\n          </Grid>\n          <Grid item style={{ flexGrow: 1 }} />\n          <Grid item>\n            <Button onClick={this.handleBlankScorecardsDownloadClick}>\n              Blank scorecards\n            </Button>\n          </Grid>\n        </Grid>\n      </Paper>\n    );\n  }\n}\n","import { chunk, sortBy, times, zip } from '../utils';\nimport { eventNameById } from '../events';\nimport { activityById, hasDistributedAttempts, parseActivityCode } from '../activities';\nimport { acceptedPeople } from '../competitors';\nimport { getExtensionData } from '../wcif-extensions';\nimport pdfMake from './pdfmake';\nimport { pdfName } from './pdf-utils';\n\nexport const downloadCompetitorCards = wcif => {\n  const pdfDefinition = competitorCardsPdfDefinition(wcif);\n  pdfMake.createPdf(pdfDefinition).download(`${wcif.id}-competitor-cards.pdf`);\n};\n\nconst competitorCardsPdfDefinition = wcif => ({\n  pageMargins: [5, 5],\n  content: chunk(competitorCards(wcif), 3).map(cards => (\n    { columns: cards, fontSize: 8, unbreakable: true }\n  ))\n});\n\nconst competitorCards = wcif => {\n  const cards = sortBy(acceptedPeople(wcif), person => person.name)\n    .map(person => competitorCard(wcif, person));\n  const cardsInLastRow = cards.length % 3;\n  return cardsInLastRow === 0 ? cards : cards.concat(times(3 - cardsInLastRow, () => ({})));\n};\n\nconst competitorCard = (wcif, person) => {\n  const events = wcif.events.filter(event => !hasDistributedAttempts(event.id));\n  const { localNamesFirst } = getExtensionData('CompetitionConfig', wcif) || { localNamesFirst: false };\n  const tasks = person.assignments.map(({ activityId, assignmentCode }) => {\n    const activity = activityById(wcif, activityId);\n    const { eventId, roundNumber, groupNumber } = parseActivityCode(activity.activityCode);\n    return { assignmentCode, eventId, groupNumber, roundNumber };\n  }).filter(({ roundNumber }) => roundNumber === 1);\n  const groupsText = (eventId, assignmentCode) => ({\n    text: tasks\n      .filter(task => task.eventId === eventId && task.assignmentCode === assignmentCode)\n      .map(task => task.groupNumber)\n      .join(', '),\n    alignment: 'center'\n  });\n  const [assignmentCodes, headers] = zip(...[\n      ['competitor', 'Comp'], ['staff-scrambler', 'Scr'], ['staff-runner', 'Run'], ['staff-judge', 'Judge']\n    ].filter(([assignmentCode]) => tasks.some(task => task.assignmentCode === assignmentCode))\n  );\n  return {\n    margin: [5, 5],\n    stack: [\n      { text: pdfName(person.name, { swapLatinWithLocalNames: localNamesFirst }), fontSize: 10, maxHeight: 20 /* See: https://github.com/bpampuch/pdfmake/issues/264#issuecomment-108347567 */ },\n      {\n        columns: [\n          `ID: ${person.registrantId}`,\n          { text: person.wcaId ? `WCA ID: ${person.wcaId}` : {}, alignment: 'right' }\n        ]\n      },\n      {\n        table: {\n          widths: ['auto', ...headers.map(() => '*')],\n          body: [\n            ['Event', ...headers.map(header => ({ text: header, alignment: 'center'}))],\n            ...events.map(event => [\n              eventNameById(event.id),\n              ...assignmentCodes.map(assignmentCode => groupsText(event.id, assignmentCode))\n            ])\n          ]\n        },\n        layout: { paddingLeft: () => 2, paddingRight: () => 2, paddingTop: () => 1, paddingBottom: () => 1 }\n      },\n      ...times(Math.max(0, 12 - events.length), () => ({ text: ' ' })) /* Add some empty space if there are few events. */\n    ]\n  };\n};\n","import React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nimport { downloadCompetitorCards } from '../../../../logic/documents/competitor-cards';\n\nexport default class CompetitorCards extends Component {\n  handleDownloadClick = () => {\n    downloadCompetitorCards(this.props.wcif);\n  };\n\n  render() {\n    return (\n      <Paper style={{ padding: 16 }}>\n        <Typography variant=\"body1\">\n          First round task assignments for every competitor.\n          Useful to be distributed along with name tags.\n        </Typography>\n        <Button onClick={this.handleDownloadClick}>\n          Download\n        </Button>\n      </Paper>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport AppBar from '@material-ui/core/AppBar';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport Tab from '@material-ui/core/Tab';\nimport Tabs from '@material-ui/core/Tabs';\n\nimport Scorecards from './Scorecards/Scorecards';\nimport CompetitorCards from './CompetitorCards/CompetitorCards';\n\nexport default class PrintingManager extends Component {\n  state = {\n    tabValue: 0\n  };\n\n  handleTabChange = (event, value) => {\n    this.setState({ tabValue: value });\n  };\n\n  render() {\n    const { tabValue } = this.state;\n    const { wcif } = this.props;\n\n    return (\n      <Grid container spacing={8} justify=\"flex-end\">\n        <Grid item xs={12}>\n          <AppBar position=\"static\" color=\"default\">\n            <Tabs value={tabValue} onChange={this.handleTabChange} centered>\n              <Tab label=\"Scorecards\" />\n              <Tab label=\"Competitor cards\" />\n            </Tabs>\n          </AppBar>\n        </Grid>\n        <Grid item xs={12}>\n          {tabValue === 0 && <Scorecards wcif={wcif} />}\n          {tabValue === 1 && <CompetitorCards wcif={wcif} />}\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" color=\"primary\" component={Link} to={`/competitions/${wcif.id}`}>\n            Done\n          </Button>\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Grid from '@material-ui/core/Grid';\nimport Icon from '@material-ui/core/Icon';\nimport Paper from '@material-ui/core/Paper';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TablePagination from '@material-ui/core/TablePagination';\nimport TableRow from '@material-ui/core/TableRow';\nimport TextField from '@material-ui/core/TextField';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\n\nimport SaveWcifButton from '../../common/SaveWcifButton/SaveWcifButton';\nimport { acceptedPeople } from '../../../logic/competitors';\nimport { difference, sortBy } from '../../../logic/utils';\n\nconst roles = [\n  { id: 'staff-scrambler', name: 'Scrambler' },\n  { id: 'staff-judge', name: 'Judge' },\n  { id: 'staff-runner', name: 'Runner' },\n  { id: 'staff-dataentry', name: 'Data entry' },\n];\n\nexport default class RolesManager extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      localWcif: props.wcif,\n      page: 0,\n      searchString: ''\n    }\n  }\n\n  handleSearchChange = event => {\n    this.setState({ searchString: event.target.value });\n  };\n\n  handleChangePage = (event, page) => {\n    this.setState({ page });\n  };\n\n  handleRoleChange(roleId, personWcaUserId, event) {\n    const { localWcif } = this.state;\n    const { checked } = event.target;\n\n    this.setState({\n      localWcif: {\n        ...localWcif,\n        persons: localWcif.persons.map(person =>\n          person.wcaUserId === personWcaUserId\n            ? { ...person, roles: checked ? [...person.roles, roleId] : difference(person.roles, [roleId]) }\n            : person\n        )\n      }\n    });\n  }\n\n  clearRoles = () => {\n    const { localWcif } = this.state;\n    const roleIds = roles.map(role => role.id);\n    this.setState({\n      localWcif: {\n        ...localWcif,\n        persons: localWcif.persons.map(person =>\n          ({ ...person, roles: difference(person.roles, roleIds)})\n        )\n      }\n    });\n  };\n\n  render() {\n    const { page, searchString, localWcif } = this.state;\n    const { wcif, onWcifUpdate, history } = this.props;\n    const rowsPerPage = 5;\n    const rowsPerPageOptions = [5];\n\n    const allSortedPeople = sortBy(acceptedPeople(localWcif), person => person.name);\n    const people = !searchString ? allSortedPeople : allSortedPeople.filter(person =>\n      searchString.split(/\\s*,\\s*/).some(searchPart =>\n        searchPart && person.name.match(new RegExp(searchPart, 'i'))\n      )\n    );\n\n    return (\n      <Grid container spacing={8} justify=\"flex-end\">\n        <Grid item xs={12}>\n          <Paper>\n            <Toolbar>\n              <Grid container spacing={8} alignItems=\"flex-end\">\n                <Grid item>\n                  <TextField label=\"Search\" value={searchString} onChange={this.handleSearchChange} />\n                </Grid>\n                <Grid item>\n                  <Tooltip title=\"If you separate search phrases with a comma, anyone matching either of them will show up.\" placement=\"right\">\n                    <Icon>info</Icon>\n                  </Tooltip>\n                </Grid>\n              </Grid>\n            </Toolbar>\n            <div style={{ overflowX: 'auto' }}>\n              <Table>\n                <TableHead>\n                  <TableRow>\n                    <TableCell>Person</TableCell>\n                    {roles.map(role =>\n                      <TableCell key={role.id} padding=\"none\" style={{ textAlign: 'center' }}>{role.name}</TableCell>\n                    )}\n                  </TableRow>\n                </TableHead>\n                <TableBody>\n                  {people.slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage).map(person =>\n                    <TableRow key={person.wcaUserId} hover>\n                      <TableCell>{person.name}</TableCell>\n                      {roles.map(role =>\n                        <TableCell key={role.id} padding=\"checkbox\" style={{ textAlign: 'center' }}>\n                          <Checkbox\n                            checked={person.roles.includes(role.id)}\n                            onChange={this.handleRoleChange.bind(this, role.id, person.wcaUserId)}\n                          />\n                        </TableCell>\n                      )}\n                    </TableRow>\n                  )}\n                </TableBody>\n              </Table>\n            </div>\n            <TablePagination\n              component=\"div\"\n              count={people.length}\n              rowsPerPage={rowsPerPage}\n              rowsPerPageOptions={rowsPerPageOptions}\n              page={page}\n              onChangePage={this.handleChangePage}\n            />\n          </Paper>\n        </Grid>\n        <Grid item xs={12}>\n          <Typography variant=\"caption\">\n            Use this section only if you have a group of staff among competitors.\n            People with the given role will be prioritized during task assignment.\n          </Typography>\n          <Typography variant=\"caption\">\n            Note: if you don't set any roles, people will still be assigned tasks.\n          </Typography>\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" component={Link} to={`/competitions/${localWcif.id}`}>\n            Cancel\n          </Button>\n        </Grid>\n        <Grid item>\n          <Button variant=\"contained\" onClick={this.clearRoles}>\n            Clear\n          </Button>\n        </Grid>\n        <Grid item>\n          <SaveWcifButton wcif={wcif} updatedWcif={localWcif} onWcifUpdate={onWcifUpdate} history={history} />\n        </Grid>\n      </Grid>\n    );\n  }\n}\n","import { flatMap } from './utils';\nimport { activityCodeToName, roundActivities } from './activities';\n\nexport const validateWcif = wcif => {\n  const { events } = wcif;\n  const eventRoundErrors = flatMap(events, event => {\n    if (event.rounds.length === 0) return [`No rounds specified for ${activityCodeToName(event.id)}.`];\n    const advancementConditionErrors = flatMap(event.rounds.slice(0, -1), round =>\n      round.advancementCondition ? [] : [`No advancement condition specified for ${activityCodeToName(round.id)}.`]\n    );\n    const roundActivityErrors = flatMap(event.rounds, round =>\n      roundActivities(wcif, round.id).length > 0 ? [] : [`No schedule activities for ${activityCodeToName(round.id)}.`]\n    );\n    return [...advancementConditionErrors, ...roundActivityErrors];\n  });\n  return eventRoundErrors;\n};\n","/* Dirty hacks for compatibility with Cubecomps. Get rid of that once WCA Live is ready. */\n\nimport { acceptedPeople } from './competitors';\n\n/* Generate ids the same way Cubecomps would do that.\n   If competitors are already on Cubecomps, use those competitor ids instead. */\nexport const __withCubecompsIds__ = wcif => {\n  const people = acceptedPeople(wcif);\n  people.forEach((person, index) => person.registrantId = index + 1);\n  return getCompetitions()\n    .then(competitions => {\n      const competition = competitions.find(competition => wcif.name.startsWith(competition.name));\n      if (!competition) return null;\n      return getCompetition(competition.id).then(competition => {\n        if (competition.competitors.length === 0) return null;\n        people.forEach(person => {\n          const competitor = competition.competitors.find(competitor =>\n            normalizeName(person.name) === normalizeName(competitor.name)\n          );\n          if (!competitor) throw new Error(`Couldn't find Cubecomps competitor id for ${person.name}.`);\n          person.registrantId = parseInt(competitor.id, 10);\n        });\n      });\n    })\n    .then(() => wcif);\n};\n\nconst normalizeName = name =>\n  name.toLowerCase().replace(/[(].*/, '').trim().split(/\\s+/).join(' ');\n\nconst getCompetitions = () =>\n  cubecompsApiFetch('/competitions')\n    .then(competitions => Object.values(competitions).reduce((x, y) => x.concat(y), []));\n\nconst getCompetition = competitionCubecompsId =>\n  cubecompsApiFetch(`/competitions/${competitionCubecompsId}`);\n\nconst cubecompsApiFetch = (path, fetchOptions = {}) => {\n  const baseApiUrl = 'https://m.cubecomps.com/api/v1';\n\n  return fetch(`${baseApiUrl}${path}`, Object.assign({}, fetchOptions, {\n      headers: new Headers({ 'Content-Type': 'application/json' })\n    }))\n    .then(response => {\n      if (!response.ok) throw new Error(response.statusText);\n      return response;\n    })\n    .then(response => response.json());\n};\n","import React, { Component, Fragment } from 'react';\nimport { Route, Switch } from 'react-router-dom';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\n\nimport CompetitionMenu from './CompetitionMenu/CompetitionMenu';\nimport ConfigManager from './ConfigManager/ConfigManager';\nimport GroupsManager from './GroupsManager/GroupsManager';\nimport PrintingManager from './PrintingManager/PrintingManager';\nimport RolesManager from './RolesManager/RolesManager';\n\nimport { getWcif } from '../../logic/wca-api';\nimport { sortWcifEvents } from '../../logic/events';\nimport { updateIn } from '../../logic/utils';\nimport { validateWcif } from '../../logic/wcif-validation';\nimport { __withCubecompsIds__ } from '../../logic/__cubecomps__';\n\nexport default class Competition extends Component {\n  state = {\n    wcif: null,\n    loading: true,\n    errors: []\n  };\n\n  componentDidMount() {\n    getWcif(this.props.match.params.competitionId)\n      .then(wcif => updateIn(wcif, ['events'], sortWcifEvents)) /* Sort events, so that we don't need to remember about this everywhere. */\n      .then(__withCubecompsIds__)\n      .then(wcif => this.setState({ wcif, loading: false, errors: validateWcif(wcif) }))\n      .catch(error => this.setState({ errors: [error.message], loading: false }))\n  }\n\n  handleWcifUpdate = wcif => {\n    this.setState({ wcif });\n  };\n\n  render() {\n    const { wcif, loading, errors } = this.state;\n    const { match } = this.props;\n\n    return loading ? <LinearProgress /> : (\n      <div>\n        {errors.length === 0 ? (\n          <Fragment>\n            <Typography variant=\"h5\" style={{ marginBottom: 16 }}>\n              {wcif.name}\n            </Typography>\n            <Switch>\n              <Route exact path={match.url} render={\n                props => <CompetitionMenu {...props} wcif={wcif} baseUrl={match.url} />\n              } />\n              <Route path={`${match.url}/roles`} render={\n                props => <RolesManager {...props} wcif={wcif} onWcifUpdate={this.handleWcifUpdate} />\n              } />\n              <Route path={`${match.url}/config`} render={\n                props => <ConfigManager {...props} wcif={wcif} onWcifUpdate={this.handleWcifUpdate} />\n              } />\n              <Route path={`${match.url}/groups`} render={\n                props => <GroupsManager {...props} wcif={wcif} onWcifUpdate={this.handleWcifUpdate} />\n              } />\n              <Route path={`${match.url}/printing`} render={\n                props => <PrintingManager {...props} wcif={wcif} />\n              } />\n            </Switch>\n          </Fragment>\n        ) : (\n          <Fragment>\n            <Typography variant=\"h5\">Failed to load competition data</Typography>\n            <List>\n              {errors.map(error => (\n                <ListItem key={error}>\n                  <ListItemText>{error}</ListItemText>\n                </ListItem>\n              ))}\n            </List>\n          </Fragment>\n        )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport Paper from '@material-ui/core/Paper';\nimport Icon from '@material-ui/core/Icon';\n\nimport { getUpcomingManageableCompetitions } from '../../logic/wca-api';\nimport { sortBy } from '../../logic/utils';\n\nexport default class CompetitionList extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      competitions: [],\n      loading: true,\n      error: null\n    }\n  }\n\n  componentDidMount() {\n    getUpcomingManageableCompetitions()\n      .then(competitions =>\n        this.setState({\n          competitions: sortBy(competitions, competition => competition['start_date']),\n          loading: false\n        })\n      )\n      .catch(error => this.setState({ error: error.message, loading: false }));\n  }\n\n  render() {\n    const { competitions, loading, error } = this.state;\n\n    return (\n      <div>\n        <Paper>\n          <List subheader={<ListSubheader>Your competitions</ListSubheader>}>\n            {error &&\n              <ListItem>\n                <ListItemIcon>\n                  <Icon>error</Icon>\n                </ListItemIcon>\n                <ListItemText primary={`Couldn't fetch competitions: ${error}`} />\n              </ListItem>\n            }\n            {!loading && !error && competitions.length === 0 &&\n              <ListItem>\n                <ListItemIcon>\n                  <Icon>sentiment_very_dissatisfied</Icon>\n                </ListItemIcon>\n                <ListItemText primary=\"You have no upcoming competitions to manage.\" />\n              </ListItem>\n            }\n            {competitions.map(competition =>\n              <ListItem key={competition.id} button component={Link} to={`/competitions/${competition.id}`}>\n                <ListItemText primary={competition.name} />\n              </ListItem>\n            )}\n          </List>\n          {loading && <LinearProgress />}\n        </Paper>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport Icon from '@material-ui/core/Icon';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport red from '@material-ui/core/colors/red'\nimport { version } from '../../../package.json';\n\nimport './Footer.css';\n\nconst links = [\n  { text: 'Donate', url: 'https://ko-fi.com/jonatanklosko' },\n  { text: 'Guide', url: 'https://github.com/jonatanklosko/groupifier-next/wiki/Guide' },\n  { text: 'GitHub', url: 'https://github.com/jonatanklosko/groupifier-next' },\n  { text: 'Contact', url: 'mailto:jonatanklosko@gmail.com' },\n  { text: `v${version}`, url: 'https://github.com/jonatanklosko/groupifier-next' }\n];\n\nconst Footer = () => (\n  <Grid container className=\"footer\">\n    <Grid item style={{ flexGrow: 1 }}>\n      <Typography>\n        Made with <Icon className=\"footer-icon\" style={{ color: red[700] }}>favorite</Icon>\n        {' '}by <a href=\"https://github.com/jonatanklosko\" target=\"_blank\" rel=\"noopener noreferrer\">Jonatan Kosko</a>\n      </Typography>\n    </Grid>\n    <Grid item>\n      <Grid container spacing={8}>\n        {links.map(({ text, url }) => (\n          <Grid item key={text}>\n            <Typography>\n              <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">{text}</a>\n            </Typography>\n          </Grid>\n        ))}\n      </Grid>\n    </Grid>\n  </Grid>\n);\n\nexport default Footer;\n","import React from 'react';\nimport AppBar from '@material-ui/core/AppBar';\nimport Button from '@material-ui/core/Button';\nimport Icon from '@material-ui/core/Icon';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport { Link } from 'react-router-dom';\n\nconst Header = ({ isSignedIn, onSignIn, onSignOut }) => (\n  <AppBar position=\"static\" color=\"primary\">\n    <Toolbar>\n      <Typography variant=\"h6\" color=\"inherit\" style={{ flexGrow: 1 }}>\n        <Link to={isSignedIn ? '/competitions' : '/'}>\n          <Icon style={{ fontSize: '1.5em', verticalAlign: 'middle', marginRight: 10 }}>people</Icon>\n          Groupifier\n        </Link>\n      </Typography>\n      {isSignedIn\n        ? <Button color=\"inherit\" onClick={onSignOut}>Sign out</Button>\n        : <Button color=\"inherit\" onClick={onSignIn}>Sign in</Button>}\n    </Toolbar>\n  </AppBar>\n);\n\nexport default Header;\n","import React from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport Icon from '@material-ui/core/Icon';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\n\nconst features = [\n  'Allows for marking competitors as different kinds of staff and handles them in a special manner.',\n  'Supports multiple rooms/stages running simultaneously.',\n  'Suggests number of groups and necessary roles, while leaving the final decision to the user.',\n  'Once configured, creates groups and does its best to optimally assign people to these groups.',\n  'Generates documents like scorecards and competitor cards with task assignments.'\n];\n\nconst Home = () => (\n  <Grid container spacing={24} direction=\"column\">\n    <Grid item>\n      <Typography variant=\"h4\">What is Groupifier?</Typography>\n    </Grid>\n    <Grid item>\n      <Typography variant=\"subtitle1\">\n        Task and group management tool for WCA competition organizers.\n        It's designed to be highly customizable and work well with complex schedules.\n      </Typography>\n    </Grid>\n    <Grid item>\n      <Typography variant=\"h4\">What does it do?</Typography>\n    </Grid>\n    <Grid item>\n      <List>\n        {features.map(feature =>\n          <ListItem key={feature}>\n            <ListItemIcon>\n              <Icon>check</Icon>\n            </ListItemIcon>\n            <ListItemText primary={feature} />\n          </ListItem>\n        )}\n      </List>\n    </Grid>\n  </Grid>\n);\n\nexport default Home;\n","import React, { Component } from 'react';\nimport { HashRouter as Router, Route, Switch, Redirect } from 'react-router-dom';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Grid from '@material-ui/core/Grid';\nimport { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles';\nimport indigo from '@material-ui/core/colors/indigo';\nimport grey from '@material-ui/core/colors/grey';\n\nimport Competition from '../Competition/Competition';\nimport CompetitionList from '../CompetitionList/CompetitionList';\nimport Footer from '../Footer/Footer';\nimport Header from '../Header/Header';\nimport Home from '../Home/Home';\n\nimport { isSignedIn, signIn, signOut } from '../../logic/auth';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: indigo,\n    secondary: grey\n  },\n  typography: {\n    useNextVariants: true,\n  }\n});\n\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isSignedIn: isSignedIn()\n    };\n  }\n\n  handleSignIn = () => {\n    signIn();\n  };\n\n  handleSignOut = () => {\n    signOut();\n    this.setState({ isSignedIn: false })\n  };\n\n  render() {\n    const { isSignedIn } = this.state;\n    return (\n      <Router>\n        <MuiThemeProvider theme={theme}>\n          <div style={{ display: 'flex', minHeight: '100vh', flexDirection: 'column' }}>\n            <CssBaseline />\n            <Header\n              isSignedIn={isSignedIn}\n              onSignIn={this.handleSignIn}\n              onSignOut={this.handleSignOut}\n            />\n            <Grid container justify=\"center\" style={{ flexGrow: 1 }}>\n              <Grid item xs={12} md={8} style={{ padding: 16 }}>\n                {isSignedIn ? (\n                  <Switch>\n                    <Route path=\"/competitions/:competitionId\" component={Competition} />\n                    <Route path=\"/competitions\" component={CompetitionList} />\n                    <Redirect to=\"/competitions\" />\n                  </Switch>\n                ) : (\n                  <Switch>\n                    <Route exact path=\"/\" component={Home} />\n                    <Redirect to=\"/\" />\n                  </Switch>\n                )}\n              </Grid>\n            </Grid>\n            <Footer />\n          </div>\n        </MuiThemeProvider>\n      </Router>\n    );\n  }\n}\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import './polyfills';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport App from './components/App/App';\nimport { unregister as unregisterServiceWorker } from './registerServiceWorker';\nimport { initializeAuth } from './logic/auth';\n\ninitializeAuth();\nReactDOM.render(<App />, document.getElementById('root'));\nunregisterServiceWorker();\n"],"sourceRoot":""}